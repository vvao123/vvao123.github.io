!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.thin=t():e.thin=t()}(window,(function(){return function(e){function t(t){for(var n,r,o=t[0],s=t[1],a=0,c=[];a<o.length;a++)r=o[a],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&c.push(i[r][0]),i[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(u&&u(t);c.length;)c.shift()()}var n={},r={234:0,7:0},i={234:0,7:0};function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[];r[e]?t.push(r[e]):0!==r[e]&&{186:1}[e]&&t.push(r[e]=new Promise((function(t,n){for(var i=e+".player-skin-react-thin.min.css",s=o.p+i,a=document.getElementsByTagName("link"),c=0;c<a.length;c++){var u=(d=a[c]).getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(u===i||u===s))return t()}var l=document.getElementsByTagName("style");for(c=0;c<l.length;c++){var d;if((u=(d=l[c]).getAttribute("data-href"))===i||u===s)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var i=t&&t.target&&t.target.src||s,o=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=i,delete r[e],h.parentNode.removeChild(h),n(o)},h.href=s,document.getElementsByTagName("head")[0].appendChild(h)})).then((function(){r[e]=0})));var n=i[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise((function(t,r){n=i[e]=[t,r]}));t.push(n[2]=s);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=function(e){return o.p+"js/"+({1:"vendors~errorBox~logScr~redirectBox~survey~thinoverlay~tp",2:"vendors~AtMentionLazy~LPPLazy~sharedCommentsLazy~tp",4:"vendors~LPPLazy~sharedCommentsLazy~tp",7:"pluginComment~thinplayer",9:"aRes0",10:"aRes1",11:"aRes10",12:"aRes11",13:"aRes12",14:"aRes13",15:"aRes14",16:"aRes15",17:"aRes16",18:"aRes17",19:"aRes18",20:"aRes19",21:"aRes2",22:"aRes20",23:"aRes21",24:"aRes22",25:"aRes23",26:"aRes24",27:"aRes25",28:"aRes26",29:"aRes27",30:"aRes28",31:"aRes29",32:"aRes3",33:"aRes30",34:"aRes31",35:"aRes32",36:"aRes33",37:"aRes34",38:"aRes35",39:"aRes36",40:"aRes37",41:"aRes38",42:"aRes39",43:"aRes4",44:"aRes40",45:"aRes41",46:"aRes42",47:"aRes43",48:"aRes5",49:"aRes6",50:"aRes7",51:"aRes8",52:"aRes9",56:"ar-strings-json-tspt",57:"ar-strings-jsonThinRes",62:"bg-strings-json-tspt",63:"bg-strings-jsonThinRes",69:"ca-strings-json-tspt",70:"ca-strings-jsonThinRes",71:"chapters",74:"cs-strings-json-tspt",75:"cs-strings-jsonThinRes",78:"da-strings-json-tspt",79:"da-strings-jsonThinRes",81:"de-strings-json-tspt",82:"de-strings-jsonThinRes",83:"defThinRes",84:"default",86:"el-strings-json-tspt",87:"el-strings-jsonThinRes",89:"errorBox",92:"es-strings-json-tspt",93:"es-strings-jsonThinRes",95:"et-strings-json-tspt",96:"et-strings-jsonThinRes",98:"eu-strings-json-tspt",99:"eu-strings-jsonThinRes",102:"fi-strings-json-tspt",103:"fi-strings-jsonThinRes",105:"formsPlugin",108:"fr-strings-json-tspt",109:"fr-strings-jsonThinRes",113:"gl-strings-json-tspt",114:"gl-strings-jsonThinRes",118:"he-strings-json-tspt",119:"he-strings-jsonThinRes",122:"hr-strings-json-tspt",123:"hr-strings-jsonThinRes",125:"hu-strings-json-tspt",126:"hu-strings-jsonThinRes",129:"id-strings-json-tspt",130:"id-strings-jsonThinRes",133:"it-strings-json-tspt",134:"it-strings-jsonThinRes",136:"ja-strings-json-tspt",137:"ja-strings-jsonThinRes",143:"ko-strings-json-tspt",144:"ko-strings-jsonThinRes",148:"liveVid",149:"livehb",151:"logScr",153:"lt-strings-json-tspt",154:"lt-strings-jsonThinRes",156:"lv-strings-json-tspt",157:"lv-strings-jsonThinRes",166:"nb-strings-json-tspt",167:"nb-strings-jsonThinRes",170:"nl-strings-json-tspt",171:"nl-strings-jsonThinRes",176:"pRes",179:"pl-strings-json-tspt",180:"pl-strings-jsonThinRes",181:"playerCommands",186:"pskin",189:"pt-br-strings-json-tspt",190:"pt-br-strings-jsonThinRes",191:"pt-pt-strings-json-tspt",192:"pt-pt-strings-jsonThinRes",197:"redirectBox",199:"ro-strings-json-tspt",200:"ro-strings-jsonThinRes",202:"ru-strings-json-tspt",203:"ru-strings-jsonThinRes",205:"sdn",208:"signalR",210:"sk-strings-json-tspt",211:"sk-strings-jsonThinRes",213:"sl-strings-json-tspt",214:"sl-strings-jsonThinRes",219:"sr-cyrl-rs-strings-json-tspt",220:"sr-cyrl-rs-strings-jsonThinRes",221:"sr-latn-rs-strings-json-tspt",222:"sr-latn-rs-strings-jsonThinRes",223:"strings-tspt",224:"survey",226:"sv-strings-json-tspt",227:"sv-strings-jsonThinRes",232:"th-strings-json-tspt",233:"th-strings-jsonThinRes",235:"thinoverlay",236:"thinplayer",238:"tp",240:"tr-strings-json-tspt",241:"tr-strings-jsonThinRes",245:"uk-strings-json-tspt",246:"uk-strings-jsonThinRes",250:"vendors~liveVid",252:"vendors~signalR",253:"vendors~survey",254:"vendors~thinplayer",256:"vi-strings-json-tspt",257:"vi-strings-jsonThinRes",258:"vidEvt",259:"vodless",262:"zh-hans-strings-json-tspt",263:"zh-hans-strings-jsonThinRes",264:"zh-hant-strings-json-tspt",265:"zh-hant-strings-jsonThinRes"}[e]||e)+".chunk.js"}(e);var u=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",u.name="ChunkLoadError",u.type=r,u.request=o,n[1](u)}i[e]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/static",o.oe=function(e){throw console.error(e),e},Object.defineProperty(o,"p",{get:function(){try{if("string"!=typeof streamFullStaticPath)throw new Error("WebpackRequireFrom: 'streamFullStaticPath' is not a string or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return streamFullStaticPath}catch(e){return"/static"}}});var s=window.webpackJsonp_name_=window.webpackJsonp_name_||[],a=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=a;return o(o.s=463)}({0:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"f",(function(){return h})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return g}));var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function c(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function l(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}},100:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=function(e){this.callback=e,this.willBeUnregistered=!1,this.unregisterOnNextCall=!1},i=function(){function e(e){this.onCallbackError=e,this._observers=new Array}return e.prototype.subscribe=function(e,t){if(void 0===t&&(t={}),!e)return function(){};var n=new r(e);return n.unregisterOnNextCall=!!t.unregisterOnFirstCall,this._observers.push(n),this.remove.bind(this,n)},e.prototype.notify=function(e){for(var t=0,n=this._observers;t<n.length;t++){var r=n[t];if(!r.willBeUnregistered){try{r.callback(e)}catch(e){this.onCallbackError&&this.onCallbackError(e)}r.unregisterOnNextCall&&this.deferUnregister(r)}}},e.prototype.remove=function(e){return-1!==this._observers.indexOf(e)&&(this.deferUnregister(e),!0)},e.prototype.deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e.willBeUnregistered=!0,setTimeout((function(){t.internalRemove(e)}),0)},e.prototype.internalRemove=function(e){var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e}()},11:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Authenticated=1]="Authenticated",e[e.Error=2]="Error",e[e.LoginRequired=3]="LoginRequired",e[e.Waiting=4]="Waiting",e[e.TenantPatchSuccess=5]="TenantPatchSuccess",e[e.TenantPatchThrottled=6]="TenantPatchThrottled",e[e.TenantPatchThrottleFailed=7]="TenantPatchThrottleFailed"}(r||(r={}))},12:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return h}));var r,i=n(206),o=n(11),s=n(7);function a(e,t,n,r){return c(e,t?t.id:"?",n,r)}function c(e,t,n,r){var o=Object(i.a)(e);return{videoId:t,stack:void 0!==o.stack?o.stack:(new Error).stack||s.c.Missing,message:void 0!==o.message?o.message:s.b.Missing,staticMessage:n,embedVideoErrorType:r}}function u(e,t){return{authState:o.a[e],reason:t}}function l(){return{staticMessage:"Cookies blocked: browser is blocking our cookies.",stack:(new Error).stack||s.c.Missing,message:s.b.Missing}}function d(){return{staticMessage:"Cookies blocked: Cookies blocked due to IOS 13 issue.",stack:(new Error).stack||s.c.Missing,message:s.b.Missing}}function h(e){return{staticMessage:e,stack:(new Error).stack||s.c.Missing,message:s.b.Missing}}!function(e){e.PluginError="PluginError",e.InitError="InitError",e.VideoStatusError="VideoStatusError",e.RenderError="RenderError",e.GetVideoError="GetVideoError",e.VideoMigrationStatusError="VideoMigrationStatusError"}(r||(r={}))},127:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={token:"",expiry:new Date(0)}},129:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n(0),i=n(7);function o(e,t,n){return new Promise((function(r,i){s(e,(function(){r()}),(function(){i()}),t,null,0,n)}))}function s(e,t,n,r,o,a,c){if(void 0===o&&(o=null),void 0===a&&(a=0),a>=3)return o&&document.body.removeChild(o),void n();var u=document.createElement("script");if(u.type="text/javascript",u.onload=t,u.onerror=function(o){if(0===a){var l={stack:(new Error).stack||i.c.Missing,message:e};r.warnThin("StaticResourceLoadingFailed",l)}s(e,t,n,r,u,a+1,c)},u.async=!0,u.src=e,c)for(var l=0,d=Object.keys(c);l<d.length;l++){var h=d[l];u[h]=c[h]}o&&document.body.removeChild(o),document.body.appendChild(u)}function a(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return[4,n.e(186).then(n.bind(null,464))];case 1:return[2,e.sent()]}}))}))}},13:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return u}));var r={Relevance:"relevance",PublishDate:"publishedDate",UploadDate:"created",Published:"published",Trending:"metrics/trendingScore",Views:"metrics/views",Likes:"metrics/likes",PinnedDate:"userData/pinnedDate",LastViewDate:"userData/lastViewDate",Name:"name",StartDate:"liveEvent/startTime"},i={Ascending:"asc",Descending:"desc"},o={Creator:"creator",Tokens:"tokens",Status:"status",LiveEvent:"liveEvent",Extensions:"extensions",Group:"group",Principal:"principal",Role:"role"},s={Like:"like",UnLike:"unlike",Viewed:"viewed",Pin:"pin",UnPin:"unpin",Status:"status",GetLinks:"getLinks",SetLinks:"setLinks",SetVideoPermissions:"setVideoPermissions",Channels:"channels",RoleAssignments:"roleassignments"},a={GetMigrationStatus:"migrationStatus"},c={Video:"/videos/:id",VideoTokens:"/videos/:id/tokens",VideoTrim:"/videos/:id/postprocess",VideoFile:"/videos/:id/files"},u={videoUserData:"videoUserData",networkCaching:"networkCaching"}},130:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var r={DefaultSkip:0,DefaultTop:8,DefaultFaceTop:3,MaxTop:100},i={Filter:"$filter",OrderBy:"$orderby",Skip:"$skip",Top:"$top",Select:"$select",Expand:"$expand",AdminMode:"adminmode",ApiVersion:"apiVersion",Id:"id",IsInAdminMode:"isInAdminMode"},o={ClientNetworkError:"-1",Unauthorized:"401",Forbidden:"403",NotFound:"404",OperationNotAllowed:"405",Conflict:"409",Accepted:"202",OK:"200",BadRequest:"400",PreConditionFailed:"412"}},137:function(e,t,n){e.exports=n.p+"media/segoeui.0810f2c3.woff"},150:function(e,t,n){var r=n(94),i=n(95);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},156:function(e,t,n){var r,i,o=n(94),s=n(95),a=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,l=t||[],d=(e=e||{}).node||r,h=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==h){var f=o();null==d&&(d=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=i=16383&(f[6]<<8|f[7]))}var g=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:c+1,v=g-a+(p-c)/1e4;if(v<0&&void 0===e.clockseq&&(h=h+1&16383),(v<0||g>a)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=g,c=p,i=h;var m=(1e4*(268435455&(g+=122192928e5))+p)%4294967296;l[u++]=m>>>24&255,l[u++]=m>>>16&255,l[u++]=m>>>8&255,l[u++]=255&m;var y=g/4294967296*1e4&268435455;l[u++]=y>>>8&255,l[u++]=255&y,l[u++]=y>>>24&15|16,l[u++]=y>>>16&255,l[u++]=h>>>8|128,l[u++]=255&h;for(var S=0;S<6;++S)l[u+S]=d[S];return t||s(l)}},157:function(e,t,n){"use strict";(function(t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(158),o=n(159),s=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,a=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,c=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function u(e){return(e||"").toString().replace(c,"")}var l=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};function h(e){var n,i=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},o={},a=r(e=e||i);if("blob:"===e.protocol)o=new g(unescape(e.pathname),{});else if("string"===a)for(n in o=new g(e,{}),d)delete o[n];else if("object"===a){for(n in e)n in d||(o[n]=e[n]);void 0===o.slashes&&(o.slashes=s.test(e.href))}return o}function f(e){e=u(e);var t=a.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function g(e,t,n){if(e=u(e),!(this instanceof g))return new g(e,t,n);var s,a,c,d,p,v,m=l.slice(),y=r(t),S=this,b=0;for("object"!==y&&"string"!==y&&(n=t,t=null),n&&"function"!=typeof n&&(n=o.parse),t=h(t),s=!(a=f(e||"")).protocol&&!a.slashes,S.slashes=a.slashes||s&&t.slashes,S.protocol=a.protocol||t.protocol||"",e=a.rest,a.slashes||(m[3]=[/(.*)/,"pathname"]);b<m.length;b++)"function"!=typeof(d=m[b])?(c=d[0],v=d[1],c!=c?S[v]=e:"string"==typeof c?~(p=e.indexOf(c))&&("number"==typeof d[2]?(S[v]=e.slice(0,p),e=e.slice(p+d[2])):(S[v]=e.slice(p),e=e.slice(0,p))):(p=c.exec(e))&&(S[v]=p[1],e=e.slice(0,p.index)),S[v]=S[v]||s&&d[3]&&t[v]||"",d[4]&&(S[v]=S[v].toLowerCase())):e=d(e);n&&(S.query=n(S.query)),s&&t.slashes&&"/"!==S.pathname.charAt(0)&&(""!==S.pathname||""!==t.pathname)&&(S.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,i=n[r-1],o=!1,s=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),s++):s&&(0===r&&(o=!0),n.splice(r,1),s--);return o&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}(S.pathname,t.pathname)),i(S.port,S.protocol)||(S.host=S.hostname,S.port=""),S.username=S.password="",S.auth&&(d=S.auth.split(":"),S.username=d[0]||"",S.password=d[1]||""),S.origin=S.protocol&&S.host&&"file:"!==S.protocol?S.protocol+"//"+S.host:"null",S.href=S.toString()}g.prototype={set:function(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||o.parse)(t)),r[e]=t;break;case"port":r[e]=t,i(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,/:\d+$/.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(t){var s="pathname"===e?"/":"#";r[e]=t.charAt(0)!==s?s+t:t}else r[e]=t;break;default:r[e]=t}for(var a=0;a<l.length;a++){var c=l[a];c[4]&&(r[c[1]]=r[c[1]].toLowerCase())}return r.origin=r.protocol&&r.host&&"file:"!==r.protocol?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(e){e&&"function"==typeof e||(e=o.stringify);var t,n=this,i=n.protocol;i&&":"!==i.charAt(i.length-1)&&(i+=":");var s=i+(n.slashes?"//":"");return n.username&&(s+=n.username,n.password&&(s+=":"+n.password),s+="@"),s+=n.host+n.pathname,(t="object"===r(n.query)?e(n.query):n.query)&&(s+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(s+=n.hash),s}},g.extractProtocol=f,g.location=h,g.trimLeft=u,g.qs=o,e.exports=g}).call(this,n(41))},158:function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},159:function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}t.stringify=function(e,t){t=t||"";var n,i,o=[];for(i in"string"!=typeof t&&(t="?"),e)if(r.call(e,i)){if((n=e[i])||null!=n&&!isNaN(n)||(n=""),i=encodeURIComponent(i),n=encodeURIComponent(n),null===i||null===n)continue;o.push(i+"="+n)}return o.length?t+o.join("&"):""},t.parse=function(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);){var o=i(t[1]),s=i(t[2]);null===o||null===s||o in r||(r[o]=s)}return r}},160:function(e,t,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}},161:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=new RegExp("%[a-f0-9]{2}","gi"),o=new RegExp("(%[a-f0-9]{2})+","gi");function s(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],s(n),s(r))}function a(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(i),n=1;n<t.length;n++)t=(e=s(t,n).join("")).match(i);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+r(e)+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=o.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=a(n[0]);r!==n[0]&&(t[n[0]]=r)}n=o.exec(e)}t["%C2"]="�";for(var i=Object.keys(t),s=0;s<i.length;s++){var c=i[s];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},162:function(e,t,n){"use strict";e.exports=function(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];var n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},17:function(e,t,n){var r,i,o;i=[],void 0===(o="function"==typeof(r=function(){var e,t,n=6e4,r=y(n),i="",o=!1;function s(){var t="__lscachetest__";if(void 0!==e)return e;try{if(!localStorage)return!1}catch(e){return!1}try{h(t,"__lscachetest__"),f(t),e=!0}catch(t){e=!(!a(t)||!localStorage.length)}return e}function a(e){return e&&("QUOTA_EXCEEDED_ERR"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||"QuotaExceededError"===e.name)}function c(){return void 0===t&&(t=null!=window.JSON),t}function u(e){return e+"-cacheexpiration"}function l(){return Math.floor((new Date).getTime()/n)}function d(e){return localStorage.getItem("lscache-"+i+e)}function h(e,t){localStorage.removeItem("lscache-"+i+e),localStorage.setItem("lscache-"+i+e,t)}function f(e){localStorage.removeItem("lscache-"+i+e)}function g(e){for(var t=new RegExp("^lscache-"+i.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")+"(.*)"),n=localStorage.length-1;n>=0;--n){var r=localStorage.key(n);(r=(r=r&&r.match(t))&&r[1])&&r.indexOf("-cacheexpiration")<0&&e(r,u(r))}}function p(e){var t=u(e);f(e),f(t)}function v(e){var t=u(e),n=d(t);if(n){var r=parseInt(n,10);if(l()>=r)return f(e),f(t),!0}}function m(e,t){o&&"console"in window&&"function"==typeof window.console.warn&&(window.console.warn("lscache - "+e),t&&window.console.warn("lscache - The error was: "+t.message))}function y(e){return Math.floor(864e13/e)}return{set:function(e,t,n){if(!s())return!1;if(!c())return!1;try{t=JSON.stringify(t)}catch(e){return!1}try{h(e,t)}catch(n){if(!a(n))return m("Could not add item with key '"+e+"'",n),!1;var i,o=[];g((function(e,t){var n=d(t);n=n?parseInt(n,10):r,o.push({key:e,size:(d(e)||"").length,expiration:n})})),o.sort((function(e,t){return t.expiration-e.expiration}));for(var v=(t||"").length;o.length&&v>0;)i=o.pop(),m("Cache is full, removing item with key '"+e+"'"),p(i.key),v-=i.size;try{h(e,t)}catch(t){return m("Could not add item with key '"+e+"', perhaps it's too big?",t),!1}}return n?h(u(e),(l()+n).toString(10)):f(u(e)),!0},get:function(e){if(!s())return null;if(v(e))return null;var t=d(e);if(!t||!c())return t;try{return JSON.parse(t)}catch(e){return t}},remove:function(e){s()&&p(e)},supported:function(){return s()},flush:function(){s()&&g((function(e){p(e)}))},flushExpired:function(){s()&&g((function(e){v(e)}))},setBucket:function(e){i=e},resetBucket:function(){i=""},getExpiryMilliseconds:function(){return n},setExpiryMilliseconds:function(e){r=y(n=e)},enableWarnings:function(e){o=e}}})?r.apply(t,i):r)||(e.exports=o)},198:function(e,t,n){var r={"./ar/strings.json":[359,57],"./bg/strings.json":[360,63],"./ca/strings.json":[361,70],"./cs/strings.json":[362,75],"./da/strings.json":[363,79],"./de/strings.json":[364,82],"./el/strings.json":[365,87],"./es/strings.json":[366,93],"./et/strings.json":[367,96],"./eu/strings.json":[368,99],"./fi/strings.json":[369,103],"./fr/strings.json":[370,109],"./gl/strings.json":[371,114],"./he/strings.json":[372,119],"./hr/strings.json":[373,123],"./hu/strings.json":[374,126],"./id/strings.json":[375,130],"./it/strings.json":[376,134],"./ja/strings.json":[377,137],"./ko/strings.json":[378,144],"./lt/strings.json":[379,154],"./lv/strings.json":[380,157],"./nb/strings.json":[381,167],"./nl/strings.json":[382,171],"./pl/strings.json":[383,180],"./pt-br/strings.json":[384,190],"./pt-pt/strings.json":[385,192],"./ro/strings.json":[386,200],"./ru/strings.json":[387,203],"./sk/strings.json":[388,211],"./sl/strings.json":[389,214],"./sr-cyrl-rs/strings.json":[390,220],"./sr-latn-rs/strings.json":[391,222],"./sv/strings.json":[392,227],"./th/strings.json":[393,233],"./tr/strings.json":[394,241],"./uk/strings.json":[395,246],"./vi/strings.json":[396,257],"./zh-hans/strings.json":[397,263],"./zh-hant/strings.json":[398,265]};function i(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],i=t[0];return n.e(t[1]).then((function(){return n.t(i,3)}))}i.keys=function(){return Object.keys(r)},i.id=198,e.exports=i},20:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(0),i=n(70);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return e?e.name||(e.name="undefinedNullOrEmptyEventName"):e={name:"undefinedOrNullEvent"},e}function a(e){var t={};return Object.keys(e).forEach((function(n){"object"!==o(e[n])?t[n]=e[n]:t=Object(r.a)(Object(r.a)({},t),e[n])})),t}function c(){var e=null;return document&&document.location&&(e=document.location.href),e}function u(){return Object(i.v4)()}},202:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(26),o=n(7),s=function(e,t,n){this.userLanguage=e,this.userRegion=t,this.isRightToLeft=n},a=function(){function e(e,t,n,r,i,o,s){this.supportedLanguages=e,this.rtlLanguages=t,this.cookie=n,this.query=r,this.browserLanguages=i,this.loggingService=o,this.telemetryViewContext=s}return e.prototype.getLocaleInfo=function(e){var t,n,a=this,c="default english",u="default english",l=i.parse(this.query).l;l&&"string"==typeof l&&(t="qps"===l?l:this.findLanguage(l))&&(c="query string");var d=this.getCookieByName("lang");if(!t&&d&&(t=this.findLanguage(d))&&(c="cookie"),(!t||!n)&&e&&e.system&&e.system.locale){var h=e.system.locale.language;!t&&h&&(t=this.findLanguage(h))&&(c="principal"),(n=e.system.locale.region)&&(u="principal")}if((!t||!n)&&this.browserLanguages){var f=this.browserLanguages.find((function(e){return!!a.findLanguage(e)}));f&&(t||(t=this.findLanguage(f))&&(c="browser languages"),n||this.browserLanguages.length>0&&(n=this.browserLanguages[0])&&(u="browser languages"))}if(!t||!n){var g="Failed to determine user ";t||(g+="language, "),n||(g+="region");var p={message:o.b.NotApplicable,stack:o.c.NotApplicable,staticMessage:g};this.loggingService.debug(g),this.loggingService.fatalThin("LocaleHelperServiceErrorAlert",Object(r.a)(Object(r.a)({},p),{viewContext:this.telemetryViewContext})),t||(t="en"),n||(n="en-US")}var v={viewContext:this.telemetryViewContext,language:t,region:n,languageRetrieval:c,regionRetrieval:u};return this.loggingService.appLogicThin("LocaleDetermined",v),new s(t,n,this.isLanguageRTL("qps"===t?"en":t))},e.prototype.findLanguage=function(e){if(e)return e=e.toLowerCase(),this.supportedLanguages.find((function(t){return t.toLowerCase()===e||0===e.indexOf(t+"-")}))},e.prototype.isLanguageRTL=function(e){return void 0!==this.rtlLanguages.find((function(t){return t===e}))},e.prototype.getCookieByName=function(e){var t=this.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));if(t)return t[2]},e}()},204:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e,t,n){return void 0===n&&(n=!0),Object(r.b)(this,void 0,void 0,(function(){var i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:i=n?0:3,r.label=1;case 1:if(!(i<=3))return[3,9];r.label=2;case 2:return r.trys.push([2,4,,8]),[4,e()];case 3:return[2,r.sent()];case 4:return s=r.sent(),++i>3?(o=s,[3,7]):[3,5];case 5:return[4,(a=200*Math.pow(2,i),new Promise((function(e){return setTimeout(e,a)})))];case 6:r.sent(),r.label=7;case 7:return[3,8];case 8:return[3,1];case 9:return[4,t(o&&o.request||"")];case 10:throw r.sent(),o}var a}))}))}},206:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=new Map;return JSON.stringify(e,(function(e,t){if(n.has(t)){var r=n.get(t);return""!==r?"<recursive in '"+r+"'>":"<recursive>"}return"object"===i(t)&&n.set(t,e),t}),t)}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=function(e){function t(n,r){var i=e.call(this,r&&r.length>0?r+": "+o(n):o(n))||this;return i.error=n,void 0!==s(Object.setPrototypeOf)&&Object.setPrototypeOf(i,t.prototype),i}return Object(r.d)(t,e),t}(Error);function c(e,t){return e instanceof Error?e:"string"==typeof e?new Error(t?t+": "+e:e):new a(e,t)}},21:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return r}));var r,i=n(3),o=(i.b.stringOrAnyGuid,i.b.number,i.b.string,i.b.string,i.a.scrub,i.a.scrub,i.a.scrub,i.a.scrub,i.a.scrub,"SCRUBBED"),s="FRAME_SCRUBBED",a="INVALID",c="[GUID]",u="[redacted]";!function(e){e.NotLoadedUrl="https://privacyScrubberNotLoaded/",e.InvalidUriErrorUrl="https://privacyScrubberInvalidUriError/"}(r||(r={}))},26:function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=n(160),u=n(161),l=n(162);function d(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function h(e,t){return t.encode?t.strict?c(e):encodeURIComponent(e):e}function f(e,t){return t.decode?u(e):e}function g(e){var t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function p(e){var t=(e=g(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function v(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function m(e,t){d((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return function(t,n,r){var i="string"==typeof n&&n.includes(e.arrayFormatSeparator),o="string"==typeof n&&!i&&f(n,e).includes(e.arrayFormatSeparator);n=o?f(n,e):n;var s=i||o?n.split(e.arrayFormatSeparator).map((function(t){return f(t,e)})):null===n?n:f(n,e);r[t]=s};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),o=Object.create(null);if("string"!=typeof e)return o;if(!(e=e.trim().replace(/^[?#&]/,"")))return o;var a,c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}(e.split("&"));try{for(c.s();!(a=c.n()).done;){var u=a.value,h=r(l(t.decode?u.replace(/\+/g," "):u,"="),2),g=h[0],p=h[1];p=void 0===p?null:["comma","separator"].includes(t.arrayFormat)?p:f(p,t),n(f(g,t),p,o)}}catch(e){c.e(e)}finally{c.f()}for(var m=0,y=Object.keys(o);m<y.length;m++){var S=y[m],b=o[S];if("object"===i(b)&&null!==b)for(var T=0,w=Object.keys(b);T<w.length;T++){var E=w[T];b[E]=v(b[E],t)}else o[S]=v(b,t)}return!1===t.sort?o:(!0===t.sort?Object.keys(o).sort():Object.keys(o).sort(t.sort)).reduce((function(e,t){var n=o[t];return Boolean(n)&&"object"===i(n)&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"===i(t)?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(n):e[t]=n,e}),Object.create(null))}t.extract=p,t.parse=m,t.stringify=function(e,t){if(!e)return"";d((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);for(var n=function(n){return t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n]},r=function(e){switch(e.arrayFormat){case"index":return function(t){return function(n,r){var i=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(o(n),null===r?[[h(t,e),"[",i,"]"].join("")]:[[h(t,e),"[",h(i,e),"]=",h(r,e)].join("")])}};case"bracket":return function(t){return function(n,r){return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(o(n),null===r?[[h(t,e),"[]"].join("")]:[[h(t,e),"[]=",h(r,e)].join("")])}};case"comma":case"separator":return function(t){return function(n,r){return null==r||0===r.length?n:0===n.length?[[h(t,e),"=",h(r,e)].join("")]:[[n,h(r,e)].join(e.arrayFormatSeparator)]}};default:return function(t){return function(n,r){return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(o(n),null===r?[h(t,e)]:[[h(t,e),"=",h(r,e)].join("")])}}}}(t),i={},s=0,a=Object.keys(e);s<a.length;s++){var c=a[s];n(c)||(i[c]=e[c])}var u=Object.keys(i);return!1!==t.sort&&u.sort(t.sort),u.map((function(n){var i=e[n];return void 0===i?"":null===i?h(n,t):Array.isArray(i)?i.reduce(r(n),[]).join("&"):h(n,t)+"="+h(i,t)})).filter((function(e){return e.length>0})).join("&")},t.parseUrl=function(e,t){t=Object.assign({decode:!0},t);var n=r(l(e,"#"),2),i=n[0],o=n[1];return Object.assign({url:i.split("?")[0]||"",query:m(p(e),t)},t&&t.parseFragmentIdentifier&&o?{fragmentIdentifier:f(o,t)}:{})},t.stringifyUrl=function(e,n){n=Object.assign({encode:!0,strict:!0},n);var r=g(e.url).split("?")[0]||"",i=t.extract(e.url),o=t.parse(i,{sort:!1}),s=Object.assign(o,e.query),a=t.stringify(s,n);a&&(a="?".concat(a));var c=function(e){var t="",n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(c="#".concat(h(e.fragmentIdentifier,n))),"".concat(r).concat(a).concat(c)}},3:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,o;n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),function(e){e.string="string",e.stringOrAnyGuid="stringOrAnyGuid",e.number="number"}(i||(i={})),function(e){e.scrub="scrub",e.scrubOrAnyGuid="scrubOrAnyGuid",e.drop="drop"}(o||(o={}));var s=function(){this.FullPath="",this.Strategy=o.scrub};function a(e){var t=!0,n=new s;return null!==e&&"object"===r(e)&&Array.isArray(e)?e.forEach((function(e){Object.keys(n).forEach((function(n){t=t&&n in e}))})):t=!1,t}function c(e){return"string"==typeof e&&e in o}},32:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return l}));var r=24e4,i=3e4,o=50,s="refreshtoken",a=15e3,c="en",u="SM::",l="Session"},354:function(e,t,n){"use strict";var r=n(355),i=n(460);function o(e,t){return 55296==(64512&e.charCodeAt(t))&&(!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1)))}function s(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function a(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=i,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)n.push(parseInt(e[i]+e[i+1],16))}else for(var r=0,i=0;i<e.length;i++){var s=e.charCodeAt(i);s<128?n[r++]=s:s<2048?(n[r++]=s>>6|192,n[r++]=63&s|128):o(e,i)?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++i)),n[r++]=s>>18|240,n[r++]=s>>12&63|128,n[r++]=s>>6&63|128,n[r++]=63&s|128):(n[r++]=s>>12|224,n[r++]=s>>6&63|128,n[r++]=63&s|128)}else for(i=0;i<e.length;i++)n[i]=0|e[i];return n},t.toHex=function(e){for(var t="",n=0;n<e.length;n++)t+=a(e[n].toString(16));return t},t.htonl=s,t.toHex32=function(e,t){for(var n="",r=0;r<e.length;r++){var i=e[r];"little"===t&&(i=s(i)),n+=c(i.toString(16))}return n},t.zero2=a,t.zero8=c,t.join32=function(e,t,n,i){var o=n-t;r(o%4==0);for(var s=new Array(o/4),a=0,c=t;a<s.length;a++,c+=4){var u;u="big"===i?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],s[a]=u>>>0}return s},t.split32=function(e,t){for(var n=new Array(4*e.length),r=0,i=0;r<e.length;r++,i+=4){var o=e[r];"big"===t?(n[i]=o>>>24,n[i+1]=o>>>16&255,n[i+2]=o>>>8&255,n[i+3]=255&o):(n[i+3]=o>>>24,n[i+2]=o>>>16&255,n[i+1]=o>>>8&255,n[i]=255&o)}return n},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,n){return e+t+n>>>0},t.sum32_4=function(e,t,n,r){return e+t+n+r>>>0},t.sum32_5=function(e,t,n,r,i){return e+t+n+r+i>>>0},t.sum64=function(e,t,n,r){var i=e[t],o=r+e[t+1]>>>0,s=(o<r?1:0)+n+i;e[t]=s>>>0,e[t+1]=o},t.sum64_hi=function(e,t,n,r){return(t+r>>>0<t?1:0)+e+n>>>0},t.sum64_lo=function(e,t,n,r){return t+r>>>0},t.sum64_4_hi=function(e,t,n,r,i,o,s,a){var c=0,u=t;return c+=(u=u+r>>>0)<t?1:0,c+=(u=u+o>>>0)<o?1:0,e+n+i+s+(c+=(u=u+a>>>0)<a?1:0)>>>0},t.sum64_4_lo=function(e,t,n,r,i,o,s,a){return t+r+o+a>>>0},t.sum64_5_hi=function(e,t,n,r,i,o,s,a,c,u){var l=0,d=t;return l+=(d=d+r>>>0)<t?1:0,l+=(d=d+o>>>0)<o?1:0,l+=(d=d+a>>>0)<a?1:0,e+n+i+s+c+(l+=(d=d+u>>>0)<u?1:0)>>>0},t.sum64_5_lo=function(e,t,n,r,i,o,s,a,c,u){return t+r+o+a+u>>>0},t.rotr64_hi=function(e,t,n){return(t<<32-n|e>>>n)>>>0},t.rotr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0},t.shr64_hi=function(e,t,n){return e>>>n},t.shr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0}},355:function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=n,n.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},357:function(e,t,n){"use strict";var r;function i(e,t,n,i){n=n||{},i=i||{};var o=[e,t].filter((function(e){return e.length})).join("/"),s={id:"",apiVersion:""},a=o.replace(/:(\w+?)(\W|$)/g,(function(e,t,o){if(!n[t])return""+o;var a=n[t];return"string"==typeof a&&"@"===a[0]&&(a=r.lookupDottedPath(i||{},a.substring(1))),"function"==typeof a&&(a=a()),s[t]=a,a+o})),c={};Object.keys(n).forEach((function(e){s[e]||(c[e]="function"==typeof n[e]?n[e]():n[e])})),a=a.split("://").map((function(e){return e.replace(/[\/]{2,}/g,"/")})).join("://"),a=r.encodeUri(a);var u=r.getQueryString(c);return u&&(a=a+(/\?/.test(a)?"&":"?")+u),a}n.d(t,"a",(function(){return i})),function(e){function t(e){return e&&e.length?e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase():""}function n(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}e.lookupDottedPath=function(e,t){try{return""+(t||"").split(".").reduce((function(e,t){return e[t]}),e)}catch(e){return""}},e.getQueryString=function(e){return Object.keys(e).map((function(r){return n(t(r))+"="+n(e[r])})).join("&")},e.camelCaseToHyphens=t,e.encodeUri=function(e){return encodeURI(e).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+").replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},e.encodeQueryStringComponent=n}(r||(r={}))},4:function(e,t,n){"use strict";(function(e){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var i="function",o="object",s="undefined",a="prototype";function c(){return("undefined"==typeof globalThis?"undefined":r(globalThis))!==s&&globalThis?globalThis:("undefined"==typeof self?"undefined":r(self))!==s&&self?self:("undefined"==typeof window?"undefined":r(window))!==s&&window?window:(void 0===e?"undefined":r(e))!==s&&e?e:null}function u(e){var t=Object.create;if(t)return t(e);if(null==e)return{};var n=r(e);if(n!==o&&n!==i)throw new TypeError("Object prototype may only be an Object:"+e);function s(){}return s[a]=e,new s}var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var d,h,f,g=c()||{};h=function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object[a].hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f=function(e,t){function n(){this.constructor=e}l(e,t),e[a]=null===t?u(t):(n[a]=t[a],new n)},(d=g).__assign||(d.__assign=Object.assign||h),d.__extends||(d.__extends=f),__assign||(__assign=g.__assign),__extends||(__extends=g.__extends)}).call(this,n(41))},40:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e.Created="created",e.Uploading="uploading",e.Processing="processing",e.Error="error",e.Completed="completed",e.Live="live"}(r||(r={})),function(e){e.NotStarted="NotStarted",e.Processing="Processing",e.Partial="Partial",e.Completed="Completed",e.Error="Error"}(i||(i={}));var o,s,a,c;!function(e){e.Playable="playable",e.NotReady="notReady",e.NotFound="notFound",e.Forbidden="forbidden",e.VideoError="videoError",e.UnknownError="unknownError"}(o||(o={})),function(e){e.Caption="caption",e.Encoding="encoding",e.Replacing="replacing",e.Trimming="trimming"}(s||(s={})),function(e){e.Processing="processing",e.Completed="completed",e.Error="error"}(a||(a={})),function(e){e.Pinned="userData/isPinned",e.DataQueryDefault="published and (state eq 'Completed' or contentSource eq 'livestream')"}(c||(c={}))},403:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Navigation="Navigation",e.Sharing="Sharing",e.Telemetry="Telemetry",e.FeatureFlagsFactory="FeatureFlagsFactory",e.VideoPlayback="VideoPlayback",e.ProducerPlayback="ProducerPlayback",e.LivePlayback="LivePlayback",e.Forms="Forms",e.Search="Search",e.Transcript="Transcript",e.Playlist="Playlist",e.SessionManager="SessionManager",e.InjectedAuth="InjectedAuth",e.Chaptering="Chaptering",e.Channel="Channel",e.Group="Group",e.OCV="OCV",e.Role="Role",e.Tenant="Tenant",e.TextTrack="TextTrack",e.Survey="Survey",e.Video="Video",e.VideoEvent="VideoEvent",e.DataFetcher="DataFetcher",e.Principal="Principal",e.SDN="SDN"}(r||(r={}))},404:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(26),i=n(7),o=function(){function e(){}return e.initialize=function(t){e.loggingService=t},e.getPrivacyScrubber=function(){return e.loggingService?e.loggingService.PrivacyScrubber:void 0},e.logError=function(t){if(e.loggingService){var n=i.c.Missing,o=t.message?t.message:"";void 0!==o&&""!==o||t.error&&("string"==typeof t.error?o=t.error:t.error instanceof Error&&(o=t.error.message,t.error.stack&&(n=t.error.stack)));var s,a=Object(r.parse)(window.location.search.toLowerCase());"string"==typeof a.app&&(s=a.app);var c={methodName:t.method,message:o,statusCode:t.statusCode,staticMessage:t.staticMessage,url:t.url,appName:s,stack:n,groupings:t.groupings,clientRequestId:t.clientRequestId},u="RestCallError";t.isFatal?e.loggingService.fatalThin(u,c):e.loggingService.warnThin(u,c)}},e}()},405:function(e,t,n){"use strict";function r(){var e="",t=0;for(t=0;t<32;t+=1){var n=16*Math.random()|0;switch(t){case 8:case 12:case 16:case 20:e+="-"}e+=n.toString(16)}return e}n.d(t,"a",(function(){return r}))},406:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(100),i=function(){function e(e,t){this._value=e,this.onCallbackError=t,this._observable=new r.a(t)}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this._observable.notify(e)},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e,t){try{e(this.value)}catch(e){this.onCallbackError&&this.onCallbackError(e)}return t&&t.unregisterOnFirstCall?function(){}:this._observable.subscribe(e,t)},e}()},407:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t){this.errorState=e,this.logStateChanged=t,this._stateMap=new Map,this.nextStateChangeCallbacks=[],this.currState=void 0}return e.prototype.getState=function(e){return!!this._stateMap.has(e)&&this._stateMap.get(e)},e.prototype.waitForStates=function(e){var t=this;if(this.errorHasOccurred())return Promise.resolve(!1);return new Promise((function(n){!function n(r){if(t.errorHasOccurred())r(!1);else{for(var i=!0,o=0,s=e;o<s.length;o++){var a=s[o];if(!t.getState(a)){i=!1;break}}i?r(!0):t.nextStateChangeCallbacks.push((function(){n(r)}))}}(n)}))},e.prototype.setState=function(e,t){void 0===t&&(t=!0),this.getState(e)!==t&&(this._stateMap.set(e,t),this.logStateChanged(e,this.currState),this.currState=e,this.triggerStateChanges())},e.prototype.triggerStateChanges=function(){for(var e=0,t=this.nextStateChangeCallbacks.splice(0,this.nextStateChangeCallbacks.length);e<t.length;e++){(0,t[e])()}},e.prototype.errorHasOccurred=function(){return this.getState(this.errorState)},e}()},408:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),i=n(48);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=function(){function e(){this.anonymousPrincipalSettings={web:{playbackSettings:{textTrackSettings:{showTextTrack:!1}}}},this.anonymousPrincipalServicePlans={id:"anonymous",assignedPlans:[{id:"anonymous",name:"anonymous"}],capabilities:{createVideo:!1,updateVideo:!1,deleteVideo:!1,createChannel:!1,updateChannel:!1,deleteChannel:!1,createGroup:!1,updateGroup:!1,deleteGroup:!1,transcriptSearch:!1,transcriptEvent:!1,faceEvent:!1,viewForm:!1,manageForm:!1}}}return e.prototype.getPrincipalInfo=function(e){throw new Error(Object(i.c)("Not supported in anonymous mode"))},e.prototype.getPrincipalSettings=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){return[2,Promise.resolve(this.anonymousPrincipalSettings)]}))}))},e.prototype.getPrincipalServicePlans=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){return[2,Promise.resolve(this.anonymousPrincipalServicePlans)]}))}))},e.prototype.patchMySettings=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(e){return this.mergeSettings(this.anonymousPrincipalSettings,t),[2,Promise.resolve(this.anonymousPrincipalSettings)]}))}))},e.prototype.mergeSettings=function(e,t){for(var n in t)"object"===o(t[n])&&e[n]?this.mergeSettings(e[n],t[n]):e[n]=t[n]},e}()},409:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20),i=function(e,t){this.viewName=e,this.details=t,this.url=Object(r.c)()}},41:function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},410:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(98),o=function(){function e(e){this.directionKey="direction",this.currentDirection="ltr",this.comment=".comment",this.missingKeys=[];this.options=Object(r.a)(Object(r.a)({},{pseudo:!1}),e);var t=e.langResourceMap||Object(r.a)({},i.a);this.allStrings=t,this.availableLanguages=Object.keys(t),this.availableLanguages&&this.availableLanguages.length>0&&(this.currentLang=this.options.defaultLang&&-1!==this.availableLanguages.indexOf(this.options.defaultLang)?this.options.defaultLang:this.availableLanguages[0])}return e.prototype.waitDefaultResourcesLoad=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(t){switch(t.label){case 0:return void 0===(this.currentLang?this.allStrings[this.currentLang]:void 0)&&this.options.loadDefaultStringsAsync&&this.currentLang?[4,this.options.loadDefaultStringsAsync()]:[3,2];case 1:e=t.sent(),this.allStrings[this.currentLang]=e,t.label=2;case 2:return this.defaultLangStrings=this.currentLang?this.allStrings[this.currentLang]:void 0,this.defaultLangStrings&&this.defaultLangStrings[this.directionKey]&&this.options.rootElement&&(this.currentDirection=this.defaultLangStrings[this.directionKey],this.options.rootElement.dir=this.currentDirection),[2]}}))}))},e.prototype.setLanguage=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(-1===this.availableLanguages.indexOf(e)||e===this.options.defaultLang)return[3,5];if(this.currentLang=e,void 0!==this.allStrings[this.currentLang])return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.options.loadNonDefaultLangAsync(this.currentLang)];case 2:return t=r.sent(),this.allStrings[this.currentLang]=t,[3,4];case 3:return n=r.sent(),this.onMissingLanguage&&this.onMissingLanguage(n),[3,4];case 4:this.currentLangStrings=this.allStrings[this.currentLang],this.currentLangStrings&&this.currentLangStrings[this.directionKey]&&this.options.rootElement&&(this.currentDirection=this.currentLangStrings[this.directionKey],this.options.rootElement.dir=this.currentDirection),r.label=5;case 5:return[2]}}))}))},e.prototype.getString=function(e){if("_"===e.substring(0,1)&&e.substring(e.length-this.comment.length))return"";if(this.currentLangStrings&&e in this.currentLangStrings){var t=this.currentLangStrings[e];return this.options.pseudo?this.randomString(t.length):t}if(this.defaultLangStrings&&e in this.defaultLangStrings){this.onMissingTranslation&&!this.missingKeys.includes(e)&&this.currentLangStrings&&this.currentLang&&(this.missingKeys.push(e),this.onMissingTranslation(e,this.currentLang));t=this.defaultLangStrings[e];return this.options.pseudo?this.randomString(t.length):t}return""},e.prototype.getStringOr=function(e,t){if("_"===e.substring(0,1)&&e.substring(e.length-this.comment.length))return"";if(this.currentLangStrings&&e in this.currentLangStrings){var n=this.currentLangStrings[e];return this.options.pseudo?this.randomString(n.length):n}return t},e.prototype.setLoggers=function(e,t){this.onMissingLanguage=e,this.onMissingTranslation=t},Object.defineProperty(e.prototype,"direction",{get:function(){return this.currentDirection},enumerable:!0,configurable:!0}),e.prototype.randomString=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r+=1)t+=n.charAt(Math.floor(Math.random()*n.length));return t},e}()},411:function(e,t,n){"use strict";n.d(t,"a",(function(){return Wr})),n.d(t,"b",(function(){return Qr}));var r={};n.r(r),n.d(r,"Version",(function(){return ke})),n.d(r,"FullVersionString",(function(){return Pe})),n.d(r,"strUndefined",(function(){return Re})),n.d(r,"strObject",(function(){return _e})),n.d(r,"arrForEach",(function(){return Ge})),n.d(r,"arrIndexOf",(function(){return Be})),n.d(r,"arrMap",(function(){return He})),n.d(r,"arrReduce",(function(){return ze})),n.d(r,"objKeys",(function(){return Ke})),n.d(r,"toISOString",(function(){return We})),n.d(r,"isReactNative",(function(){return Qe})),n.d(r,"isString",(function(){return $e})),n.d(r,"isNumber",(function(){return Je})),n.d(r,"isBoolean",(function(){return Ye})),n.d(r,"isFunction",(function(){return Xe})),n.d(r,"isArray",(function(){return Ze})),n.d(r,"isObject",(function(){return et})),n.d(r,"strTrim",(function(){return tt})),n.d(r,"isDocumentObjectAvailable",(function(){return nt})),n.d(r,"isWindowObjectAvailable",(function(){return rt})),n.d(r,"isValueAssigned",(function(){return it})),n.d(r,"getTenantId",(function(){return ot})),n.d(r,"isBeaconsSupported",(function(){return st})),n.d(r,"isUint8ArrayAvailable",(function(){return at})),n.d(r,"isLatency",(function(){return ct})),n.d(r,"sanitizeProperty",(function(){return ut})),n.d(r,"getISOString",(function(){return lt})),n.d(r,"useXDomainRequest",(function(){return dt})),n.d(r,"getCommonSchemaMetaData",(function(){return ht})),n.d(r,"cookieAvailable",(function(){return ft})),n.d(r,"disallowsSameSiteNone",(function(){return gt})),n.d(r,"setCookie",(function(){return pt})),n.d(r,"deleteCookie",(function(){return vt})),n.d(r,"getCookie",(function(){return mt})),n.d(r,"createGuid",(function(){return yt})),n.d(r,"extend",(function(){return St})),n.d(r,"getTime",(function(){return bt})),n.d(r,"isValueKind",(function(){return wt})),n.d(r,"isArrayValid",(function(){return Et})),n.d(r,"objDefineAccessors",(function(){return Ct})),n.d(r,"addPageUnloadEventListener",(function(){return Ot})),n.d(r,"setProcessTelemetryTimings",(function(){return It})),n.d(r,"addEventHandler",(function(){return xt})),n.d(r,"getFieldValueType",(function(){return At})),n.d(r,"strEndsWith",(function(){return kt}));var i=n(0),o=n(21),s=n(48),a=n(7),c=function(){function e(){}return e.isErrorMessageInAllowList=function(t){return[[2629270414,[]],[2088617118,[10]],[1737525859,[]],[2130502895,[9]],[1178833987,[]],[488448070,[9]],[596620353,[]],[3040621134,[36]],[2956233883,[]],[4115292574,[]],[2421334986,[39,53]],[1352199116,[]],[3846767544,[]],[3524375090,[]],[2682725065,[6,8,23]],[3119720747,[]],[1589266474,[]],[2216039769,[]],[3414433393,[11]],[3081950226,[15]],[3725376558,[]],[644885296,[]],[4141866811,[]],[1836600086,[]],[982396575,[0]],[3709693032,[0]],[1689284051,[0]],[1594098372,[75,78]],[3827832281,[16]],[2696823574,[]],[892546873,[]],[3066642868,[]],[4101390830,[]],[4068451482,[]],[187895691,[37]],[88021013,[15]],[764953272,[]],[859262350,[]],[519653657,[18]],[398223363,[12]],[2677102987,[]],[756726495,[]],[2414464484,[37,44]],[4089060913,[]],[2463176289,[]],[2968189423,[]],[2660161444,[23]],[3398381453,[23]],[3002739228,[15]],[3708611746,[40]],[492595211,[20]],[506785599,[18]],[2202427838,[]],[1716570162,[]],[906258278,[]],[2099833465,[28]],[2162010359,[]],[100726268,[]],[2632137031,[]],[755882173,[7,41]],[3290780583,[35]],[3477922139,[]],[440745912,[40,46]],[118413033,[]],[688355048,[26,31]],[4152071589,[16]],[1622609496,[]],[2810507193,[15]],[1137743060,[]],[797198601,[]],[3565558018,[]],[670147047,[]],[1952977301,[]],[921983148,[7]],[4218174057,[]],[300358129,[40]],[3528056995,[]],[1675686863,[]],[1555524069,[]],[4054001502,[29]],[3975281635,[0]],[571110085,[]],[3783953361,[22,28]],[161036957,[21,27]],[3535467428,[20,25]],[3499181191,[0]],[2296041036,[0]],[409228237,[0]],[801179427,[]],[2027200165,[0,28]],[468036106,[0]],[1293185262,[0]],[26715498,[35]],[685607770,[0]],[2577005664,[0,40]],[1077206334,[0]],[4250069493,[0]],[2604868405,[]],[2070458710,[18,23]],[3038979830,[18]],[53933209,[0]],[3494837289,[0]],[4064036886,[]],[1363827539,[27]],[182711559,[20]],[141307274,[]],[1363827551,[27]],[3320749051,[]],[451351940,[36]],[3314826626,[]],[3059788816,[]],[2534669442,[40]],[2849160186,[1,27,41]],[3408752716,[48]],[2661488898,[59]],[1924276959,[49]],[4247843539,[88]],[3910046394,[69]],[755808102,[69]],[3797000770,[62]],[110075538,[26,155,167]],[938041440,[26,171]],[2877460103,[76]],[3908648733,[94]],[3349751980,[85]],[982140457,[75]],[2221742147,[75]],[3942981546,[]],[2248815699,[]],[1899984834,[]],[2571496619,[52]],[2328152123,[52]],[4289120779,[94]],[1540291473,[]],[4211176916,[49]],[3421356754,[]],[2249069470,[]],[1228437868,[]],[2674132907,[]],[1353324682,[16]],[2076932346,[51]],[1602670360,[51]],[2997419583,[]],[2995390004,[1]],[3459191935,[1,50]],[1438511221,[26]],[2013327399,[]],[4031621281,[21]],[2610268359,[]],[2722000526,[]],[3489255996,[0,30]],[2511061698,[0]],[2688359333,[]],[3172689334,[17]],[1313919083,[]],[1156700115,[]],[1541731341,[]],[1495713417,[]],[2679445286,[24,30]],[2768943804,[]],[2291894996,[37,43,46]],[3132751208,[24,30,33]],[1533476413,[]],[2607640553,[]],[211006175,[0]],[864181151,[]],[3487961767,[]],[3564671846,[]],[3838467890,[]],[4264262823,[94]],[797946190,[12]],[2607033280,[0]],[4116725183,[0]],[543393013,[]],[1324619371,[15]],[3780556690,[]],[1210475778,[]],[1836096720,[]],[3376681631,[]],[771702814,[]],[3492066984,[86]],[4096901110,[]],[3440302684,[]],[2006088650,[]],[3366739874,[]],[3678705621,[19]],[832168919,[]],[2180428084,[23]],[4084516625,[]],[967753811,[24]],[3722230749,[13]],[2251336207,[14]],[3558673884,[]],[4145983524,[22]],[1691904394,[]],[2623415382,[]],[4283741004,[]],[3161635609,[]],[2734756679,[29]],[4163586508,[0,5,31]],[4290849548,[]],[123659539,[28]],[3207813817,[]],[1074892084,[]],[1591703187,[32]],[3037223682,[40]],[1633195017,[11,25,32]],[1503465331,[]],[42140878,[0]],[77653455,[]],[2019360442,[]],[3019449444,[0]],[448572136,[]],[1441796620,[]],[123169748,[]],[161721987,[]],[161938494,[]],[4206136126,[6,25,44]],[3116864378,[]],[208930023,[]],[830583625,[]],[2909896284,[]],[660096836,[]],[862724538,[]],[410854660,[]],[2742009233,[]],[3258730161,[]],[1118491287,[]],[990013918,[]],[1812793629,[21,83]],[3551847697,[]],[3177749203,[17,39]],[4145571670,[24]],[677026068,[]],[1036779033,[]],[2175712098,[]],[3953699874,[]],[235540629,[]],[3641641705,[]],[63111050,[]],[1219739094,[]],[1505412608,[]],[2081054773,[]],[2093006030,[]],[2440618814,[]],[673283607,[]],[628728096,[]],[293729682,[]],[19725543,[]]].some((function(n){return e.getHashWithWildcard(t,n[1])===n[0]}))},e.getHashWithWildcard=function(e,t){for(var n=0,r=0,i=[" ",",",".","'",'"',")","(","[","]","<",">","`",":"],o=!1,s=4294967296,a=1,c=0;c<e.length;c++)-1!==t.indexOf(n)?(o=!0,n++):o?-1!==i.indexOf(e.charAt(c))&&(o=!1,r=(r+"%".charCodeAt(0)*a)%s,a=31*a%s,r=(r+e.charCodeAt(c)*a)%s,a=31*a%s,n++):(r=(r+e.charCodeAt(c)*a)%s,a=31*a%s,n++);return o&&(r=(r+"%".charCodeAt(0)*a)%s),r},e}(),u=function(){function e(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=4),this.loggingService=e,this.logger=t,this.stackScrubbing=n,this.messageScrubbing=r,this.eventType="ErrorAlert",this.allowableHostSuffixes=["amp.azure.net","amsglob0cdnstream13.azureedge.net","amsglob0cdnstream14.azureedge.net",".microsoftstream.com",".microsoftstream.us",".stream.azure-test.net"]}return e.prototype.logUnhandled=function(e,t){var n=e&&e.message?e.message:a.b.Missing,r=e&&e.stack?e.stack:a.c.Missing,o={message:n,stack:r,staticMessage:t},s=a.d.UnhandledError;return r.includes("azuremediaplayer")||n.includes("azuremediaplayer")||t&&t.includes("azuremediaplayer")?s=a.d.AmpUnhandledError:(r.includes("pluginscript")||n.includes("pluginscript")||t&&t.includes("pluginscript"))&&(s=a.d.SdnUnhandledError),this.log(s,Object(i.a)({errorAlertType:a.a.Unhandled},o))},e.prototype.logWarning=function(e,t,n){return this.log(e,Object(i.a)({errorAlertType:a.a.Warning},t),n)},e.prototype.logFatal=function(e,t,n){return this.loggingService.getIsDevelopmentMode(),this.log(e,Object(i.a)({errorAlertType:a.a.Fatal},t),n)},e.prototype.log=function(e,t,n){var r=this.scrubMessage(t.message),o=Object(i.a)(Object(i.a)({},t),{message:r,stack:this.scrubStack(t.stack,t.message,r)}),s={name:e,data:Object(i.a)(Object(i.a)({eventType:this.eventType},this.loggingService.getContextsFields(e)),o),sync:n};this.logger.trackEvent(s)},e.prototype.scrubMessage=function(e){return e===a.b.Missing||void 0===e||""===e?a.b.Missing:4===this.messageScrubbing?o.c:0===this.messageScrubbing?e:2==(2&this.messageScrubbing)&&Object(s.b)(e)?Object(s.a)(e):1==(1&this.messageScrubbing)&&c.isErrorMessageInAllowList(e)?e:o.c},e.prototype.scrubStack=function(e,t,n){var r=this;if(e===a.c.Missing||void 0===e)return a.c.Missing;if(t!==n){if(e===t)return a.c.Missing;e=e.replace(t,n)}if(2===this.stackScrubbing){return e.split("\n").map((function(e){return r.anyDisallowedUrlsDetected(e)?o.d:e})).join("\n")}return 1!==this.stackScrubbing||this.anyDisallowedUrlsDetected(e)?3===this.stackScrubbing?e:o.c:e},e.prototype.anyDisallowedUrlsDetected=function(e){for(var t=/\b(https?:\/\/(?:[a-zA-Z0-9\-\.:])+)\/?/g,n=t.exec(e);n&&2===n.length;){if(!this.isAllowableUrl(n[1]))return!0;n=t.exec(e)}return!1},e.prototype.isAllowableUrl=function(e){for(var t=0,n=this.allowableHostSuffixes;t<n.length;t++){var r=n[t];if(e.endsWith(r))return!0}return!1},e}(),l=function(){function e(){}return e.addPerformanceMark=function(e){this.isPerformanceAPIUnavailable()||performance.mark(e)},e.removePerformanceMark=function(e){this.isPerformanceAPIUnavailable()||performance.clearMarks(e)},e.addPerformanceMeasure=function(e,t){this.isPerformanceAPIUnavailable()||performance.measure(e,t)},e.removePerformanceMeasure=function(e){this.isPerformanceAPIUnavailable()||performance.clearMeasures(e)},e.getPerformanceMeasure=function(e){if(!this.isPerformanceAPIUnavailable()){for(var t,n=0,r=performance.getEntriesByName(e,"measure");n<r.length;n++){var i=r[n];if(i.name===e){t=i;break}}return t||void 0}},e.isPerformanceAPIUnavailable=function(){return!(performance.getEntriesByType&&performance.getEntriesByName&&performance.mark&&performance.measure&&performance.clearMarks&&performance.clearMeasures)},e}(),d=function(){function e(e,t){this.loggingService=e,this.logger=t,this.tagNameToStartedPerformanceEvent=new Map,this.uniqueTagCounters={},this.eventType="Performance"}return e.prototype.registerEarlyStart=function(e,t,n){return this.tagNameToStartedPerformanceEvent.set(t.name,{eventName:e,performancePayload:n}),t.name},e.prototype.start=function(e,t){l.removePerformanceMark(e),l.addPerformanceMark(e),this.tagNameToStartedPerformanceEvent.set(e,{eventName:e,performancePayload:t})},e.prototype.startUnique=function(e,t){var n=this.getUniqueTagName(e,t);return l.addPerformanceMark(n),this.tagNameToStartedPerformanceEvent.set(n,{eventName:e,performancePayload:t}),n},e.prototype.end=function(e,t,n){var r=this.tagNameToStartedPerformanceEvent.get(e);if(void 0!==r){var o;l.addPerformanceMeasure(e,e);var s=l.getPerformanceMeasure(e);return s&&(void 0===t&&(t=r.performancePayload),o=Object(i.a)(Object(i.a)({},t),{startTimeMs:s.startTime,endTimeMs:s.startTime+s.duration,durationMs:s.duration}),this.logPerformance(r.eventName,o,n),l.removePerformanceMark(e),l.removePerformanceMeasure(e)),this.tagNameToStartedPerformanceEvent.delete(e),o}},e.prototype.registerCompletedPerformance=function(e,t,n){var r=Object(i.a)(Object(i.a)({},n),{startTimeMs:t.startTime,endTimeMs:t.startTime+t.duration,durationMs:t.duration});return this.logPerformance(e,r),r},e.prototype.getUniqueTagName=function(e,t){var n=t&&t.name?t.name:e,r=this.uniqueTagCounters[e]?this.uniqueTagCounters[e]:0;return this.uniqueTagCounters[e]=r+1,n+"-"+r},e.prototype.logPerformance=function(e,t,n){var r=t.name?e+":"+t.name:e;this.logger.trackEvent({name:e,data:Object(i.a)(Object(i.a)({eventType:this.eventType},this.loggingService.getContextsFields(r)),t),sync:n})},e}(),h=function(){function e(e,t){this.loggingService=e,this.logger=t,this.eventType="ApplicationLogic"}return e.prototype.logApplicationLogic=function(e,t,n){this.logger.trackEvent({name:e,data:Object(i.a)(Object(i.a)({eventType:this.eventType},this.loggingService.getContextsFields(e)),t),sync:n})},e}(),f=function(){function e(e,t){this.loggingService=e,this.logger=t,this.eventType="UserAction"}return e.prototype.logUserAction=function(e,t,n){this.logger.trackEvent({name:e,data:Object(i.a)(Object(i.a)({eventType:this.eventType},this.loggingService.getContextsFields(e)),t),sync:n})},e}(),g=n(20),p=function(){function e(e,t){this.loggingService=e,this.logger=t,this.eventType="Trace"}return e.prototype.logTrace=function(e,t,n){var r=t.traceId?t.traceId:Object(g.a)(),o=Object(i.a)(Object(i.a)({},t),{traceId:r,partNumber:0}),s=1,a=0,c=t.message;if(c)for(;a<=c.length;){var u=c.substr(a,32500);o.message=u,o.partNumber=s,this.logTracePart(e,o,n),a+=32500,s++}return r},e.prototype.logTracePart=function(e,t,n){this.logger.trackEvent({name:e,data:Object(i.a)(Object(i.a)({eventType:this.eventType},this.loggingService.getContextsFields(e)),t),sync:n})},e}(),v=n(99),m=function(){function e(){this.isDevelopmentMode=!1,this.includeTimingFields=!0,this.loggedAppExitEvent=!1,this.onTrack=function(){}}return e.prototype.setupLogger=function(e,t,n,r,i,o,s){this.logger=e,n&&n.standard&&this.setStandardContexts(n.standard),n&&n.onePlayer&&this.setOnePlayerContexts(n.onePlayer),this.errorAlertLogging=new u(this,e,i,o),this.setupUnhandledExceptionLogging(),this.performanceLogging=new d(this,e),this.applicationLogicLogging=new h(this,e),this.userActionLogging=new f(this,e),this.traceLogging=new p(this,e),this.loadStartTime=s,r&&(this.onTrack=r),this.legacyLogging=t,this.loggedAppExitEvent=!1},e.prototype.appLogicThin=function(e,t,n){this.applicationLogicLogging?(this.applicationLogicLogging.logApplicationLogic(e,t,n),this.onTrack(e)):this.assert("applicationLogicLogging not initialized")},e.prototype.userActionThin=function(e,t,n){this.userActionLogging?(this.userActionLogging.logUserAction(e,t,n),this.onTrack(e)):this.assert("userActionLogging not initialized")},e.prototype.warnThin=function(e,t,n){this.errorAlertLogging?(this.errorAlertLogging.logWarning(e,t,n),this.onTrack(e)):this.assert("errorAlertLogging not initialized")},e.prototype.fatalThin=function(e,t,n){this.errorAlertLogging?(this.errorAlertLogging.logFatal(e,t,n),this.onTrack(e)):this.assert("errorAlertLogging not initialized")},e.prototype.traceThin=function(e,t,n){if(!this.traceLogging)return this.assert("traceLogging not initialized"),"";var r=t||"DefaultTrace";return this.traceLogging.logTrace(r,e,n)},e.prototype.userSignedIn=function(e,t){var n=this.getStandardContextsDeepCopy();n&&(n.userContext=e,n.expContext=t||n.expContext,this.setStandardContexts(n)),this.logger&&this.logger.userSignedIn(e.userId)},e.prototype.userSignedOut=function(e){var t=this.getStandardContextsDeepCopy();t&&t.userContext&&(t.userContext.userId="",t.userContext.userType=e,this.setStandardContexts(t)),this.logger&&this.logger.userSignedOut()},Object.defineProperty(e.prototype,"PrivacyScrubber",{get:function(){return this.privacyScrubber},enumerable:!0,configurable:!0}),e.prototype.setIncludeTimingFields=function(e){this.includeTimingFields=e},e.prototype.getIsDevelopmentMode=function(){var e=null;try{e=window.localStorage.getItem("disableDevelopmentMode")}catch(e){}return this.isDevelopmentMode&&!e},e.prototype.setupPrivacyScrubber=function(e){this.privacyScrubber=e},e.prototype.getStandardContextsDeepCopy=function(){return this.standardContexts?JSON.parse(JSON.stringify(this.standardContexts)):void 0},e.prototype.setStandardContexts=function(e){this.standardContexts=e,e&&void 0!==e.isDevelopmentMode&&(this.isDevelopmentMode=e.isDevelopmentMode),this.updateStandardContextsFields()},e.prototype.getOnePlayerContextsDeepCopy=function(){return this.onePlayerContexts?JSON.parse(JSON.stringify(this.onePlayerContexts)):void 0},e.prototype.setOnePlayerContexts=function(e){this.onePlayerContexts=e,this.updateOnePlayerContextsFields()},e.prototype.getContextsFields=function(e){var t=Object(i.a)(Object(i.a)({},this.standardContextsFields||{}),this.onePlayerContextsFields||{});return this.includeTimingFields&&(t=Object(i.a)(Object(i.a)({},this.calculateTimingFields(this.loadStartTime,e)),t)),t},e.prototype.legacy=function(e){this.legacyLogging&&this.legacyLogging.logEvent(e),this.onTrack(e.name)},e.prototype.registerEarlyStartPerformance=function(e,t,n){return this.performanceLogging?this.performanceLogging.registerEarlyStart(e,t,n):(this.assert("performanceLogging not initialized"),"")},e.prototype.startPerformance=function(e,t){this.performanceLogging?this.performanceLogging.start(e,t):this.assert("performanceLogging not initialized")},e.prototype.startUniquePerformance=function(e,t){return this.performanceLogging?this.performanceLogging.startUnique(e,t):(this.assert("performanceLogging not initialized"),"")},e.prototype.endPerformance=function(e,t,n){if(this.performanceLogging)return this.onTrack(e),this.performanceLogging.end(e,t,n);this.assert("performanceLogging not initialized")},e.prototype.registerCompletedPerformance=function(e,t,n){if(this.performanceLogging)return this.performanceLogging.registerCompletedPerformance(e,t,n);this.assert("performanceLogging not initialized")},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.standardContexts&&this.standardContexts.streamContext&&this.standardContexts.streamContext.isDebugLoggingEnabled&&console.log.apply(console,Object(i.i)(["["+(new Date).toISOString()+"]"],e))},e.prototype.assert=function(e){this.isDevelopmentMode&&console.debug(e)},e.prototype.logAppExited=function(){this.loggedAppExitEvent||(this.appLogicThin("AppExited",{},!0),this.loggedAppExitEvent=!0)},e.prototype.updateStandardContextsFields=function(){if(this.standardContextsFields={},this.standardContexts){this.standardContexts.expContext&&!0!==this.standardContexts.expContext.isExpSessionOverridden&&delete this.standardContexts.expContext.isExpSessionOverridden;var e=JSON.parse(JSON.stringify(this.standardContexts));delete e.expContext;var t=this.standardContexts.expContext?this.standardContexts.expContext:{};this.standardContextsFields=Object(i.a)(Object(i.a)({standardContextVersion:"2.3"},Object(g.b)(e)),{expContext:t})}},e.prototype.updateOnePlayerContextsFields=function(){if(this.onePlayerContextsFields={},this.onePlayerContexts){var e=JSON.parse(JSON.stringify(this.onePlayerContexts));delete e.expContext;var t=this.onePlayerContexts.expContext?this.onePlayerContexts.expContext:{};this.onePlayerContextsFields=Object(i.a)(Object(i.a)({OnePlayerContextVersion:"0.1"},Object(g.b)(e)),{expContext:t})}},e.prototype.calculateTimingFields=function(e,t){var n=Object(v.a)(e,t);return void 0===n?{}:{browserTimingMethod:n.Method,msSinceAppStart:n.MsSinceNavigationStart}},e.prototype.setupUnhandledExceptionLogging=function(){var e=this;window.onerror=function(t,n,r,i,o){if(e.errorAlertLogging){var s="src: "+n+" line: "+r+" col: "+i;e.errorAlertLogging.logUnhandled(o||new Error(t.toString()),s)}}},e}(),y=function(){function e(){}return e.prototype.trackEvent=function(e){window.console.log(e)},e.prototype.userSignedIn=function(e){},e.prototype.userSignedOut=function(){},e}(),S=n(4);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var T=Object.getPrototypeOf,w=0;function E(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)}function C(e){return"function"===b(e)}function O(e){return e&&(e===Object.prototype||e===Array.prototype)}function I(e){return O(e)||e===Function.prototype}function x(e){if(e){if(T)return T(e);var t=e.__proto__||e.prototype||e.constructor;if(t)return t}return null}function A(e,t,n){return"constructor"!==t&&C(e[t])&&(n||E(e,t))}function k(e){throw new TypeError("DynamicProto: "+e)}function P(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function R(e,t,n,r){var i=null;if(e&&E(n,"_dynClass")){var o=e._dynInstFuncs||{};if((i=(o[n._dynClass]||{})[t])||k("Missing ["+t+"] function"),!i._dynInstChk&&!1!==o._dynInstChk){for(var s=!E(e,t),a=x(e),c=[];s&&a&&!I(a)&&!P(c,a);){var u=a[t];if(u){s=u===r;break}c.push(a),a=x(a)}try{s&&(e[t]=i),i._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return i}function _(e,t,n){var r=t[e];return r===n&&(r=x(t)[e]),C(r)||k("["+e+"] is not a function"),r}function N(e,t){return E(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function j(e,t,n,r){E(e,"prototype")||k("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){for(var n=x(t);n&&!I(n);){if(n===e)return!0;n=x(n)}return!1})(i,t)||k("["+N(e)+"] is not in class hierarchy of ["+N(t)+"]");var o=null;E(i,"_dynClass")?o=i._dynClass:(o="_dynCls$"+N(e,"_")+"$"+w,w++,i._dynClass=o);var s=j._dfOpts,a=!!s.useBaseInst;a&&r&&void 0!==r.useBaseInst&&(a=!!r.useBaseInst);var c=function(e){var t={};for(var n in e)!t[n]&&A(e,n,!1)&&(t[n]=e[n]);return t}(t);n(t,function(e,t,n,r){function i(e,t,n){var i=t[s];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var o={};for(var s in n)o[s]=i(t,n,s);for(var a=x(e),c=[];a&&!I(a)&&!P(c,a);){for(var s in a)!o[s]&&A(a,s,!T)&&(o[s]=i(t,a,s));c.push(a),a=x(a)}return o}(i,t,c,a));var u=!!T&&!!s.setInstFuncs;u&&r&&(u=!!r.setInstFuncs),function(e,t,n,r,i){function o(e,t){var n=function n(){var r=R(this,t,e,n)||_(t,e,n);return r.apply(this,arguments)};return n._isDynProxy=1,n}if(!O(e)){var s=n._dynInstFuncs=n._dynInstFuncs||{},a=s[t]=s[t]||{};for(var c in!1!==s._dynInstChk&&(s._dynInstChk=!!i),n)A(n,c,!1)&&n[c]!==r[c]&&(a[c]=n[c],delete n[c],(!E(e,c)||e[c]&&!e[c]._isDynProxy)&&(e[c]=o(e,c)))}}(i,o,t,c,!1!==u)}j._dfOpts={setInstFuncs:!0,useBaseInst:!0};var L,M=j;!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(L||(L={}));var U={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103},V=0,F=13,D=32,q=1,G=2,B=3,H=0,z=1,K=6,W=7,Q=__assign(__assign({},U),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519});function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var J=S.f,Y=S.d,X=(S.e,S.c,S.a);function Z(e){var t=X();return t&&t[e]?t[e]:"window"===e&&ee()?window:null}function ee(){return Boolean(("undefined"==typeof window?"undefined":$(window))===Y&&window)}function te(){return ee()?window:Z("window")}function ne(){return Boolean(("undefined"==typeof document?"undefined":$(document))===Y&&document)?document:Z("document")}function re(){return Boolean(("undefined"==typeof navigator?"undefined":$(navigator))===Y&&navigator)}function ie(){return re()?navigator:Z("navigator")}function oe(){return("undefined"==typeof location?"undefined":$(location))===Y&&location?location:Z("location")}function se(){return Boolean(("undefined"==typeof JSON?"undefined":$(JSON))===Y&&JSON||null!==Z("JSON"))}function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}S.f;var ce=null,ue=!1,le=123456789,de=987654321;function he(e){e<0&&(e>>>=0),le=123456789+e&4294967295,de=987654321-e&4294967295,ue=!0}function fe(){he(4294967296*Math.random()^(new Date).getTime())}function ge(e,t){return ae(e)===t}function pe(e){return ge(e,S.f)||void 0===e}function ve(e){return pe(e)||null===e}function me(e,t){return e&&Object[S.e].hasOwnProperty.call(e,t)}function ye(e){return ge(e,S.d)}function Se(e){return ge(e,S.c)}function be(e,t,n,r){void 0===r&&(r=!1);var i=!1;if(!ve(e))try{ve(e.addEventListener)?ve(e.attachEvent)||(e.attachEvent("on"+t,n),i=!0):(e.addEventListener(t,n,r),i=!0)}catch(e){}return i}function Te(e,t,n,r){if(void 0===r&&(r=!1),!ve(e))try{ve(e.removeEventListener)?ve(e.detachEvent)||e.detachEvent("on"+t,n):e.removeEventListener(t,n,r)}catch(e){}}function we(e,t,n,r){var i=Object.defineProperty;if(i)try{var o={enumerable:!0,configurable:!0};return n&&(o.get=n),r&&(o.set=r),i(e,t,o),!0}catch(e){}return!1}function Ee(e,t){if(e&&ye(e))for(var n in e)me(e,n)&&t.call(e,n,e[n])}var Ce,Oe=function(){function e(){}return e.isDate=function(e){return"[object Date]"===Object[S.e].toString.call(e)},e.isArray=function(e){return"[object Array]"===Object[S.e].toString.call(e)},e.isError=function(e){return"[object Error]"===Object[S.e].toString.call(e)},e.isString=function(e){return ge(e,"string")},e.isNumber=function(e){return ge(e,"number")},e.isBoolean=function(e){return ge(e,"boolean")},e.disableCookies=function(){e._canUseCookies=!1},e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Ie,(function(t){var n=0|e.randomValue(15);return("x"===t?n:3&n|8).toString(16)}))},e.toISOString=function(t){if(e.isDate(t)){var n=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},e.arrForEach=function(e,t,n){for(var r=e.length,i=0;i<r;i++)i in e&&t.call(n||e,e[i],i,e)},e.arrIndexOf=function(e,t,n){for(var r=e.length,i=n||0,o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===t)return o;return-1},e.arrMap=function(e,t,n){for(var r=e.length,i=n||e,o=new Array(r),s=0;s<r;s++)s in e&&(o[s]=t.call(i,e[s],e));return o},e.arrReduce=function(e,t,n){var r,i=e.length,o=0;if(arguments.length>=3)r=arguments[2];else{for(;o<i&&!(o in e);)o++;r=e[o++]}for(;o<i;)o in e&&(r=t(r,e[o],o,e)),o++;return r},e.strTrim=function(t){return e.isString(t)?t.replace(/^\s+|\s+$/g,""):t},e.objKeys=function(e){var t=!{toString:null}.propertyIsEnumerable("toString");if(!(Se(e)||ye(e)&&null!==e))throw new TypeError("objKeys called on non-object");var n=[];for(var r in e)me(e,r)&&n.push(r);if(t)for(var i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=i.length,s=0;s<o;s++)me(e,i[s])&&n.push(i[s]);return n},e.addEventHandler=function(e,t){var n=!1,r=te();r&&(n=be(r,e,t),n=be(r.body,e,t)||n);var i=ne();return i&&(n=xe.Attach(i,e,t)||n),n},e.dateNow=function(){var e=Date;return e.now?e.now():(new e).getTime()},e.perfNow=function(){var t=Z("performance");return t&&t.now?t.now():e.dateNow()},e.newId=function(t){void 0===t&&(t=22);for(var n=e.random32()>>>0,r=0,i="";i.length<t;)r++,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&n),n>>>=6,5===r&&(n=(e.random32()<<2&4294967295|3&n)>>>0,r=0);return i},e.isIE=function(){if(null===ce){var e=((ie()||{}).userAgent||"").toLowerCase();ce=-1!==e.indexOf("msie")||-1!==e.indexOf("trident/")}return ce},e.randomValue=function(t){return t>0?Math.floor(e.random32()/4294967295*(t+1))>>>0:0},e.random32=function(t){var n,r=Z("crypto")||Z("msCrypto");return r&&r.getRandomValues?n=4294967295&r.getRandomValues(new Uint32Array(1))[0]:e.isIE()?(ue||fe(),n=4294967295&e.mwcRandom32()):n=Math.floor(4294967296*Math.random()|0),t||(n>>>=0),n},e.mwcRandomSeed=function(e){e?he(e):fe()},e.mwcRandom32=function(e){var t=((de=36969*(65535&de)+(de>>16)&4294967295)<<16)+(65535&(le=18e3*(65535&le)+(le>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t},e.generateW3CId=function(){for(var t,n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",i=0;i<4;i++)r+=n[15&(t=e.random32())]+n[t>>4&15]+n[t>>8&15]+n[t>>12&15]+n[t>>16&15]+n[t>>20&15]+n[t>>24&15]+n[t>>28&15];var o=n[8+(3&e.random32())|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+o+r.substr(16,3)+r.substr(19,12)},e.isTypeof=ge,e.isUndefined=pe,e.isNullOrUndefined=ve,e.hasOwnProperty=me,e.isFunction=Se,e.isObject=ye,e.objCreate=S.b,e.objDefineAccessors=we,e}(),Ie=/[xy]/g,xe=function(){function e(){}return e.Attach=be,e.AttachEvent=be,e.Detach=Te,e.DetachEvent=Te,e}();function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ke="3.0.2",Pe="1DS-Web-JS-"+ke,Re="undefined",_e="object",Ne=((Ce={})[0]=H,Ce[2]=K,Ce[1]=z,Ce[3]=W,Ce[4098]=K,Ce[4097]=z,Ce[4099]=W,Ce),je=null,Le=Oe.isUndefined,Me=Oe.isNullOrUndefined;function Ue(e){return!Le(e)}var Ve,Fe=Oe.hasOwnProperty,De=null,qe=null,Ge=Oe.arrForEach,Be=Oe.arrIndexOf,He=Oe.arrMap,ze=Oe.arrReduce,Ke=Oe.objKeys,We=Oe.toISOString,Qe=function(){var e=ie();return!(!e||!e.product)&&"ReactNative"===e.product},$e=Oe.isString,Je=Oe.isNumber,Ye=Oe.isBoolean,Xe=Oe.isFunction,Ze=Oe.isArray,et=Oe.isObject,tt=Oe.strTrim,nt=Boolean(ne()),rt=Boolean(te());function it(e){return!(Me(e)||""===e)}function ot(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function st(){return null===De&&(De=re()&&Boolean(ie().sendBeacon)),De}function at(){return null===qe&&(qe=Ue(Uint8Array)&&!function(){var e=ie();if(Ue(e)&&e.userAgent){var t=e.userAgent.toLowerCase();if((t.indexOf("safari")>=0||t.indexOf("firefox")>=0)&&t.indexOf("chrome")<0)return!0}return!1}()&&!Qe()),qe}function ct(e){return!!(e&&Je(e)&&e>=1&&e<=3)}function ut(e,t,n){if(!$e(e)||Me(t)||""===t)return null;if($e(t)||Je(t)||Ye(t)||Ze(t))t={value:t};else if("object"!==Ae(t)||t.hasOwnProperty("value")){if(Me(t.value)||""===t.value||!$e(t.value)&&!Je(t.value)&&!Ye(t.value)&&!Ze(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Ze(t.value)&&!Et(t.value))return null;if(!Me(t.kind)){if(Ze(t.value)||!wt(t.kind))return null;t.value=t.value.toString()}return t}function lt(e){return e.getUTCFullYear()+"-"+Tt(e.getUTCMonth()+1)+"-"+Tt(e.getUTCDate())+"T"+Tt(e.getUTCHours())+":"+Tt(e.getUTCMinutes())+":"+Tt(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"}function dt(){if(void 0!==("undefined"==typeof XMLHttpRequest?"undefined":Ae(XMLHttpRequest))){var e=Z("XMLHttpRequest");if(e){var t=new e;return Boolean(Le(t.withCredentials)&&void 0!==("undefined"==typeof XDomainRequest?"undefined":Ae(XDomainRequest)))}}}function ht(e,t,n){var r=-1;if(!Le(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){if(Je(e)&&e>=0&&e<=9)return!0;return!1}(n))-1===r&&(r=0),r|=n;else{var i=Ne[At(e)]||-1;-1!==r&&-1!==i?r|=i:i===K&&(r=i)}return r}function ft(){if(void 0===Ve){Ve=!1;try{var e=ne(),t=ie();e&&!Le(e.cookie)&&t&&t.cookieEnabled&&(Ve=!0)}catch(e){}}return Ve}function gt(e){return!!$e(e)&&(-1!==e.indexOf("CPU iPhone OS 12")||-1!==e.indexOf("iPad; CPU OS 12")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==e.indexOf("Version/")&&-1!==e.indexOf("Safari")||(!(-1===e.indexOf("Macintosh; Intel Mac OS X 10_14")||!kt(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(-1!==e.indexOf("Chrome/5")||-1!==e.indexOf("Chrome/6")||(-1!==e.indexOf("UnrealEngine")&&-1===e.indexOf("Chrome")||(-1!==e.indexOf("UCBrowser/12")||-1!==e.indexOf("UCBrowser/11")))))))}function pt(e,t,n){if(ft()){var r="",i=oe();i&&"https:"===i.protocol&&(r=";secure",null===je&&(je=gt((ie()||{}).userAgent)),je||(t+=";SameSite=None"));var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var s="; expires="+o.toUTCString();ne().cookie=e+"="+t+s+"; path=/"+r}}function vt(e){pt(e,"",-1)}function mt(e){if(ft()){e+="=";for(var t=decodeURIComponent((ne()||{}).cookie||"").split(";"),n=0;n<t.length;n++){for(var r=t[n],i=0;" "===r.charAt(i);)i++;if(0===(r=r.substring(i)).indexOf(e))return r.substring(e.length,r.length)}}return""}function yt(e){void 0===e&&(e="D");var t=Oe.newGuid();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function St(e,t,n,r,i){var o={},s=!1,a=0,c=arguments.length,u=Object.prototype,l=arguments;for("[object Boolean]"===u.toString.call(l[0])&&(s=l[0],a++);a<c;a++){Ee(e=l[a],(function(e,t){s&&t&&et(t)?o[e]=St(!0,o[e],t):o[e]=t}))}return o}var bt=Oe.perfNow;function Tt(e){return e<10?"0"+e:e.toString()}function wt(e){return!(!Je(e)||!(e>=V&&e<=F||e===D))}function Et(e){return e.length>0}var Ct=Oe.objDefineAccessors;function Ot(e){var t=xt("beforeunload",e);return t=xt("unload",e)||t,t=xt("pagehide",e)||t}function It(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=bt()}var xt=Oe.addEventHandler;function At(e){var t=0;if(null!=e){var n=Ae(e);"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===S.d&&(t=4,Ze(e)?(t=4096,e.length>0&&(t|=At(e[0]))):Fe(e,"value")&&(t=8192|At(e.value)))}return t}function kt(e,t){return void 0!==e&&void 0!==t&&-1!==e.indexOf(t,e.length-t.length)}function Pt(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var Rt=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var i="";se()&&(i=(se()?JSON||Z("JSON"):null).stringify(r));var o=(t?" message:"+Pt(t):"")+(r?" props:"+Pt(i):"");this.message+=o}return e.dataType="MessageData",e}(),_t=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};M(e,this,(function(e){var i=Oe.isNullOrUndefined,o=Oe.isUndefined,s=Oe.isFunction;function a(e,n){var r=t[e];return i(r)?n:r}i(t)&&(t={}),e.consoleLoggingLevel=function(){return a("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return a("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return a("maxMessageLimit",25)},e.enableDebugExceptions=function(){return a("enableDebugExceptions",!1)},e.throwInternal=function(t,n,i,s,a){void 0===a&&(a=!1);var c=new Rt(n,i,a,s);if(e.enableDebugExceptions())throw c;if(!o(c)&&c&&!o(c.message)){if(a){var u=+c.messageId;!r[u]&&e.consoleLoggingLevel()>=L.WARNING&&(e.warnToConsole(c.message),r[u]=!0)}else e.consoleLoggingLevel()>=L.WARNING&&e.warnToConsole(c.message);e.logInternalMessage(t,c)}},e.warnToConsole=function(e){var t=("undefined"==typeof console?"undefined":$(console))!==J?console:Z("console");if(t){var n="log";t.warn&&(n="warn"),s(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,i){if(!(n>=e.maxInternalMessageLimit())){var o=!0,s="AITR_"+i.messageId;if(r[s]?o=!1:r[s]=!0,o&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(i),n++),n===e.maxInternalMessageLimit())){var a="Internal events throttle limit per PageView reached for this app.",c=new Rt(U.MessageLimitPerPVExceeded,a,!1);e.queue.push(c),e.warnToConsole(a)}}}}))}return e.prototype.enableDebugExceptions=function(){return!1},e.prototype.consoleLoggingLevel=function(){return 0},e.prototype.telemetryLoggingLevel=function(){return 1},e.prototype.maxInternalMessageLimit=function(){return 25},e.prototype.throwInternal=function(e,t,n,r,i){void 0===i&&(i=!1)},e.prototype.warnToConsole=function(e){},e.prototype.resetInternalMessageCount=function(){},e.prototype.logInternalMessage=function(e,t){},e}(),Nt=function(){function e(t,n,r){var i,o=this,s=!1;(o.start=Oe.dateNow(),o.name=t,o.isAsync=r,o.isChildEvt=function(){return!1},Oe.isFunction(n))&&(s=Oe.objDefineAccessors(o,"payload",(function(){return!i&&Oe.isFunction(n)&&(i=n(),n=null),i})));o.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?o[t]:(o.ctx||{})[t]:null},o.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)o[t]||(o.isChildEvt=function(){return!0}),o[t]=n;else if(t===e.ChildrenContextKey)o[t]=n;else{(o.ctx=o.ctx||{})[t]=n}},o.complete=function(){var t=0,r=o.getCtx(e.ChildrenContextKey);if(Oe.isArray(r))for(var i=0;i<r.length;i++){var a=r[i];a&&(t+=a.time)}o.time=Oe.dateNow()-o.start,o.exTime=o.time-t,o.complete=function(){},!s&&Oe.isFunction(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),jt=function(){function e(t){this.ctx={},M(e,this,(function(e){e.create=function(e,t,n){return new Nt(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))}return e.prototype.create=function(e,t,n){return null},e.prototype.fire=function(e){},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e}();function Lt(e,t,n,r,i){if(e){var o=e;if(o&&Oe.isFunction(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var s=void 0,a=o.getCtx("CoreUtils.doPerf");try{if(s=o.create(t(),r,i)){if(a&&s.setCtx&&(s.setCtx(Nt.ParentContextKey,a),a.getCtx&&a.setCtx)){var c=a.getCtx(Nt.ChildrenContextKey);c||(c=[],a.setCtx(Nt.ChildrenContextKey,c)),c.push(s)}return o.setCtx("CoreUtils.doPerf",s),n(s)}}catch(e){s&&s.setCtx&&s.setCtx("exception",e)}finally{s&&o.fire(s),o.setCtx("CoreUtils.doPerf",a)}}}return n()}var Mt=Oe.isFunction,Ut=function(e,t){var n=this,r=null,i=Mt(e.processTelemetry),o=Mt(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return r},n.setNext=function(e){r=e},n.processTelemetry=function(s,a){a||(a=t);var c=e?e.identifier:"TelemetryPluginChain";Lt(a?a.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&i){n._hasRun=!0;try{a.setNext(r),o&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(s,a)}catch(n){var t=r&&r._hasRun;r&&t||a.diagLog().throwInternal(L.CRITICAL,U.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),r&&!t&&r.processTelemetry(s,a)}}else r&&(n._hasRun=!0,r.processTelemetry(s,a))}),(function(){return{item:s}}),!s.sync)}},Vt=Oe.isNullOrUndefined;function Ft(e,t){var n=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var o=e[i];if(o&&Oe.isFunction(o.processTelemetry)){var s=new Ut(o,t);n.push(s),r&&r.setNext(s),r=s}}return n.length>0?n[0]:null}var Dt=function e(t,n,r,i){var o=this,s=null;null!==i&&(t&&Oe.isFunction(t.getPlugin)?s=function(e,t,n){var r=[],i=!n;if(e)for(;e;){var o=e.getPlugin();(i||o===n)&&(i=!0,r.push(o)),e=e.getNext()}return i||r.push(n),Ft(r,t)}(t,o,i||t.getPlugin()):i?s=function(e,t,n){var r=e,i=!1;return n&&e&&(r=[],Oe.arrForEach(e,(function(e){(i||e===n)&&(i=!0,r.push(e))}))),n&&!i&&(r||(r=[]),r.push(n)),Ft(r,t)}(t,o,i):Oe.isUndefined(i)&&(s=Ft(t,o))),o.core=function(){return r},o.diagLog=function(){var e=(r||{}).logger;return e||(e=new _t(n||{})),e},o.getCfg=function(){return n},o.getExtCfg=function(e,t){var r;if(void 0===t&&(t={}),n){var i=n.extensionConfig;i&&e&&(r=i[e])}return r||t},o.getConfig=function(e,t,r){var i;void 0===r&&(r=!1);var s=o.getExtCfg(e,null);return s&&!Vt(s[t])?i=s[t]:n&&!Vt(n[t])&&(i=n[t]),Vt(i)?r:i},o.hasNext=function(){return null!=s},o.getNext=function(){return s},o.setNext=function(e){s=e},o.processNext=function(e){var t=s;t&&(s=t.getNext(),t.processTelemetry(e,o))},o.createNew=function(t,i){return void 0===t&&(t=null),new e(t||s,n,r,i)}},qt=Oe.isFunction,Gt=function(){function e(){var e=this,t=!1,n=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&qt(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var i=t;if(!i){var o=n||new Dt(null,{},e.core);i=r&&r.getPlugin?o.createNew(null,r.getPlugin):o.createNew(null,r)}return i},e._baseTelInit=function(i,o,s,a){i&&(i.extensionConfig=i.extensionConfig||[]),!a&&o&&(a=o.getProcessTelContext().getNext());var c=r;r&&r.getPlugin&&(c=r.getPlugin()),e.core=o,n=new Dt(a,i,o,c),t=!0}}return e.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},e}(),Bt=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function Ht(e,t){void 0===t&&(t=Bt);var n=null;if(e)for(var r=e.split(","),i=0;i<r.length;i++)zt(r[i],t)&&(n?n+=","+r[i]:n=r[i]);return n}function zt(e,t){if(void 0===t&&(t=Bt),!e||e.length<4)return!1;for(var n=!1,r=e.substring(0,3).toString().toUpperCase(),i=0;i<t.length;i++)if(t[i]+":"===r&&e.length<=256){n=!0;break}return n}var Kt,Wt,Qt=function(){function e(e){this.appExpId=null,this.flightIdNameSpaces=Bt.slice(0),this.expIdCookieName="Treatments",this._propertiesConfig=e;var t=ne();if(t){var n=t.documentElement;t&&(this.locale=n.lang)}this.env=e.env?e.env:this._getMetaDataFromDOM("awa-").env}return e.prototype.getExpId=function(){return this._propertiesConfig.expId?this._readExpIdFromCoreData(this._propertiesConfig.expId):this._readExpIdFromCookie()},e.prototype._getMetaDataFromDOM=function(e){var t,n={},r=ne();if(r){t=r&&r.querySelectorAll("meta");for(var i=0;i<t.length;i++){var o=t[i];if(o.name)if(0===o.name.toLowerCase().indexOf(e))n[o.name.replace(e,"")]=o.content}}return n},e.prototype._setAppExpId=function(e){e!==this.appExpId&&(this.appExpId=Ht(e,this.flightIdNameSpaces))},e.prototype._getAppExpId=function(){return this.appExpId},e.prototype._readExpIdFromCookie=function(){return this._setAppExpId(mt(this.expIdCookieName)),this._getAppExpId()},e.prototype._readExpIdFromCoreData=function(e){return this._setAppExpId(e),this._getAppExpId()},e.validateAppExpId=Ht,e._staticInit=void Ct(e.prototype,"expId",e.prototype.getExpId),e}(),$t=function(){},Jt=null;function Yt(e,t,n,r){var i="",o="",s=ne();if(s){r&&(i=";domain="+r);var a=oe();a&&"https:"===a.protocol&&(o=";secure",null===Jt&&(Jt=gt((ie()||{}).userAgent)),Jt||(n+=";SameSite=None")),ft()&&(s.cookie=t+"="+n+i+";path=/"+o)}}function Xt(){return void 0===Kt&&(Kt=!!en(Wt.LocalStorage)),Kt}function Zt(){return Xt()?en(Wt.LocalStorage):null}function en(e){var t,n,r=null;try{var i=X();if(!i)return null;n=new Date,(r=e===Wt.LocalStorage?i.localStorage:i.sessionStorage)&&Xe(r.setItem)&&(r.setItem(n,n),t=r.getItem(n)!==n,r.removeItem(n),t&&(r=null))}catch(e){r=null}return r}!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(Wt||(Wt={}));Oe.isDate;var tn=Oe.toISOString,nn=function(){function e(t,n,r){if(this._logger=r,!t.disableCookiesUsage&&ft()){var i=mt("MUID");if(i&&this.setLocalId("t:"+i),n.enableApplicationInsightsUser){var o=mt(e.userCookieName);if(o){var s=o.split(e.cookieSeparator);s.length>0&&(this.id=s[0])}if(!this.id){this.id=Oe.newId(t&&!Oe.isUndefined(t.idLength)?t.idLength:22);var a=new Date,c=tn(a);this.accountAcquisitionDate=c,a.setTime(a.getTime()+31536e6);var u=[this.id,c],l=n.cookieDomain?n.cookieDomain:void 0;Yt(this._logger,e.userCookieName,u.join(e.cookieSeparator)+";expires="+a.toUTCString(),l)}}}if("undefined"!=typeof navigator){var d=navigator;this.locale=d.userLanguage||d.language}}return e.prototype.getLocalId=function(){if(this._customLocalId)return this._customLocalId;var e=mt("MUID");e&&this.setLocalId("t:"+e)},e.prototype.setLocalId=function(e){this._customLocalId=e},e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void Ct(e.prototype,"localId",e.prototype.getLocalId,e.prototype.setLocalId),e}(),rn="MSIE",on="Chrome",sn="Firefox",an="Safari",cn="Edge",un="Electron",ln="SkypeShell",dn="PhantomJS",hn="Opera",fn=function(){function e(e){this._propertiesConfig=e;var t=oe();if(t){var n=t.hostname;n&&(this.domain="file:"===t.protocol?"local":n)}var r="undefined"!=typeof navigator?navigator.userAgent:"";if(e.userAgent&&(r=e.userAgent),e.populateBrowserInfo){if(r){var i=this._getBrowserName(r);this.browser=i,this.browserVer=this._getBrowserVersion(r,i)}var o=this._getScreenResolution();this.screenRes=o.w+"X"+o.h}}return e.prototype.getUserConsent=function(){return this._propertiesConfig.userConsented||!!mt(this._propertiesConfig.userConsentCookieName||"MSCC")},e.prototype.getUserConsentDetails=function(){try{if(this._propertiesConfig.callback&&this._propertiesConfig.callback.userConsentDetails){var e=this._propertiesConfig.callback.userConsentDetails();if(e)return JSON.stringify({Required:!!e.Required&&e.Required,Analytics:!!e.Analytics&&e.Analytics,SocialMedia:!!e.SocialMedia&&e.SocialMedia,Advertising:!!e.Advertising&&e.Advertising})}}catch(e){}return null},e.prototype._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?hn:this._userAgentContainsString(dn,e)?dn:this._userAgentContainsString(cn,e)?cn:this._userAgentContainsString(un,e)?un:this._userAgentContainsString(on,e)?on:this._userAgentContainsString("Trident",e)?rn:this._userAgentContainsString(sn,e)?sn:this._userAgentContainsString(an,e)?an:this._userAgentContainsString(ln,e)?ln:"Unknown"},e.prototype._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e.prototype._getBrowserVersion=function(e,t){return t===rn?this._getIeVersion(e):this._getOtherVersion(t,e)},e.prototype._getIeVersion=function(e){var t=e.match(new RegExp(rn+" ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e.prototype._getOtherVersion=function(e,t){e===an&&(e="Version");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n?n[1]:"Unknown"},e.prototype._getScreenResolution=function(){var e={h:0,w:0},t=te();return t&&t.screen&&(e.h=screen.height,e.w=screen.width),e},e._staticInit=void Ct(e.prototype,"userConsent",e.prototype.getUserConsent),e}(),gn="Windows",pn="Mac OS X",vn="Android",mn=/(windows|win32)/i,yn=/ arm;/i,Sn=/windows\sphone\s\d+\.\d+/i,bn=/(macintosh|mac os x)/i,Tn=/(ipad|iphone|ipod)(?=.*like mac os x)/i,wn=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,En=/android/i,Cn=/CrOS/i,On={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},In=function(){function e(e){var t="undefined"!=typeof navigator?navigator.userAgent:"";if(e.userAgent&&(t=e.userAgent),t&&e.populateOperatingSystemInfo){var n=this._getOsName(t.toLowerCase());this.name=n,this.ver=this._getOsVersion(t,n)}}return e.prototype._getOsName=function(e){return e.match(Sn)?"Windows Phone":e.match(yn)?"Windows RT":e.match(mn)?gn:e.match(Tn)?"iOS":e.match(En)?vn:e.match(wn)?"Linux":-1!==e.indexOf("x11")?"Unix":-1!==e.indexOf("blackberry")?"BlackBerry":-1!==e.indexOf("symbian")?"Symbian":-1!==e.indexOf("nokia")?"Nokia":e.match(bn)?pn:e.match(Cn)?"Chrome OS":"Unknown"},e.prototype._getOsVersion=function(e,t){return t===gn?this._getGenericOsVersion(e,"Windows NT"):t===vn?this._getGenericOsVersion(e,t):t===pn?this._getMacOsxVersion(e):"Unknown"},e.prototype._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?On[n[1]]?On[n[1]]:n[1]:"Unknown"},e.prototype._getMacOsxVersion=function(e){var t=e.match(new RegExp(pn+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var r=this._getDelimiter(n);return r?n.split(r)[0]:n}}return"Unknown"},e.prototype._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e}(),xn=function(){function e(e){e.serviceName&&(this.serviceName=e.serviceName)}return e.prototype.getMsfpc=function(){return mt("MSFPC")},e.prototype.getAnid=function(){return mt("ANON").slice(0,34)},e._staticInit=(Ct(e.prototype,"msfpc",e.prototype.getMsfpc),void Ct(e.prototype,"anid",e.prototype.getAnid)),e}(),An=function(e){this.popSample=100,this.eventFlags=0,e.hashIdentifiers&&(this.eventFlags=1048576|this.eventFlags),e.dropIdentifiers&&(this.eventFlags=2097152|this.eventFlags)},kn=function(){var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,r="+";n>0&&(r="-"),n=Math.abs(n),t=Math.abs(t),this.tz=r+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString())},Pn=function(){},Rn=function(){function e(){}return e.prototype.setId=function(e){this.customId=e},e.prototype.getId=function(){return $e(this.customId)?this.customId:this.automaticId},e._staticInit=void Ct(e.prototype,"id",e.prototype.getId,e.prototype.setId),e}(),_n=function(e,t,n,r){if(e.enableApplicationInsightsTrace){this.traceId=t||Oe.generateW3CId(),this.parentId=n,this.name=r;var i=oe();i&&i.pathname&&(this.name=i.pathname)}},Nn=function(){function e(){}return e.id="id",e.ver="ver",e.appName="name",e.locale="locale",e.expId="expId",e.env="env",e}(),jn=function(){function e(){}return e.domain="domain",e.browser="browser",e.browserVer="browserVer",e.screenRes="screenRes",e.userConsent="userConsent",e.consentDetails="consentDetails",e}(),Ln=function(){function e(){}return e.locale="locale",e.localId="localId",e.id="id",e}(),Mn=function(){function e(){}return e.osName="name",e.ver="ver",e}(),Un=function(){function e(){}return e.ver="ver",e.seq="seq",e.installId="installId",e.epoch="epoch",e}(),Vn=function(){function e(){}return e.msfpc="msfpc",e.anid="anid",e.serviceName="serviceName",e}(),Fn=function(){function e(){}return e.popSample="popSample",e.eventFlags="eventFlags",e}(),Dn=function(){function e(){}return e.tz="tz",e}(),qn=function(){function e(){}return e.sessionId="sesId",e}(),Gn=function(){function e(){}return e.localId="localId",e.deviceClass="deviceClass",e.make="make",e.model="model",e}(),Bn=function(){function e(){}return e.role="role",e.roleInstance="roleInstance",e.roleVer="roleVer",e}(),Hn=function(){function e(){}return e.traceId="traceID",e.traceName="name",e.parentId="parentID",e}(),zn=function(){function e(){}return e.UserExt="user",e.DeviceExt="device",e.TraceExt="trace",e.WebExt="web",e.AppExt="app",e.OSExt="os",e.SdkExt="sdk",e.IntWebExt="intweb",e.UtcExt="utc",e.LocExt="loc",e.CloudExt="cloud",e}(),Kn="MicrosoftApplicationsTelemetryDeviceId",Wn=function(){function e(e){if(this._sequenceId=0,this._propertyStorage=e.propertyStorageOverride,this.seq=this._sequenceId,this.epoch=(new Date).getTime().toString(),!e.disableCookiesUsage&&ft()||this._propertyStorage){var t=this._getData(Kn);t||(t=Oe.newGuid()),this._saveData(Kn,t),this.installId=t}else vt(Kn)}return e.prototype.getSequenceId=function(){return++this._sequenceId},e.prototype._saveData=function(e,t){var n=this._propertyStorage;n?n.setProperty(e,t):pt(e,t,365)},e.prototype._getData=function(e){return this._propertyStorage?this._propertyStorage.getProperty(e)||"":mt(e)},e}(),Qn=function(){function e(t,n){var r,i,o;M(e,this,(function(s){var a,c={sessionRenewalMs:(a=t).sessionRenewalMs&&function(){return a.sessionRenewalMs},sessionExpirationMs:a.sessionExpirationMs&&function(){return a.sessionExpirationMs},cookieDomain:a.cookieDomain&&function(){return a.cookieDomain},namePrefix:a.namePrefix&&function(){return a.namePrefix},sessionAsGuid:function(){return a.sessionAsGuid},idLength:function(){return a.idLength?a.idLength:22}};function u(e){var t=s.automaticSession,n=e.split("|");n.length>0&&t.setId(n[0]);try{if(n.length>1){var r=+n[1];t.acquisitionDate=+new Date(r),t.acquisitionDate=t.acquisitionDate>0?t.acquisitionDate:0}if(n.length>2){var o=+n[2];t.renewalDate=+new Date(o),t.renewalDate=t.renewalDate>0?t.renewalDate:0}}catch(e){i.throwInternal(L.CRITICAL,Q.ErrorParsingAISessionCookie,"Error parsing ai_session cookie, session will be reset: "+e)}0===t.renewalDate&&i.throwInternal(L.WARNING,Q.SessionRenewalDateIsZero,"AI session renewal date is 0, session will be reset.")}function l(){var e=s.automaticSession,t=(new Date).getTime(),n=s.config.sessionAsGuid();!Oe.isUndefined(n)&&n?Oe.isBoolean(n)?e.setId(yt()):e.setId(yt(n)):e.setId(Oe.newId(c&&c.idLength?c.idLength():22)),e.acquisitionDate=t,e.renewalDate=t,d(e.getId(),e.acquisitionDate,e.renewalDate),Xt()||i.throwInternal(L.WARNING,Q.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")}function d(e,t,n){var i=t+s.config.sessionExpirationMs(),a=n+s.config.sessionRenewalMs(),c=new Date,u=[e,t,n];i<a?c.setTime(i):c.setTime(a);var l=s.config.cookieDomain?s.config.cookieDomain():null;Yt(0,o(),u.join("|")+";expires="+c.toUTCString(),l),r=(new Date).getTime()}i=Oe.isNullOrUndefined(n)?new _t:n,Oe.isFunction(t.sessionExpirationMs)||(c.sessionExpirationMs=function(){return e.acquisitionSpan}),Oe.isFunction(t.sessionRenewalMs)||(c.sessionRenewalMs=function(){return e.renewalSpan}),s.config=c,o=function(){return s.config.namePrefix&&s.config.namePrefix()?e.cookieNameConst+s.config.namePrefix():e.cookieNameConst},s.automaticSession=new Rn,s.update=function(){s.automaticSession.getId()||function(){var e=mt(o());if(e&&Oe.isFunction(e.split))u(e);else{var t=function(e,t){var n=Zt();if(null!==n)try{return n.getItem(t)}catch(t){Kt=!1,e.throwInternal(L.CRITICAL,Q.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+t)}return null}(i,o());t&&u(t)}s.automaticSession.getId()||l()}();var t=s.automaticSession,n=s.config,a=(new Date).getTime(),c=a-t.acquisitionDate>n.sessionExpirationMs(),h=a-t.renewalDate>n.sessionRenewalMs();if(c||h)l();else{(!r||a-r>e.cookieUpdateInterval)&&(t.renewalDate=a,d(t.getId(),t.acquisitionDate,t.renewalDate))}},s.backup=function(){var e,t,n,r=s.automaticSession;e=r.getId(),t=r.acquisitionDate,n=r.renewalDate,function(e,t,n){var r=Zt();if(null!==r)try{r.setItem(t,n)}catch(t){Kt=!1,e.throwInternal(L.CRITICAL,Q.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+t)}}(i,o(),[e,t,n].join("|"))}}))}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e.cookieNameConst="ai_session",e}(),$n=$e,Jn=function(){function e(e,t,n){this.app=new Qt(t),this.cloud=new $t,this.user=new nn(e,t,n&&n.logger),this.os=new In(t),this.web=new fn(t),this.sdk=new Wn(e),this.intWeb=new xn(t),this.utc=new An(t),this.loc=new kn,this.device=new Pn,this.telemetryTrace=new _n(t),this.sessionManager=new Qn(t,n&&n.logger),this.session=new Rn}return e.prototype.getSessionId=function(){var e=this.session;if(e&&$n(e.customId))return e.customId;var t=this.sessionManager;t.update();var n=t.automaticSession;if(n){var r=n.getId();r&&$n(r)&&(e.automaticId=r)}return e.automaticId},e.prototype.applyApplicationContext=function(e){var t=this.app;$n(t.id)&&(e.ext[zn.AppExt][Nn.id]=t.id),$n(t.ver)&&(e.ext[zn.AppExt][Nn.ver]=t.ver),$n(t.name)&&(e.ext[zn.AppExt][Nn.appName]=t.name),$n(t.locale)&&(e.ext[zn.AppExt][Nn.locale]=t.locale);var n=t.getExpId();$n(n)&&(e.ext[zn.AppExt][Nn.expId]=n),$n(t.env)&&(e.ext[zn.AppExt][Nn.env]=t.env)},e.prototype.applyUserContext=function(e){var t=this.user,n=t.getLocalId();$n(n)&&(e.ext[zn.UserExt][Ln.localId]=n),$n(t.locale)&&(e.ext[zn.UserExt][Ln.locale]=t.locale),$n(t.id)&&(e.ext[zn.UserExt][Ln.id]=t.id)},e.prototype.applyWebContext=function(e){var t=this.web;$n(t.domain)&&(e.ext[zn.WebExt][jn.domain]=t.domain),$n(t.browser)&&(e.ext[zn.WebExt][jn.browser]=t.browser),$n(t.browserVer)&&(e.ext[zn.WebExt][jn.browserVer]=t.browserVer),$n(t.screenRes)&&(e.ext[zn.WebExt][jn.screenRes]=t.screenRes),e.ext[zn.WebExt][jn.userConsent]=t.getUserConsent(),e.ext[zn.WebExt][jn.consentDetails]=t.getUserConsentDetails()},e.prototype.applyOsContext=function(e){var t=this.os;$n(t.name)&&(e.ext[zn.OSExt][Mn.osName]=t.name),$n(t.ver)&&(e.ext[zn.OSExt][Mn.ver]=t.ver)},e.prototype.applySdkContext=function(e){var t=this.sdk;e.ext[zn.SdkExt][Un.seq]=t.getSequenceId(),e.ext[zn.SdkExt][Un.epoch]=t.epoch,$n(t.installId)&&(e.ext[zn.SdkExt][Un.installId]=t.installId)},e.prototype.applyIntWebContext=function(e){var t=this.intWeb,n=t.getMsfpc();$n(n)&&(e.ext[zn.IntWebExt][Vn.msfpc]=n);var r=t.getAnid();$n(r)&&(e.ext[zn.IntWebExt][Vn.anid]=r),$n(t.serviceName)&&(e.ext[zn.IntWebExt][Vn.serviceName]=t.serviceName)},e.prototype.applyUtcContext=function(e){var t=this.utc;e.ext[zn.UtcExt][Fn.popSample]=t.popSample,t.eventFlags>0&&(e.ext[zn.UtcExt][Fn.eventFlags]=t.eventFlags)},e.prototype.applyLocContext=function(e){e.ext[zn.LocExt][Dn.tz]=this.loc.tz},e.prototype.applySessionContext=function(e){e.ext[zn.AppExt][qn.sessionId]=this.getSessionId()},e.prototype.applyDeviceContext=function(e){var t=this.device;$n(t.localId)&&(e.ext[zn.DeviceExt][Gn.localId]=t.localId),$n(t.make)&&(e.ext[zn.DeviceExt][Gn.make]=t.make),$n(t.model)&&(e.ext[zn.DeviceExt][Gn.model]=t.model),$n(t.deviceClass)&&(e.ext[zn.DeviceExt][Gn.deviceClass]=t.deviceClass)},e.prototype.applyCloudContext=function(e){var t=this.cloud;$n(t.role)&&(e.ext[zn.CloudExt][Bn.role]=t.role),$n(t.roleInstance)&&(e.ext[zn.CloudExt][Bn.roleInstance]=t.roleInstance),$n(t.roleVer)&&(e.ext[zn.CloudExt][Bn.roleVer]=t.roleVer)},e.prototype.applyAITraceContext=function(e){var t=this.telemetryTrace;$n(t.traceId)&&(e.ext[zn.TraceExt][Hn.traceId]=t.traceId),$n(t.name)&&(e.ext[zn.TraceExt][Hn.traceName]=t.name),$n(t.parentId)&&(e.ext[zn.TraceExt][Hn.parentId]=t.parentId)},e}(),Yn=function(e){function t(){var n,i=e.call(this)||this;i.identifier="SystemPropertiesCollector",i.priority=3,i.version="3.0.2";var o={};return M(t,i,(function(t,s){t.initialize=function(r,o,s){e.prototype.initialize.call(i,r,o,s),n=new Jn(r,t._getTelCtx().getExtCfg(t.identifier),o)},t.processTelemetry=function(e,i){It(e,t.identifier),i=t._getTelCtx(i);var s,a,c=e.ext=e.ext?e.ext:{};e.data=e.data?e.data:{},c[zn.AppExt]=c[zn.AppExt]||{},c[zn.UserExt]=c[zn.UserExt]||{},c[zn.WebExt]=c[zn.WebExt]||{},c[zn.OSExt]=c[zn.OSExt]||{},c[zn.SdkExt]=c[zn.SdkExt]||{},c[zn.IntWebExt]=c[zn.IntWebExt]||{},c[zn.UtcExt]=c[zn.UtcExt]||{},c[zn.LocExt]=c[zn.LocExt]||{},c[zn.DeviceExt]=c[zn.DeviceExt]||{},c[zn.TraceExt]=c[zn.TraceExt]||{},c[zn.CloudExt]=c[zn.CloudExt]||{},n.applyApplicationContext(e),n.applyUserContext(e),n.applyWebContext(e),n.applyOsContext(e),n.applySdkContext(e),n.applyIntWebContext(e),n.applyUtcContext(e),n.applyLocContext(e),n.applySessionContext(e),n.applyDeviceContext(e),n.applyAITraceContext(e),n.applyCloudContext(e),r.arrForEach(r.objKeys(c),(function(e){0===r.objKeys(c[e]).length&&delete c[e]})),s=o,a=e.data,s&&Ee(s,(function(e,t){a[e]||(a[e]=t)})),t.processNext(e,i)},t.getPropertiesContext=function(){return n},t.setProperty=function(e,t){o[e]=t}})),i}return __extends(t,e),t}(Gt),Xn=0,Zn=1,er=2,tr=4,nr=5,rr=function(){function e(t,n){var r=n?[].concat(n):[],i=Oe.isNullOrUndefined;this.iKey=function(){return t},this.count=function(){return r.length},this.events=function(){return r},this.addEvents=function(e,t){return void 0===t&&(t=!0),e&&e.length>0?(r=t?r.concat(e):e.concat(r),e.length):0},this.split=function(n,o){var s=new e(t);if(n<r.length){var a=r.length-n;i(o)||(a=o<a?o:a),s.addEvents(r.splice(n,a),!0)}return s}}return e.create=function(t,n){return new e(t,n)},e}(),ir=Math.min(2e6,65e3),or=/\./,sr=function e(t,n,r,i){var o=!!i,s=n,a={};M(e,this,(function(e){function n(e,t,i,c,u,l){Ee(e,(function(e,d){var h=null;if(it(d)){var f=i,g=e,p=u,v=t;if(o&&!c&&or.test(e)){var m=e.split("."),y=m.length;if(y>1){p&&(p=p.slice());for(var S=0;S<y-1;S++){var b=m[S];v=v[b]=v[b]||{},f+="."+b,p&&p.push(b)}g=m[y-1]}}if(h=c&&function(e,t){var n=a[e];return void 0===n&&(n=!1,(0===e.indexOf("ext.metadata")||0===e.indexOf("ext.web"))&&(n=!0),a[e]=n),n}(f)||!s||!s.handleField(f,g)?ut(g,d,r):s.value(f,g,d,r)){var T=h.value;if(v[g]=T,l&&l(p,g,h),et(T)&&!Ze(T)){var w=p;w&&(w=w.slice()).push(g),n(d,T,f+"."+g,c,w,l)}}}}))}e.createPayload=function(e,t,n,r){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r}},e.appendPayload=function(n,r,i){var o=n&&r&&!n.overflow;return o&&Lt(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),o=n.payloadBlob,s=n.numEvents,a=!1,c=[],u=n.isBeacon,l=u?65e3:3984588,d=u?ir:2e6,h=0,f=0;h<t.length;){var g=t[h];if(g){if(s>=i){n.overflow=r.split(h);break}var p=e.getEventBlob(g);if(p.length<=d){var v=p.length;if(o.length+v>l){n.overflow=r.split(h);break}o&&(o+="\n"),o+=p,++f>20&&(o.substr(0,1),f=0),a=!0,s++}else c.push(g),t.splice(h,1),h--}h++}if(c&&c.length>0&&n.sizeExceed.push(rr.create(r.iKey(),c)),a){n.batches.push(r),n.payloadBlob=o,n.numEvents=s;var m=r.iKey();-1===Oe.arrIndexOf(n.apiKeys,m)&&n.apiKeys.push(m)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){return Lt(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={name:e.name,time:e.time,ver:e.ver,iKey:"o:"+ot(e.iKey)},r={},i=e.ext;i&&(t.ext=r,Ee(i,(function(e,t){n(t,r[e]={},"ext."+e,!0,null,null)})));var o=t.data={baseType:e.baseType},s=o.baseData={};return n(e.baseData,s,"baseData",!1,["baseData"],(function(e,t,n){ar(r,e,t,n)})),n(e.data,o,"data",!1,[],(function(e,t,n){ar(r,e,t,n)})),JSON.stringify(t)}),(function(){return{item:e}}))}}))};function ar(e,t,n,r){if(r&&e){var i=ht(r.value,r.kind,r.propertyType);if(i>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var s=o.f;s||(s=o.f={}),Ge(t,(function(e){s[e]||(s[e]={f:{}});var t=s[e].f;t||(t=s[e].f={}),s=t})),s=s[n]={},Ze(r.value)?s.a={t:i}:s.t=i}}}var cr,ur=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e&&429!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),lr=function e(){var t={};M(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=(s=e.split(","),a=[],s&&Ge(s,(function(e){a.push(tt(e))})),a);if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),o=0;o<r.length;++o)t[r[o]]=Oe.dateNow()+i}catch(e){return[]}var s,a;return[]},e.isTenantKilled=function(e){var n=t,r=tt(e);return void 0!==n[r]&&n[r]>Oe.dateNow()||(delete n[r],!1)}}))},dr=function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",o=!1;M(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,n=!0,o=!0):n=!1,t=!0)}}))};function hr(e){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var fr=((cr={})[1]="requeue",cr[100]="requeue",cr[200]="sent",cr[8004]="drop",cr[8003]="drop",cr);function gr(e){try{return e.responseText}catch(e){}return""}var pr=function e(t,n,r,i){this._responseHandlers=[];var o,s,a,c="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version="+Pe,u=new lr,l=!1,d=new dr,h=!1,f=0,g=!0,p=[],v={},m=[],y=null,S=!1;M(e,this,(function(e){var b=!0;function T(e,t){var n=new XDomainRequest;n.open("POST",e.urlString),n.onload=function(){var e=gr(n);C(t,200,{},e),U(e)},n.onerror=function(){C(t,400,{})},n.ontimeout=function(){C(t,500,{})},n.send(e.data)}function w(e,t){var n;fetch(e.urlString,(n={body:e.data,method:"POST",credentials:"include"},n.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,n.headers=e.headers,n)).then((function(e){var n={},r="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),C(t,e.status,n,r),U(r)})).catch((function(e){C(t,0,{})}))}function E(e,t,n){function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=tt(r))}return e}function i(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if($e(e)){var n=tt(e).split(/[\r\n]+/);Ge(n,(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=tt(e.substring(0,n)).toLowerCase(),i=tt(e.substring(n+1));t[r]=i}else t[tt(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=r(t,e,"time-delta-millis"),t=r(t,e,"kill-duration"),t=r(t,e,"kill-duration-seconds")),t}function o(e,n){C(t,e.status,i(e),n)}var s=new XMLHttpRequest;try{s.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0}catch(e){}b&&(s.withCredentials=!0),s.open("POST",e.urlString,!n),Ge(Ke(e.headers),(function(t){s.setRequestHeader(t,e.headers[t])})),s.onload=function(){var e=gr(s);o(s,e),U(e)},s.onerror=function(){o(s)},s.ontimeout=function(){o(s)},s.send(e.data)}function C(e,t,n,r){try{e(t,n,r)}catch(e){o.diagLog().throwInternal(L.WARNING,Q.SendPostOnCompleteFailure,e)}}function O(){return!l&&f<n}function I(){var e=m;return m=[],e}function x(e,t,n){var r=!1;return e&&e.length>0&&!l&&s&&y&&(r=t||O()&&(n>0||d.allowRequestSending())),r}function A(e){var t={};return e&&Ge(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function k(e,n,r,i,o,s){if(e&&0!==e.length)if(l)V(e,1,i);else{var c=e;Lt(a,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var c=[],l=null,d=bt();x(e,i,n);){var h=e.shift();h&&h.count()>0&&(u.isTenantKilled(h.iKey())?c.push(h):(l=l||y.createPayload(n,r,i,s&&R()),y.appendPayload(l,h,t)?null!==l.overflow&&(e=[l.overflow].concat(e),l.overflow=null,N(l,d,bt(),o),d=bt(),l=null):(N(l,d,bt(),o),d=bt(),e=[h].concat(e),l=null)))}l&&N(l,d,bt(),o),e.length>0&&(m=e.concat(m)),V(c,8004,i)}),(function(){return{batches:A(c),retryCount:n,isTeardown:r,isSynchronous:i,sendReason:o,useSendBeacon:s}}),!i)}}function P(e){var t=c,n="";Ge(e.apiKeys,(function(e){n.length>0&&(n+=","),n+=e})),n.length>0&&(t+="&apikey="+n),t+="&upload-time="+Oe.dateNow().toString();var r=function(e){for(var t=0;t<e.batches.length;t++)for(var n=e.batches[t].events(),r=0;r<n.length;r++){var i=(n[r].ext||{}).intweb||{};if(it(i.msfpc))return encodeURIComponent(i.msfpc)}return""}(e);if(it(r)&&(t=t+"&ext.intweb.msfpc="+r),d.shouldAddClockSkewHeaders()&&(t+="&time-delta-to-apply-millis="+d.getClockSkewHeaderValue()),a.getWParam){var i=a.getWParam();i>=0&&(t+="&w="+i)}for(var o=0;o<p.length;o++)t+="&"+p[o].name+"="+p[o].value;return t}function R(){return!g&&h&&st()}function _(e,t,n){e[t]=e[t]||{},e[t][o.identifier]=n}function N(t,n,i,c){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=P(t),h=bt();Lt(a,(function(){return"HttpManager:_doPayloadSend"}),(function(){Ge(t.batches,(function(e){Ge(e.events(),(function(e){if(S){var t=e.timings=e.timings||{};_(t,"sendEventStart",h),_(t,"serializationStart",n),_(t,"serializationCompleted",i)}e.sendAttempt>0?e.sendAttempt++:e.sendAttempt=1}))})),V(t.batches,1e3+(c||0),t.isSync,!0);var g={data:t.payloadBlob,urlString:l,headers:v},p=null,m=!!e.sendHook;R()&&t.isBeacon?(m=!1,p=function(n){!function(e,t,n){try{if(st()){var r=ie();if(r.sendBeacon(e.urlString,e.data))return void j(t,200,n,!1);Ge(t.batches,(function(e){null.push(e.split(0))})),j(t,200,n,!1),V(null,8003,t.isSync,!0)}}catch(e){o.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e)}}(n,t,c),e.sendListener&&e.sendListener(g,n,t.isSync||t.isTeardown,!0)}):s&&(p=function(n){d.firstRequestSent();var i=function(e,n){!function(e,t,n,i){var o=9e3,s=null,a=!1,c=!1;try{var l=!0;if(hr(e)!==Re){if(t){d.setClockSkew(t["time-delta-millis"]);var h=t["kill-duration"]||t["kill-duration-seconds"];Ge(u.setKillSwitchTenants(t["kill-tokens"],h),(function(e){Ge(n.batches,(function(t){if(t.iKey()===e){s=s||[];var r=t.split(0);n.numEvents-=r.count(),s.push(r)}}))}))}if(200===e)return void(o=200);(!ur.shouldRetryForStatus(e)||n.numEvents<=0)&&(l=!1),o=9e3+e%1e3}if(l){o=100;var g=n.retryCnt;n.isSync||(g<r?(a=!0,M((function(){n.isSync||f--,k(n.batches,g+1,n.isTeardown,n.isSync,5,n.isBeacon)}),!0,ur.getMillisToBackoffForRetry(g))):c=!0)}}finally{a||(d.setClockSkew(),j(n,o,i,c)),V(s,8004,n.isSync)}}(e,n,t,c)};try{s.sendPOST(n,i,t.isTeardown||t.isSync),e.sendListener&&e.sendListener(g,n,t.isSync||t.isTeardown,!1)}catch(e){C(i,0,{})}}),Lt(a,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(p)if(t.isSync||f++,m){var n={data:g.data,urlString:g.urlString,headers:g.headers},r=!1;Lt(a,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,p(e)}),t.isSync||t.isTeardown)}catch(e){r||p(g)}}))}else p(g)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:c}}),t.isSync)}V(t.sizeExceed,8003,t.isSync)}function j(t,n,r,i){try{i&&o._backOffTransmission(),200===n&&(i||t.isSync||o._clearBackOff(),function(e){if(S){var t=bt();Ge(e,(function(e){var n,r;e&&e.count()>0&&(n=e.events(),r=t,S&&Ge(n,(function(e){_(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(t.batches)),V(t.batches,n,t.isSync,!0)}finally{t.isSync||(f--,5!==r&&e.sendQueuedRequests(r,!t.isSync,t.isBeacon))}}function M(e,t,n){t?e():o._setTimeoutOverride(e,n)}function U(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){o.diagLog().throwInternal(L.CRITICAL,Q.PostResponseHandler,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);it(i.webResult)&&it(i.webResult.msfpc)&&pt("MSFPC",i.webResult.msfpc,365)}}catch(e){}}function V(e,t,n,r){if(e&&e.length>0&&i){var s=i[(c=t,u=fr[c],it(u)||(u="oth",c>=9e3&&c<=9999?u="rspFail":c>=8e3&&c<=8999?u="drop":c>=1e3&&c<=1999&&(u="send")),u)];s&&Lt(a,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){M((function(){try{s.call(i,e,t,n)}catch(e){o.diagLog().throwInternal(L.CRITICAL,Q.NotificationException,"send request notification failed: "+e)}}),r||n,0)}),(function(){return{batches:A(e),reason:t,isSync:n,sendSync:r}}),!n)}var c,u}e.initialize=function(e,t,n,r,i){i||(i={}),c=e+c,S=!(a=t).config.disableEventTimings;var u=!!a.config.enableCompoundKey;o=n;var l=i.valueSanitizer,d=i.stringifyObjects;if(Oe.isUndefined(i.enableCompoundKey)||(u=!!i.enableCompoundKey),y=new sr(a,l,d,u),!(s=r)){g=!1,h=!Qe();var f=oe();f&&f.protocol&&"file:"===f.protocol.toLowerCase()&&(b=!1);var p=null;dt()?p=T:Qe()?p=w:"undefined"!=typeof XMLHttpRequest&&(p=E),s={sendPOST:p}}},e._getDbgPlgTargets=function(){return[s,u,y]},e.addQueryStringParameter=function(e,t){for(var n=0;n<p.length;n++)if(p[n].name===e)return void(p[n].value=t);p.push({name:e,value:t})},e.addHeader=function(e,t){v[e]=t},e.canSendRequest=function(){return O()&&d.allowRequestSending()},e.sendQueuedRequests=function(e,t,n){var r=!Oe.isNullOrUndefined(t)&&!t;x(m,r,0)&&k(I(),0,!1,r,e||0,!!n)},e.isCompletelyIdle=function(){return!l&&0===f&&0===m.length},e.addBatch=function(e){if(e&&e.count()>0){if(u.isTenantKilled(e.iKey()))return!1;m.push(e)}return!0},e.teardown=function(){m.length>0&&k(I(),0,!0,!0,2,!0)},e.pause=function(){l=!0},e.resume=function(){l=!1,e.sendQueuedRequests(4,!1)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&k([e],0,!1,!0,t||0,!!n)}}))},vr=rt?window:void 0,mr=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.0.2";var i,o,s,a,c,u=!1,l=[],d=null,h=!1,f=0,g=1e4,p={},v="REAL_TIME",m=null,y=0,S=0,b={},T=-1;return M(t,r,(function(e,t){function r(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=q),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,e.sync)if(y||h)e.latency=B,e.sync=!1;else if(o)return void o.sendSynchronousBatch(rr.create(e.iKey,[e]),3);var n=!1;f<g?n=!P(e,t):(n=!0,function(e,t){var n=q;for(;n<=t;){var r=A(e,t,!0);if(r&&r.count()>0){var i=r.split(0,20);if(i.count()>0)return M("eventsDiscarded",[i],nr),!0}n++}return!1}(e.iKey,e.latency)&&(n=!P(e,t))),n&&j("eventsDiscarded",[e],nr)}function w(e,t,n,r){var i=R(e,t,n);return o.sendQueuedRequests(t,n,r),i}function E(){return f>0}function C(){T>=0&&R(T,c,!0)&&o.sendQueuedRequests(c,!0,!1);var e=p[v][1];!m&&!d&&e>=0&&!h&&(E()?m=O((function(){m=null,w(0===S?B:q,1,!0),S++,S%=2,C()}),e):S=0)}function O(t,n){0===n&&y&&(n=1);var r=1e3;return y&&(r=ur.getMillisToBackoffForRetry(y-1)),e._setTimeoutOverride(t,n*r)}function I(){null!==m&&(e._clearTimeoutOverride(m),m=null,S=0)}function x(t,n){I(),d&&(e._clearTimeoutOverride(d),d=null),h||w(q,t,n,!0)}function A(e,t,n){var r=b[t];r||(r=b[t=q]);var i=r.iKeyMap[e];return!i&&n&&(i=rr.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function k(t,n){o.canSendRequest()&&!y&&(s>0&&f>s&&(n=!0),n&&null==d&&e.flush(t,null,20))}function P(e,t){var n=A(e.iKey,e.latency,!0);return!!n.addEvents([e],t)&&(f++,t&&0===e.sendAttempt&&k(!e.sync,a>0&&n.count()>=a),!0)}function R(t,n,r){var i=!1;return!r||o.canSendRequest()?Lt(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=B;n>=t;){var r=b[n];r&&r.batches&&(Ge(r.batches,(function(t){o.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),f-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&j("eventsDiscarded",e,tr),i&&T>=t&&(T=-1,c=0)}),(function(){return{latency:t,sendReason:n}}),r):(T=T>=0?Math.min(T,t):t,c=Math.max(c,n)),i}function _(){(p={}).REAL_TIME=[2,1],p.NEAR_REAL_TIME=[6,3],p.BEST_EFFORT=[18,9]}function N(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){e.diagLog().throwInternal(L.CRITICAL,Q.NotificationException,t+" notification failed: "+n)}}function j(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&N(e,[t].concat(n))}function M(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&Ge(t,(function(t){t&&t.count()>0&&N(e,[t.events()].concat(n))}))}function U(){a=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,g/6)}_(),b[B]={batches:[],iKeyMap:{}},b[G]={batches:[],iKeyMap:{}},b[q]={batches:[],iKeyMap:{}},U(),o=new pr(500,2,1,{requeue:function(t,n){var i=[];Ge(t,(function(t){t&&t.count()>0&&Ge(t.events(),(function(t){t&&(t.sync&&(t.latency=B,t.sync=!1),t.sendAttempt<6?(It(t,e.identifier),r(t,!1)):i.push(t))}))})),i.length>0&&j("eventsDiscarded",i,Zn)},send:function(e,t,n){e&&e.length>0&&N("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])},sent:function(e,t){M("eventsSent",e,t),C()},drop:function(e,t){M("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:Xn)},rspFail:function(e){M("eventsDiscarded",e,Zn),C()},oth:function(e,t){M("eventsDiscarded",e,Xn),C()}}),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(r,a,c){Lt(a,(function(){return"PostChannel:initialize"}),(function(){var u=a;t.initialize(r,a,c),e.setInitialized(!1);var l=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},n=l.getExtCfg(e.identifier),e._setTimeoutOverride=n.setTimeoutOverride?n.setTimeoutOverride:setTimeout.bind(vr),e._clearTimeoutOverride=n.clearTimeoutOverride?n.clearTimeoutOverride:clearTimeout.bind(vr);var d=u.getWParam;u.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|d()},n.eventsLimitInMem>0&&(g=n.eventsLimitInMem),n.autoFlushEventsLimit>0&&(s=n.autoFlushEventsLimit),U(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),it(r.anonCookieName)&&o.addQueryStringParameter("anoncknm",r.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var h=n.overrideEndpointUrl?n.overrideEndpointUrl:r.endpointUrl;e._notificationManager=r.extensionConfig.NotificationManager,o.initialize(h,e.core,e,i,n),Ot((function(){x(2,!1)})),e.setInitialized(!0)}),(function(){return{coreConfig:r,core:a,extensions:c}}))},e.processTelemetry=function(t,i){It(t,e.identifier);var o=(i=e._getTelCtx(i)).getExtCfg(e.identifier),s=!!n.disableTelemetry;o&&(s=s||!!o.disableTelemetry);var a=t;s||u||(n.overrideInstrumentationKey&&(a.iKey=n.overrideInstrumentationKey),o&&o.overrideInstrumentationKey&&(a.iKey=o.overrideInstrumentationKey),r(a,!0),C()),e.processNext(a,i)},e.setEventQueueLimits=function(e,t){g=e>0?e:1e4,s=t>0?t:0,U();var n=f>e;if(!n&&a>0)for(var r=q;!n&&r<=B;r++){var i=b[r];i&&i.batches&&Ge(i.batches,(function(e){e&&e.count()>=a&&(n=!0)}))}k(!0,n)},e.teardown=function(){x(2,!1),u=!0,o.teardown()},e.pause=function(){I(),h=!0,o.pause()},e.resume=function(){h=!1,o.resume(),C()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){I(),_(),v="REAL_TIME",C(),Ee(e,(function(e,t){if(t.length>=2){if(t.splice(0,t.length-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var n=t[0]/t[1];t[0]=Math.ceil(n)*t[1]}p[e]=t}}))},e.flush=function(e,t,n){void 0===e&&(e=!0),h||(I(),n=n||1,e?(R(q,n,e),null==d?d=O((function(){!function e(t,n){w(q,n,!0),function e(t){o.isCompletelyIdle()?t():d=O((function(){e(t)}),.25)}((function(){t&&t(),l.length>0?d=O((function(){return e(l.shift(),n)}),0):(d=null,E()&&C())}))}(t,n)}),0):l.push(t)):(w(q,n,!1),null!=t&&t()))},e.setMsaAuthTicket=function(e){o.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=E,e._setTransmitProfile=function(e){v!==e&&void 0!==p[e]&&(I(),v=e,C())},e._backOffTransmission=function(){y<4&&(y++,I(),C())},e._clearBackOff=function(){y&&(y=0,I(),C())}})),r}return __extends(t,e),t}(Gt),yr=Oe.isFunction;function Sr(e,t){for(var n=[],r=null,i=e.getNext();i;){var o=i.getPlugin();o&&(r&&yr(r.setNextPlugin)&&yr(o.processTelemetry)&&r.setNextPlugin(o),yr(o.isInitialized)&&o.isInitialized()||n.push(o),r=o,i=i.getNext())}Oe.arrForEach(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function br(e){return e.sort((function(e,t){var n=0,r=yr(t.processTelemetry);return yr(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1),n}))}var Tr=Oe.objDefineAccessors,wr=function(e){function t(){var n=e.call(this)||this;n.identifier="ChannelControllerPlugin",n.priority=500;var r,i=Oe.arrForEach;function o(e){e&&e.length>0&&(function(e){i(e,(function(e){if(e.priority<500)throw Error("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),r.push(e))}return M(t,n,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){r&&i(r,(function(r){r.length>0&&n._getTelCtx(t).createNew(r).processNext(e)}))},e.getChannelControls=function(){return r},e.initialize=function(n,s,a){e.isInitialized()||(t.initialize(n,s,a),n.isCookieUseDisabled&&Oe.disableCookies(),function(e,t){r=[],e&&i(e,(function(e){return o(e)}));if(t){var n=[];i(t,(function(e){e.priority>500&&n.push(e)})),o(n)}}((n||{}).channels,a),i(r,(function(e){return Sr(new Dt(e,n,s),a)})))}})),n}return __extends(t,e),t.prototype.processTelemetry=function(e,t){},t.prototype.getChannelControls=function(){return null},t.prototype.initialize=function(e,t,n){},t._staticInit=(Tr(t.prototype,"ChannelControls",t.prototype.getChannelControls),void Tr(t.prototype,"channelQueue",t.prototype.getChannelControls)),t}(Gt),Er=Oe.arrForEach,Cr=Oe.isNullOrUndefined,Or=function(){function e(){var t,n,r,i,o=!1;M(e,this,(function(e){e._extensions=new Array,n=new wr,e.logger=Oe.objCreate({throwInternal:function(e,t,n,r,i){void 0===i&&(i=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}}),t=[],e.isInitialized=function(){return o},e.initialize=function(t,i,s,a){if(e.isInitialized())throw Error("Core should not be initialized more than once");if(!t||Cr(t.instrumentationKey))throw Error("Please provide instrumentation key");r=a,e._notificationManager=a,e.config=t||{},t.extensions=Cr(t.extensions)?[]:t.extensions,(t.extensionConfig=Cr(t.extensionConfig)?{}:t.extensionConfig).NotificationManager=a,s&&(e.logger=s);var c=[];c.push.apply(c,i.concat(t.extensions)),c=br(c);var u=[],l=[],d={};if(Er(c,(function(e){if(Cr(e)||Cr(e.initialize))throw Error("Extensions must provide callback to initialize");var t=e.priority,r=e.identifier;e&&t&&(Cr(d[t])?d[t]=r:s.warnToConsole("Two extensions have same priority #"+t+" - "+d[t]+", "+r)),!t||t<n.priority?u.push(e):l.push(e)})),c.push(n),u.push(n),c=br(c),e._extensions=c,Sr(new Dt([n],t,e),c),Sr(new Dt(u,t,e),c),e._extensions=u,0===e.getTransmissionControls().length)throw new Error("No channels available");o=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){n.iKey||(n.iKey=e.config.instrumentationKey),n.time||(n.time=Oe.toISOString(new Date)),Cr(n.ver)&&(n.ver="4.0"),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,r=t;return t&&0!==t.length||(r=[n]),new Dt(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=Oe.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=r),r},e.getPerfMgr=function(){return i||e.config&&e.config.enablePerfMgr&&(i=new jt(e.getNotifyMgr())),i},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(Er(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))}return e.prototype.initialize=function(e,t,n,r){},e.prototype.getTransmissionControls=function(){return null},e.prototype.track=function(e){},e.prototype.getProcessTelContext=function(){return null},e.prototype.getNotifyMgr=function(){return null},e.prototype.getPerfMgr=function(){return null},e.prototype.setPerfMgr=function(e){},e.prototype.eventCnt=function(){return 0},e.prototype.releaseQueue=function(){},e}(),Ir=function(){function e(t){this.listeners=[];var n=Oe.arrForEach,r=!!(t||{}).perfEvtsSendAll;M(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Oe.arrIndexOf(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Oe.arrIndexOf(e.listeners,t)},e.eventsSent=function(t){n(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,r){n(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,r)}),0)}))},e.eventsSendRequest=function(t,r){n(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(r)setTimeout((function(){return e.eventsSendRequest(t,r)}),0);else try{e.eventsSendRequest(t,r)}catch(e){}}))},e.perfEvent=function(t){t&&(!r&&t.isChildEvt()||n(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))}return e.prototype.addNotificationListener=function(e){},e.prototype.removeNotificationListener=function(e){},e.prototype.eventsSent=function(e){},e.prototype.eventsDiscarded=function(e,t){},e.prototype.eventsSendRequest=function(e,t){},e}(),xr=function(e){function t(){var n=e.call(this)||this;return M(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],er)}e.initialize=function(e,n,r,i){t.initialize(e,n,r||new _t(e),i||new Ir(e))},e.track=function(r){Lt(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){if(null===r)throw n(r),Error("Invalid telemetry item");!function(e){if(Oe.isNullOrUndefined(e.name))throw n(e),Error("telemetry name required")}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval((function(){var n=e.logger?e.logger.queue:[];Oe.arrForEach(n,(function(n){var r={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:Oe.toISOString(new Date),baseType:Rt.dataType,baseData:{message:n.message}};e.track(r)})),n.length=0}),n)}})),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,r){},t.prototype.track=function(e){},t.prototype.addNotificationListener=function(e){},t.prototype.removeNotificationListener=function(e){},t.prototype.pollInternalLogs=function(e){return 0},t}(Or),Ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(t,n){var r=this,i=this;Lt(this,(function(){return"ApplicationInsights:initialize"}),(function(){i._postChannel=new mr,i._propertyManager=new Yn;var o=[r._propertyManager];if(n&&(o=o.concat(n)),t.channels&&t.channels.length>0){for(var s=!1,a=0;a<t.channels[0].length;a++)if(t.channels[0][a].identifier===i._postChannel.identifier){s=!0;break}s||t.channels[0].push(i._postChannel)}else t.channels=[[i._postChannel]];var c=t.extensionConfig=t.extensionConfig||[];c[i._postChannel.identifier]=t?t.channelConfiguration:{},c[i._propertyManager.identifier]=t?t.propertyConfiguration:{};try{e.prototype.initialize.call(r,t,o)}catch(e){i.logger.throwInternal(L.CRITICAL,Q.FailedToInitializeSDK,"Failed to initialize SDK."+e)}}),(function(){return{config:t,extensions:n}}))},t.prototype.getPropertyManager=function(){return this._propertyManager},t.prototype.getPostChannel=function(){return this._postChannel},t}(function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",M(t,n,(function(e,t){e.initialize=function(n,r,i,o){Lt(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;if(s&&(!s.getProperty||!s.setProperty))throw new Error("Invalid property storage override passed.");n.channels&&Ge(n.channels,(function(t){t&&Ge(t,(function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&Ge(r,(function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,r,i,o)}catch(t){e.logger.throwInternal(L.CRITICAL,Q.ErrorProvidedChannels,"Channels must be provided through config.channels only")}e.pollInternalLogs("InternalLog")}),(function(){return{config:n,extensions:r,logger:i,notificationManager:o}}))},e.track=function(n){Lt(e,(function(){return"AppInsightsCore.track"}),(function(){var r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=bt(),ct(r.latency)||(r.latency=q);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver=Pe;var o=r.baseData=r.baseData||{};o.properties||(o.properties={});var s=o.properties;s.version||(s.version=""),""!==e.pluginVersionString&&(s.version=e.pluginVersionString)}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,r){},t.prototype.track=function(e){},t}(xr)),kr=function(){},Pr=function(){function e(e,t){this._base="",this._currentElement=0,this._base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this._cv1Constants=new kr,this._cv2Constants=new kr,this._cvVersionAtLatestValidityCheck=2,this._traceLogger=t?t.logger:new _t,this._cv1Constants.maxCorrelationVectorLength=63,this._cv1Constants.baseLength=16,this._cv1Constants.validationPattern=new RegExp("^["+this._base64CharSet+"]{"+this._cv1Constants.baseLength.toString()+"}(.[0-9]+)*$"),this._cv2Constants.maxCorrelationVectorLength=127,this._cv2Constants.baseLength=22,this._cv2Constants.validationPattern=new RegExp("^["+this._base64CharSet+"]{"+this._cv2Constants.baseLength.toString()+"}(.[0-9]+)*$"),this._currentCvConstants=this._cv2Constants,this.init(e)}return e.prototype.isInit=function(){return this.isValid(this.storedCv())},e.prototype.storedCv=function(){return this._base.concat(".",this._currentElement.toString())},e.prototype.getValue=function(){var e=this.storedCv();if(this.isValid(e))return e},e.prototype.getRelatedCv=function(){return this._relatedCv},e.prototype.incrementExternal=function(e){if(this.isValid(e)){var t=e.split("."),n=t.length;t[n-1]=(parseInt(t[n-1],10)+1).toString();for(var r="",i=0;i<n;i++)r+=t[i],i<n-1&&(r+=".");var o=t[0].length===this._cv2Constants.baseLength?this._cv2Constants.maxCorrelationVectorLength:this._cv1Constants.maxCorrelationVectorLength;if(r.length<=o)return r}},e.prototype.canExtend=function(){var e=this.storedCv();return!!this.isValid(e)&&this._isLeqThanMaxCorrelationVectorLength(e.length+2)},e.prototype.canIncrement=function(){return!!this.isValid(this.storedCv())&&this._isLeqThanMaxCorrelationVectorLength(this._base.length+1+(this._currentElement+1+"").length)},e.prototype.setValue=function(e){if(this.isValid(e)){var t=e.lastIndexOf(".");return t>1?(this._base=e.substr(0,t),this._currentElement=parseInt(e.substr(t+1),10)):(this._base=e,this._currentElement=0),!0}return this._traceLogger.throwInternal(L.WARNING,Q.InvalidCorrelationValue,"Cannot set invalid correlation vector value"),!1},e.prototype.setValueLegacy=function(e){return this.setValue(e),this.getValue()},e.prototype.seed=function(){for(var e="",t=0;t<this._currentCvConstants.baseLength;t++)e+=this._base64CharSet.charAt(Math.floor(Math.random()*this._base64CharSet.length));return e},e.prototype.extend=function(){if(this.canExtend())return this._base=this._base.concat(".",this._currentElement.toString()),this._currentElement=0,this.storedCv()},e.prototype.increment=function(){if(this.canIncrement())return this._currentElement=this._currentElement+1,this.storedCv()},e.prototype.validateWithCv1=function(e){if(this._cv1Constants.validationPattern.test(e)&&e.length<=this._cv1Constants.maxCorrelationVectorLength)return!0},e.prototype.validateWithCv2=function(e){if(this._cv2Constants.validationPattern.test(e)&&e.length<=this._cv2Constants.maxCorrelationVectorLength)return!0},e.prototype.useCv1=function(){this._currentCvConstants=this._cv1Constants},e.prototype.useCv2=function(){this._currentCvConstants=this._cv2Constants},e.prototype.isValid=function(e){if(e){var t=e.split(".")[0];if(t){if(16===t.length)return this._cvVersionAtLatestValidityCheck=1,this.validateWithCv1(e);if(22===t.length)return this._cvVersionAtLatestValidityCheck=2,this.validateWithCv2(e)}}},e.prototype.init=function(e){return e?this.setValue(e):(this._base=this.seed(),this._currentElement=0),this.getValue()},e.prototype.initLegacy=function(e){return this.init(e)},e.prototype._isLeqThanMaxCorrelationVectorLength=function(e){return 1===this._cvVersionAtLatestValidityCheck?e<=this._cv1Constants.maxCorrelationVectorLength:e<=this._cv2Constants.maxCorrelationVectorLength},e}(),Rr=function(e){function t(t){var n=e.call(this)||this;return n.identifier="CorrelationVectorPlugin",n.priority=159,n.version="3.0.2",n._cvInitialValue=t,n._cv=n._cvInitialValue?new Pr(n._cvInitialValue):new Pr,n}return __extends(t,e),t.prototype.initialize=function(t,n,r){e.prototype.initialize.call(this,t,n,r)},t.prototype.processTelemetry=function(e,t){It(e,this.identifier),e.ext=e.ext||{},e.ext.mscv=e.ext.mscv||{},e.ext.mscv.cV||this._cv&&this._cv.isInit()&&(e.ext.mscv.cV=this._cv.getValue()),this.processNext(e,t)},t.prototype.getCv=function(){return this._cv||this.diagLog().throwInternal(L.WARNING,Q.FailedToInitializeCorrelationVector,"Correlation Vector has not been initialized."),this._cv},t}(Gt),_r=n(3),Nr=function(){function e(){}return e.format=function(t){t.PassThroughTokens=e.stringArrayToLowerCase(t.PassThroughTokens),t.ScrubQueryParametersHostNames=e.stringArrayToLowerCase(t.ScrubQueryParametersHostNames),t.ScrubToPartialHostNames=e.stringArrayToLowerCase(t.ScrubToPartialHostNames),t.UriQueryParameters.PassThroughQueryParameters=e.stringArrayToLowerCase(t.UriQueryParameters.PassThroughQueryParameters);var n={};Object.keys(t.UriQueryParameters.ScrubQueryParameters).forEach((function(r){var i=t.UriQueryParameters.ScrubQueryParameters[r];i&&((i.type===_r.b.string||i.type===_r.b.stringOrAnyGuid)&&i.acceptedValues&&(i.acceptedValues=e.stringArrayToLowerCase(i.acceptedValues)));n[r.toLowerCase()]=i})),t.UriQueryParameters.ScrubQueryParameters=n},e.stringArrayToLowerCase=function(e){return e.map((function(e){return e.toLowerCase()}))},e}(),jr=function(){function e(){}return e.validate=function(e){var t=this,n="";if(e){if(e.PassThroughTokens||(n+="PassThroughTokens is undefined, define it explicitly as empty if you want to scrubb all tokens.\n"),e.ScrubQueryParametersHostNames||(n+="ScrubQueryParametersHostNames is undefined, define it explicitely as empty if            you do not want any host name's params to be scrubbed. \n"),e.ScrubToPartialHostNames||(n+="ScrubQueryParametersHostNames is undefined, define it explicitely as empty if            you do not want any partial host name's to be kept. \n"),e.UriQueryParameters)if(e.UriQueryParameters.PassThroughQueryParameters)if(e.UriQueryParameters.ScrubQueryParameters)for(var r in e.UriQueryParameters.ScrubQueryParameters){var i=e.UriQueryParameters.ScrubQueryParameters[r];i&&i.type===_r.b.number&&i.acceptedValues&&(n+="param "+r+" in ScrubQueryParameters is of type number and has accepted values.                'number' type does not support accepted values")}else n+="UriQueryParameters.ScrubQueryParameters is undefined, define it explicitely as empty if         you do not want any recognized uri query params names to be kept. \n";else n+="UriQueryParameters.PassThroughQueryParameters is undefined, define it explicitely as empty if         you do not want any UriQueryParameters value to be always kept. \n";else n+="UriQueryParameters is undefined, define it explicitely as empty if         you do not want any UriQueryParameters to be kept. \n";e.DropEventNames||(n+="DropEventNames is undefined, define it explicitely as empty if you do not want any event to be dropped. \n"),e.GlobalFieldsDictionary?n=this.validateFieldScrubbingDictionary(e.GlobalFieldsDictionary,"GlobalFieldsDictionary",n):n+="GlobalFieldsDictionary is undefined, define it explicitely as empty if you do not want any field to be scrubbed. \n",e.EventFieldsDictionary?Object.keys(e.EventFieldsDictionary).forEach((function(r){var i=e.EventFieldsDictionary[r];n=t.validateFieldScrubbingDictionary(i,"EventFieldsDictionary."+r,n)})):n+="EventFieldsDictionary is undefined, define it explicitely as empty if         you do not want any field to be scrubbed. \n"}else n="PrivacyScrubbingConfig object is undefined and cannot be validated";if(""!==n)throw new Error(n)},e.validateFieldScrubbingDictionary=function(t,n,r){return Object.keys(t).forEach((function(i){var o=t[i];Object(_r.d)(o)?o.forEach((function(t){r+=e.validateNestedField(t,n,r)})):Object(_r.c)(o)||(r+="Entry in FieldScrubbingDictionary was neither a Strategy or complete NestedField under "+n+". \n")})),r},e.validateNestedField=function(t,n,r){return r=e.validateFullPath(t.FullPath,n,r),r=e.validateEventFieldScrubbingStrategy(t.Strategy,n,r)},e.validateEventFieldScrubbingStrategy=function(e,t,n){return n+=Object(_r.c)(e)?"":"Invalid scrubbing strategy: "+e+" was added as part of dictionary "+t+". \n"},e.validateFullPath=function(t,n,r){t||(r+="Empty or undefined FullPath provided as part of dictionary "+n+" \n");var i=t.match(e.fullPathValidationRegex);return!i||i.length<=0?r+="No match found for the FullPath provided as part of dictionary "+n+" \n":i[0].length!==t.length&&(r+="Incomplete match found for the FullPath provided as part of dictionary "+n+".\n      Verify that your FullPath entry is valid using the following regex: "+e.fullPathValidationRegex.toString()+" \n"),r},e.fullPathValidationRegex=new RegExp(/[a-z][a-zA-Z]*(\.[a-z][a-zA-Z]*)*/),e}(),Lr=/^(([0-9a-fA-F]){8}-([0-9a-fA-F]){4}-([0-9a-fA-F]){4}-([0-9a-fA-F]){4}-([0-9a-fA-F]){12})$/;function Mr(e){return Lr.test(e)}var Ur=function(){function e(e,t){this.config=e,this.tokenScrubber=t}return e.prototype.scrub=function(e){var t=!1;return e&&e.data&&(this.scrubGlobalFields(e),this.scrubEventFields(e),t=!0),t},e.prototype.inDropEventList=function(e){return void 0!==e&&this.config.DropEventNames.indexOf(e.name)>-1},e.prototype.scrubEventFields=function(e){e.name in this.config.EventFieldsDictionary&&this.scrubFields(e,this.config.EventFieldsDictionary[e.name])},e.prototype.scrubGlobalFields=function(e){this.scrubFields(e,this.config.GlobalFieldsDictionary)},e.prototype.scrubFields=function(e,t){var n=this;if(t&&Object.keys(t).length>0)for(var r in e.data)if(r in t){var i=t[r];if(Object(_r.d)(i))i.forEach((function(t){var r=n.getParentObjectByPath(e.data,t.FullPath);r&&n.applyStrategy(r,t.Strategy)}));else if(Object(_r.c)(i)){var o=i;this.applyStrategy({parent:e.data,fieldName:r},o)}}},e.prototype.applyStrategy=function(e,t){var n=e.parent,r=e.fieldName;try{if(t===_r.a.drop)delete n[r];else if(t===_r.a.scrubOrAnyGuid){if((o=n[r])&&!Mr(o)){var i=this.tokenScrubber.scrub(o);n[r]=i}}else if(t===_r.a.scrub){var o;if(o=n[r]){i=this.tokenScrubber.scrub(o);n[r]=i}}}catch(e){n&&r&&(n[r]=null)}},e.prototype.getParentObjectByPath=function(e,t){if(e&&t){var n=e,r=t.split("."),i=r.pop();if(i){for(var o=0,s=r;o<s.length;o++){if(!(n=n[s[o]]))return}if(n[i])return{parent:n,fieldName:i}}}},e}(),Vr=function(){function e(e,t){this.config=e,this.uriScrubber=t}return e.prototype.scrub=function(e){var t=this;return e?e instanceof Array?e.map((function(e){return t.scrubTokenInternal(e)})):this.scrubTokenInternal(e):""},e.prototype.scrubTokenInternal=function(e){return void 0===e||-1!==this.config.PassThroughTokens.indexOf(e.toLowerCase())?e:this.uriScrubber.scrub(e)},e}(),Fr=["admin","adminsettings","browse","channel","channels","create","embed","error","fallback","followingchannels","group","groups","meetings","recyclebin","studio","update","upload","user","usersettings","video","videos","videoupdate","watchlist","welcome",o.b],Dr=n(157),qr=function(){function e(e){this.validHostNameRegex=new RegExp(/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])$/gm),this.validGuidRegex=/(([0-9a-fA-F]){8}-([0-9a-fA-F]){4}-([0-9a-fA-F]){4}-([0-9a-fA-F]){4}-([0-9a-fA-F]){12})/g,this.config=e}return e.prototype.scrub=function(t){var n=this,r=new Dr(t," ",(function(e){return n.parseAndCleanQueryString(e)}));if(r&&(r.hostname||r.pathname)){var i=r.protocol?r.hostname:this.truncatePathToHostname(r.pathname);if(""===r.hostname&&r.pathname&&(r.hostname=i,r.pathname=this.truncatePathname(r.pathname,i),r.host=i),!i.match(this.validHostNameRegex))return o.e;if(this.isScrubQueryParametersHostName(i)){var s=this.scrubPathname(r.pathname,r.hostname);return s&&s!==r.pathname&&r.set("pathname",s),(r.protocol?"":e.defaultProtocol+"//")+r.toString()}return this.tryKeepPartialHostName(i,r.protocol)}return o.e},e.prototype.truncatePathToHostname=function(e){var t=e.indexOf("/");return-1===t?e:e.substr(0,t)},e.prototype.truncatePathname=function(e,t){var n=e.indexOf(t);return-1===n?e:e.substr(n+t.length)},e.prototype.parseAndCleanQueryString=function(e){var t=[];if(e){"?"===e[0]&&(e=e.slice(1,e.length));for(var n=0,r=e.split("&");n<r.length;n++){var i=r[n].split("="),s=void 0,a=void 0;if(2===i.length?(s=i[0],a=i[1]):(s=i[0],a=void 0),-1===this.config.UriQueryParameters.PassThroughQueryParameters.indexOf(s.toLowerCase())){if(!(s.toLowerCase()in this.config.UriQueryParameters.ScrubQueryParameters))continue;a&&this.isRecognizedParamAcceptedValue(s,a)||(a=o.c)}a?t.push(s+"="+a):t.push(s+"=")}}return t.length>0?"?"+t.join("&"):""},e.prototype.isRecognizedParamAcceptedValue=function(e,t){var n=!1,r=this.config.UriQueryParameters.ScrubQueryParameters[e.toLowerCase()];return r&&(r.type===_r.b.number?n=!0:r.type===_r.b.stringOrAnyGuid?Mr(t)?n=!0:r.acceptedValues&&(n=-1!==r.acceptedValues.indexOf(t.toLowerCase())):r.type===_r.b.string&&r.acceptedValues&&(n=-1!==r.acceptedValues.indexOf(t.toLowerCase()))),n},e.prototype.isScrubQueryParametersHostName=function(e){if(e){e=e.toLowerCase();for(var t=0,n=this.config.ScrubQueryParametersHostNames;t<n.length;t++){var r=n[t];if(-1!==e.indexOf(r,e.length-r.length))return!0}}return!1},e.prototype.scrubPathname=function(e,t){e&&t&&(e=e.replace(this.validGuidRegex,o.b),t.endsWith("api.microsoftstream.com")||e.split("/").forEach((function(t){t&&Fr.indexOf(t)<0&&(e=e.replace(t,o.a))})));return e},e.prototype.tryKeepPartialHostName=function(t,n){var r=""!==n?n:e.defaultProtocol;if(t){t=t.toLowerCase();for(var i=0,s=this.config.ScrubToPartialHostNames;i<s.length;i++){var a=s[i];if(-1!==t.indexOf(a,t.length-a.length))return r+"//"+a}}return r+"//"+o.c},e.defaultProtocol="https:",e}(),Gr=function(){function e(e){try{jr.validate(e)}catch(e){this.initializationError=e.message,this.eventScrubber=void 0}if(!this.initializationError){Nr.format(e),this.uriScrubber=new qr(e);var t=new Vr(e,this.uriScrubber);this.eventScrubber=new Ur(e,t)}}return Object.defineProperty(e.prototype,"InitializationError",{get:function(){return this.initializationError},enumerable:!0,configurable:!0}),e.prototype.scrubUri=function(e){return this.uriScrubber?this.uriScrubber.scrub(e):void 0},e.prototype.scrubEvent=function(e){return!!this.eventScrubber&&(!(!e||e.data)||this.eventScrubber.scrub(e))},e.prototype.inDropEventList=function(e){return!this.eventScrubber||this.eventScrubber.inDropEventList(e)},e}(),Br=function(){function e(e){var t;this.logger=new Ar,this.unauthenticatedLocalUserId="a:unauthenticatedUser",this.erroringEventNamesLogged=[],e&&e.privacyScrubbingConfig&&(t=e.privacyScrubbingConfig),this.privacyScrubber=new Gr(t),this.cvPlugin=new Rr,e.localUserId||(e.localUserId=this.unauthenticatedLocalUserId);var n={channelConfiguration:{disableTelemetry:!e.ingestionKey},disableCookiesUsage:!0,extensions:[this.cvPlugin],extensionConfig:[],instrumentationKey:e.ingestionKey};if(e.overrideEndpointUrl&&(n.endpointUrl=e.overrideEndpointUrl),e.unloadListeners)for(var r in e.unloadListeners)Ot(e.unloadListeners[r])||this.logger.track({name:"UnloadListenerHookingError",data:{message:"Failed to hook unload listener",listener:r}});this.logger.initialize(n,[]);var i=e.isOnePlayer?"userAgent":"UserAgent",o=this.logger.getPropertyManager();o.getPropertiesContext().user.localId=e.localUserId,o.getPropertiesContext().app.name=e.appName,o.getPropertiesContext().app.ver=e.version,o.getPropertiesContext().session.id=e.sessionId,o.setProperty(i,window.navigator.userAgent),this.signalIncompletePrivacyConfig()}return Object.defineProperty(e.prototype,"PrivacyScrubber",{get:function(){return this.privacyScrubber.InitializationError?void 0:this.privacyScrubber},enumerable:!0,configurable:!0}),e.prototype.trackEvent=function(e){try{!this.privacyScrubber.inDropEventList(e)&&this.privacyScrubber.scrubEvent(e)&&this.logger.track(e)}catch(r){var t=void 0!==e?e.name:"undefined";if(this.hasErroringEventBeenPreviouslyLogged(t)){var n=void 0===e;this.logger.track({name:"TrackingEventError",data:{eventName:t,isEventUndefined:n}}),this.markErroringEventAsLogged(t)}}},e.prototype.userSignedIn=function(e){var t=this.logger.getPropertyManager(),n="";e.length>2&&":"!==e[1]&&(n="a:"+e),t.getPropertiesContext().user.localId=n||e},e.prototype.userSignedOut=function(){this.logger.getPropertyManager().getPropertiesContext().user.localId=this.unauthenticatedLocalUserId},e.prototype.signalIncompletePrivacyConfig=function(){var e=this.privacyScrubber.InitializationError;e&&(console.log("The privacy event scrubber was not initialized properly.\n\n ERROR: "+e),this.logger.track({name:"IncompletePrivacyScrubberConfig",data:{errorMessage:e}}))},e.prototype.markErroringEventAsLogged=function(e){this.erroringEventNamesLogged.push(e)},e.prototype.hasErroringEventBeenPreviouslyLogged=function(e){return-1===this.erroringEventNamesLogged.indexOf(e)},e}();var Hr=function(){function e(e){this.logger=e}return e.prototype.logEvent=function(e){e=Object(g.d)({name:e.name,data:e.data}),this.logger.trackEvent(e)},e}(),zr=n(403),Kr=n(404),Wr=new m;function Qr(e,t,n,r,i,o){var s,a;e?(e.unloadListeners||(e.unloadListeners={}),e.unloadListeners.logAppExited=function(){Wr.logAppExited()},a=(s=function(e){return new Br(e)}(e)).PrivacyScrubber):s=new y,a&&Wr.setupPrivacyScrubber(a),Wr.setupLogger(s,new Hr(s),t,n,r,i,o);var c={groupings:{features:[zr.a.Telemetry]},loggerConfiguration:e};Wr.appLogicThin("StreamLoggingServiceInitialized",c),Kr.a.initialize(Wr)}},412:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(411),i=n(71),o=function(){function e(e,t){this.portalConfiguration=e,this.userSessionInfo=t,this.unloadListeners={}}return e.prototype.createLoggerConfiguration=function(e,t,n,r,o,s){return void 0===s&&(s="Unknown"),this.unloadListeners=o||{},{ingestionKey:t.IngestionKey,localUserId:i.a.getLocalUserId(this.portalConfiguration,this.userSessionInfo,!!n,s),appName:e,version:n||this.portalConfiguration.BuildNumber,isOnePlayer:!!n,sessionId:r,overrideEndpointUrl:t.OverrideEndpointUrl,privacyScrubbingConfig:this.portalConfiguration.PrivacyScrubbingConfiguration,unloadListeners:this.unloadListeners}},e.prototype.addUnloadListener=function(e,t){return"logAppExited"!==e&&void 0===this.unloadListeners[e]&&(this.unloadListeners[e]=t,!0)},e}();function s(e,t,n,i,s,c,u){var l=e&&e.onePlayer&&e.onePlayer.hostContext?e.onePlayer.hostContext.hostApp:"Microsoft.Stream",d=e&&e.onePlayer?e.onePlayer.commonContext.accountType:"Unknown",h=new o(t,n).createLoggerConfiguration(l,t.StreamWebAriaConfiguration||function(e){return{IngestionKey:"https://*.stream.azure-test.net"===e.AadResourceId?"6f8c6bf216934a758f8e6f8f52ef910c-6f09ec66-cf1d-4645-826e-81898c341372-7581":"208caf6a38a844be84e1d2fc006f4194-da66fd33-4ceb-4c4a-a6e8-ad0bade87897-7914",OverrideEndpointUrl:""}}(t),i,s,u,d),f=0,g=3;!1===("use22"===t.ClusterName||"uswc1"===t.ClusterName||"srol1"===t.ClusterName||"refe1"===t.ClusterName)&&(f=3,g=2),Object(r.b)(h,e,a,g,f,c)}var a=function(e){var t=window;if(t.OfficeBrowserFeedback&&t.OfficeBrowserFeedback.floodgate){var n=t.OfficeBrowserFeedback.floodgate.getEngine();if(n){var r=n.getActivityListener();r.logActivity(e),r.logActivity(e+"Embed")}}}},413:function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=function(){"use strict";return i=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},i.prototype._singletonInstance)return i.prototype._singletonInstance;if(i.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),i.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)}},i.prototype._openPopup=function(e,t,n,r){try{var i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=s/2-n/2+i,u=a/2-r/2+o,l=window.open(e,t,"width="+n+", height="+r+", top="+u+", left="+c);return l.focus&&l.focus(),l}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},i.prototype._handlePopupError=function(e,t,n,r,i){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,i),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},i.prototype._loginPopup=function(e,t,n){var r=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),i=n||this.callback;if(null!=r){if(this._openedWindows.push(r),-1!=this.config.redirectUri.indexOf("#"))var o=this.config.redirectUri.split("#")[0];else o=this.config.redirectUri;var s=this,a=window.setInterval((function(){if(!r||r.closed||void 0===r.closed){var e="Popup Window closed",n="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return s.isAngular&&s._broadcast("adal:popUpClosed",n+s.CONSTANTS.RESOURCE_DELIMETER+e),s._handlePopupError(i,t,e,n,n),void window.clearInterval(a)}try{var c=r.location;if(-1!=encodeURI(c.href).indexOf(encodeURI(o)))return s.isAngular?s._broadcast("adal:popUpHashChanged",c.hash):s.handleWindowCallback(c.hash),window.clearInterval(a),s._loginInProgress=!1,s._acquireTokenInProgress=!1,s.info("Closing popup window"),s._openedWindows=[],void r.close()}catch(e){}}),1)}else{var c="Popup Window is null. This can happen if you are using IE";this._handlePopupError(i,t,"Error opening popup",c,c)}},i.prototype._broadcast=function(e,t){!function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}();var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},i.prototype.loginInProgress=function(){return this._loginInProgress},i.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},i.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},i.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},i.prototype.registerCallback=function(e,t,n){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var r=this;this._callBacksMappedToRenewStates[e].push(n),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(n,i,o,s){r._activeRenewals[t]=null;for(var a=0;a<r._callBacksMappedToRenewStates[e].length;++a)try{r._callBacksMappedToRenewStates[e][a](n,i,o,s)}catch(o){r.warn(o)}r._callBacksMappedToRenewStates[e]=null,r._callBackMappedToRenewStates[e]=null})},i.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var r=this._addAdalFrame("adalRenewFrame"+e),i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this.verbose("Renew token Expected state: "+i),n=n||"token";var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o+="&prompt=none",o=this._addHintParameters(o),this.registerCallback(i,e,t),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+e,e)},i.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var i=null==t?null:this.config.clientId,o=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,i),"prompt"));o+="&prompt=none",o=this._addHintParameters(o),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii("Navigate to:"+o),n.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},i.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},i.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e=e.replace(n,"")},i.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout((function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n);var e=r._activeRenewals[n];e&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}}),r.CONSTANTS.LOADFRAME_TIMEOUT)},i.prototype._loadFrame=function(e,t){var n=this;n.info("LoadFrame: "+t);var r=t;setTimeout((function(){var t=n._addAdalFrame(r);""!==t.src&&"about:blank"!==t.src||(t.src=e,n._loadFrame(e,r))}),500)},i.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},i.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(i,e,r),this._loginPopup(o,e,r)},i.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,i,!0),this.promptUser(o)},i.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},i.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},i.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},i.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",n="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+n}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},i.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},i.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},i.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},i.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},i.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},i.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},i.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},i.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(n.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){n.valid=!0;var r="";if(!t.hasOwnProperty("state"))return this.warn("No state returned"),n;if(this.verbose("State: "+t.state),r=t.state,n.stateResponse=r,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var i=this._renewStates,o=0;o<i.length;o++)if(i[o]===n.stateResponse){n.stateMatch=!0;break}}}return n},i.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.profile.nonce)return!0}return!1},i.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r){r=r.split(this.CONSTANTS.CACHE_DELIMETER);for(n=0;n<r.length;n++)if(r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},i.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},i.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t,n=this._getResourceFromState(e.stateResponse);e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description))):e.stateMatch?(this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),n=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))):(e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse));this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},i.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(e.indexOf(n)>-1)return this.config.endpoints[n];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},i.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},i.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,i,o=t.getRequestInfo(e),s=null;i=n||window.parent!==window?t._callBackMappedToRenewStates[o.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(o),o.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),r=o.parameters[t.CONSTANTS.ACCESS_TOKEN]||o.parameters[t.CONSTANTS.ID_TOKEN],s=t.CONSTANTS.ACCESS_TOKEN):o.requestType===this.REQUEST_TYPE.LOGIN&&(r=o.parameters[t.CONSTANTS.ID_TOKEN],s=t.CONSTANTS.ID_TOKEN);var a=o.parameters[t.CONSTANTS.ERROR_DESCRIPTION],c=o.parameters[t.CONSTANTS.ERROR];try{i&&i(a,r,c,s)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},i.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+r),r},i.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this._base64DecodeStringUrlSafe(n);return r?JSON.parse(r):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},i.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},i.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,i,o,s,a,c,u,l,d="",h=0;h<n;h+=4){if(r=t.indexOf(e.charAt(h)),i=t.indexOf(e.charAt(h+1)),o=t.indexOf(e.charAt(h+2)),s=t.indexOf(e.charAt(h+3)),h+2===n-1){c=(a=r<<18|i<<12|o<<6)>>16&255,u=a>>8&255,d+=String.fromCharCode(c,u);break}if(h+1===n-1){c=(a=r<<18|i<<12)>>16&255,d+=String.fromCharCode(c);break}c=(a=r<<18|i<<12|o<<6|s)>>16&255,u=a>>8&255,l=255&a,d+=String.fromCharCode(c,u,l)}return d},i.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},i.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},i.prototype._serialize=function(e,t,n){var r=[];if(null!==t){r.push("?response_type="+e),r.push("client_id="+encodeURIComponent(t.clientId)),n&&r.push("resource="+encodeURIComponent(n)),r.push("redirect_uri="+encodeURIComponent(t.redirectUri)),r.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&r.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&r.push(t.extraQueryParameter);var i=t.correlationId?t.correlationId:this._guid();r.push("client-request-id="+encodeURIComponent(i))}return r.join("&")},i.prototype._deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},o={};for(t=r.exec(e);t;)o[i(t[1])]=i(t[2]),t=r.exec(e);return o},i.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},i.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",i=0,o="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?o+=r[i]:"y"===n[s]?(i&=3,o+=r[i|=8]):o+=n[s];return o},i.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},i.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},i.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},i.prototype._saveItem=function(e,t,n){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(n){var r=this._getItem(e)||"";localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},i.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},i.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},i.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},i.prototype._cloneConfig=function(e){if(null===e||"object"!==r(e))return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},i.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},i.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var i=(new Date).toUTCString(),o="";o=this.config.correlationId?i+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:i+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,n&&(o+="\nstack:\n"+n.stack),Logging.log(o)}},i.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},i.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},i.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},i.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},i.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},i.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},i.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},i.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},i.prototype._libVersion=function(){return"1.0.17"},e.exports&&(e.exports=i,e.exports.inject=function(e){return new i(e)}),i}()},459:function(e,t,n){"use strict";var r=n(354),i=n(461),o=n(462),s=n(355),a=r.sum32,c=r.sum32_4,u=r.sum32_5,l=o.ch32,d=o.maj32,h=o.s0_256,f=o.s1_256,g=o.g0_256,p=o.g1_256,v=i.BlockHash,m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y(){if(!(this instanceof y))return new y;v.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=m,this.W=new Array(64)}r.inherits(y,v),e.exports=y,y.blockSize=512,y.outSize=256,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=c(p(n[r-2]),n[r-7],g(n[r-15]),n[r-16]);var i=this.h[0],o=this.h[1],v=this.h[2],m=this.h[3],y=this.h[4],S=this.h[5],b=this.h[6],T=this.h[7];for(s(this.k.length===n.length),r=0;r<n.length;r++){var w=u(T,f(y),l(y,S,b),this.k[r],n[r]),E=a(h(i),d(i,o,v));T=b,b=S,S=y,y=a(m,w),m=v,v=o,o=i,i=a(w,E)}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],o),this.h[2]=a(this.h[2],v),this.h[3]=a(this.h[3],m),this.h[4]=a(this.h[4],y),this.h[5]=a(this.h[5],S),this.h[6]=a(this.h[6],b),this.h[7]=a(this.h[7],T)},y.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},46:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return a}));var r="'Segoe UI', 'Stream Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif",i="'Segoe UI Light', 'Stream Segoe UI Light', 'Helvetica Neue', Helvetica, Arial, sans-serif",o="'Segoe UI Semilight', 'Stream Segoe UI Semilight', 'Helvetica Neue', Helvetica, Arial, sans-serif",s="'Segoe UI Bold', 'Stream Segoe UI Bold', 'Helvetica Neue', Helvetica, Arial, sans-serif",a="'Segoe UI Semibold', 'Stream Segoe UI Semibold', 'Helvetica Neue', Helvetica, Arial, sans-serif"},460:function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},461:function(e,t,n){"use strict";var r=n(354),i=n(355);function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=o,o.prototype.update=function(e,t){if(e=r.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=r.join32(e,0,e.length-n,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},o.prototype.digest=function(e){return this.update(this._pad()),i(null===this.pending),this._digest(e)},o.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)r[i++]=0;r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=e>>>24&255,r[i++]=e>>>16&255,r[i++]=e>>>8&255,r[i++]=255&e}else for(r[i++]=255&e,r[i++]=e>>>8&255,r[i++]=e>>>16&255,r[i++]=e>>>24&255,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,o=8;o<this.padLength;o++)r[i++]=0;return r}},462:function(e,t,n){"use strict";var r=n(354).rotr32;function i(e,t,n){return e&t^~e&n}function o(e,t,n){return e&t^e&n^t&n}function s(e,t,n){return e^t^n}t.ft_1=function(e,t,n,r){return 0===e?i(t,n,r):1===e||3===e?s(t,n,r):2===e?o(t,n,r):void 0},t.ch32=i,t.maj32=o,t.p32=s,t.s0_256=function(e){return r(e,2)^r(e,13)^r(e,22)},t.s1_256=function(e){return r(e,6)^r(e,11)^r(e,25)},t.g0_256=function(e){return r(e,7)^r(e,18)^e>>>3},t.g1_256=function(e){return r(e,17)^r(e,19)^e>>>10}},463:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(412),o=n(47),s=n(129),a=n(474),c=!1,u=!1,l=!1,d=!1,h=!1,f=!1;var g,p=n(12);function v(e,t){if(!e)return"Unauthenticated";if(!t)return"Regular";try{var n=JSON.parse(t);return n&&n.permissions&&n.permissions.canManageRoleAssignments?"Admin":"Regular"}catch(e){return"Regular"}}!function(e){e.Admin="Admin",e.Regular="Regular",e.Unauthenticated="Unauthenticated"}(g||(g={}));var m=n(466),y=n(7),S=n(130),b=function(){function e(e){this.loggingService=e,this.initializedConnectionToParent=!1}return e.prototype.connectWithParent=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.e)(this,(function(t){return this.connectToParentPromise||this.initializedConnectionToParent?!this.initializedConnectionToParent&&this.connectToParentPromise?[2,this.connectToParentPromise]:[2,Promise.resolve()]:(this.connectToParentPromise=new Promise((function(t,n){var r=e.loggingService.startUniquePerformance("ConnectToParent");e.initialize({},(function(){e.connectToParentPromise=void 0,e.initializedConnectionToParent=!0,window.PostMessageConnectedToParent=!0;var n={name:"ConnectToParent",success:!0};e.loggingService.endPerformance(r,n),t()}),(function(t){var i={name:"ConnectToParent",success:!1};e.loggingService.endPerformance(r,i),e.connectToParentPromise=void 0,e.initializedConnectionToParent=!0,e.loggingService.warnThin("ConnectToParentFailed",{message:t,stack:(new Error).stack||y.c.Missing,errorCode:S.a.PreConditionFailed,staticMessage:"Post message connection to host failed"}),n()})),e.loggingService.appLogicThin("ConnectToParentRequested",{})})),[2,this.connectToParentPromise])}))}))},e.prototype.sendMessageToParent=function(e,t,n,r,i){MicrosoftStream?MicrosoftStream.sendMessageToParent(e,t,n,r,i):r&&r("Post messaging sdk not found")},e.prototype.addChildMessageHandler=function(e,t,n){if(!MicrosoftStream)throw new Error("Post messaging sdk not found");MicrosoftStream.addChildMessageHandler(e,t,n)},e.prototype.addHostMessageHandlers=function(e,t){if(!MicrosoftStream)throw new Error("Post messaging sdk not found");MicrosoftStream.addHostMessageHandlers(e,t)},e.prototype.nativeJavacriptBridge=function(e){if(!MicrosoftStream)throw new Error("Post messaging sdk not found");MicrosoftStream.nativeJavacriptBridge(e)},e.prototype.initialize=function(e,t,n){MicrosoftStream?MicrosoftStream.initialize(e,t,n):n&&n("Post messaging sdk not found")},e}(),T=n(408),w=n(403),E=n(469),C=n(17),O=n(468),I="/principals/:id",x="settings",A="permissions",k="servicePlans",P="PrincipalSettings",R="PrincipalServicePlans",_=90,N=E.a.object({backgroundOpacity:E.a.optional(E.a.string),fontPercent:E.a.optional(E.a.string),showTextTrack:E.a.optional(E.a.boolean),textColorValue:E.a.optional(E.a.string),preferredLanguage:E.a.optional(E.a.string)}),j=E.a.object({volume:E.a.optional(E.a.number),playbackRate:E.a.optional(E.a.number),textTrackSettings:E.a.optional(N)}),L=E.a.object({general:E.a.optional(E.a.object({showInviteOthers:E.a.optional(E.a.boolean),showGettingStarted:E.a.optional(E.a.boolean),showBgUploadNotice:E.a.optional(E.a.boolean),showVideoLanguageNote:E.a.optional(E.a.boolean),hideTrialSplash:E.a.optional(E.a.boolean),defaultVideoLanguage:E.a.optional(E.a.string),hideDefaultVideoLanguageDialog:E.a.optional(E.a.boolean),showHowToVideos:E.a.optional(E.a.boolean),hideTrialSuspensionWarning:E.a.optional(E.a.boolean),hideTrialSuspensionNotice:E.a.optional(E.a.boolean),hideMobileAnnouncementBanner:E.a.optional(E.a.boolean),showFirstTimeExperienceInVideoEditor:E.a.optional(E.a.boolean),lastNoiseSuppressionSurveyInteractionTimestamp:E.a.optional(E.a.number)})),web:E.a.optional(E.a.object({disableTelemetry:E.a.optional(E.a.boolean),playbackSettings:E.a.optional(j)})),mobile:E.a.optional(E.a.object({})),system:E.a.optional(E.a.object({contentManagement:E.a.optional(E.a.object({companyUploadPolicy:E.a.optional(E.a.object({acknowledged:E.a.optional(E.a.boolean)}))})),notifications:E.a.optional(E.a.object({email:E.a.optional(E.a.object({enabled:E.a.optional(E.a.boolean)}))})),locale:E.a.optional(E.a.object({language:E.a.optional(E.a.union(E.a.string,E.a.null)),region:E.a.optional(E.a.union(E.a.string,E.a.null))}))}))}),M=E.a.object({id:E.a.string,name:E.a.string,trialStartDate:E.a.optional(E.a.string),trialSuspensionDate:E.a.optional(E.a.string),trialTerminationDate:E.a.optional(E.a.string)}),U=E.a.object({id:E.a.string,assignedPlans:E.a.array(M),capabilities:E.a.object({createVideo:E.a.boolean,updateVideo:E.a.boolean,deleteVideo:E.a.boolean,createChannel:E.a.boolean,updateChannel:E.a.boolean,deleteChannel:E.a.boolean,createGroup:E.a.boolean,updateGroup:E.a.boolean,deleteGroup:E.a.boolean,transcriptSearch:E.a.boolean,transcriptEvent:E.a.boolean,faceEvent:E.a.boolean,viewForm:E.a.boolean,manageForm:E.a.boolean})});function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var F,D,q=function(){function e(e,t,n,r){void 0===r&&(r=!0),this.loggingService=e,this.groupings=t,this.telemetryViewContext=n,this.cachingEnabled=r,C.enableWarnings(!0),C.flushExpired()}return e.prototype.getPrincipalInfo=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,s,a,c;return Object(r.e)(this,(function(r){switch(r.label){case 0:return(t=e.uniqueId)?(n={id:t,apiVersion:e.apiGatewayVersion,$expand:x+","+A+","+k},i=E.a.object({}),o=e.apiGatewayUrl,s=I,[4,O.a.get(w.a.Principal+".getPrincipalInfo",this.groupings,o,s,n,e.generateHeaders(),i)]):("userSession does not contain uniqueId",this.logWarning("userSession does not contain uniqueId"),[2,Promise.reject(new Error("userSession does not contain uniqueId"))]);case 1:return a=r.sent(),c=a,this.cachingEnabled&&(C.setBucket(e.hashedId),c.settings&&C.set(P,c.settings,_),c.servicePlans&&C.set(R,c.servicePlans,_)),[2,c]}}))}))},e.prototype.getPrincipalSettings=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(this.cachingEnabled&&(t=this.checkCache(e,L,P)))return[2,t];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getPrincipalInfo(e)];case 2:return[2,r.sent().settings];case 3:return n=r.sent(),this.logWarningForException(n),[2,Promise.reject(n)];case 4:return[2]}}))}))},e.prototype.getPrincipalServicePlans=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(this.cachingEnabled&&(t=this.checkCache(e,U,R)))return[2,t];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getPrincipalInfo(e)];case 2:return[2,r.sent().servicePlans];case 3:return n=r.sent(),this.logWarningForException(n),[2,void 0];case 4:return[2]}}))}))},e.prototype.patchMySettings=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,a;return Object(r.e)(this,(function(r){switch(r.label){case 0:return this.cachingEnabled&&(n=this.checkCache(e,L,P))&&!this.haveAnyPrincipalSettingsChanged(n,t)?[2,n]:(i={id:e.uniqueId,apiVersion:e.apiGatewayVersion},o=I+"/"+x,s=E.a.object({}),[4,O.a.patch(w.a.Principal+".patchMySettings",this.groupings,e.apiGatewayUrl,o,i,t,e.generateHeaders(),s)]);case 1:return a=r.sent(),this.cachingEnabled&&(C.setBucket(e.hashedId),C.set(P,a,_)),[2,a]}}))}))},e.prototype.haveAnyPrincipalSettingsChanged=function(e,t){for(var n in t)if("object"===V(t[n])){if(this.haveAnyPrincipalSettingsChanged(e[n],t[n]))return!0}else if(!e||e[n]!==t[n])return!0;return!1},e.prototype.checkCache=function(e,t,n){var r=null;C.setBucket(e.hashedId);var i=C.get(n);return i&&(Object(E.b)(i,t)?r=i:this.logWarning("Cached data failed validation check")),r},e.prototype.logWarningForException=function(e,t){var n={groupings:this.groupings,viewContext:this.telemetryViewContext,message:e instanceof Error&&void 0!==e.message?e.message:y.b.Missing,stack:e instanceof Error&&void 0!==e.stack?e.stack:(new Error).stack||y.c.Missing,staticMessage:t};this.loggingService.warnThin("PrincipalServiceError",n)},e.prototype.logWarning=function(e){var t={groupings:this.groupings,viewContext:this.telemetryViewContext,message:y.b.Missing,stack:(new Error).stack||y.c.Missing,staticMessage:e};this.loggingService.warnThin("PrincipalServiceError",t)},e}(),G=n(11),B=n(404),H=n(48),z=n(357),K="/tenants/:id",W="settings",Q="region",$="TenantSettings",J=720,Y="TenantPatch",X=720;!function(e){e[e.TooManyRequests=429]="TooManyRequests",e[e.ServiceUnavailable=503]="ServiceUnavailable"}(F||(F={})),function(e){e[e.Success=0]="Success",e[e.ThrottleFailed=1]="ThrottleFailed",e[e.Throttled=2]="Throttled"}(D||(D={}));var Z={features:[w.a.Tenant]},ee=function(){function e(e,t){this.tenantServiceUrl=e,this.tenantServiceApiVersion=t,this.tenantPatchThrottleFailed=!1,C.enableWarnings(!0),C.flushExpired()}return e.prototype.getApiVersion=function(){return this.tenantServiceApiVersion},e.prototype.hasTenantPatchThrottleFailed=function(){return this.tenantPatchThrottleFailed},e.prototype.getSettings=function(e,t){return void 0===t&&(t=!1),Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,a,c;return Object(r.e)(this,(function(r){switch(r.label){case 0:return n=null,t||(C.setBucket(e.hashedId),i=C.get($),Object(E.b)(i,E.a.object({}))&&(n=i)),n?[3,2]:(o={id:e.tenantId,apiVersion:this.tenantServiceApiVersion},s=e.apiGatewayUrl,a=K+"/"+W,[4,O.a.getWithCorsSupport(w.a.Tenant+".getSettings",Z,s,a,o,e.generateHeaders(),E.a.object({}))]);case 1:c=r.sent(),t||C.set($,c,J),n=c,r.label=2;case 2:return[2,n]}}))}))},e.prototype.getTenantEnvironmentType=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i;return Object(r.e)(this,(function(r){switch(r.label){case 0:return t={id:e.tenantId,apiVersion:this.tenantServiceApiVersion},n=e.apiGatewayUrl,i=K+"/"+Q,[4,O.a.getWithCorsSupport(w.a.Tenant+".getTenantEnvironmentType",Z,n,i,t,e.generateHeaders(),E.a.object({}))];case 1:return[2,r.sent()]}}))}))},e.prototype.patchTenant=function(e,t,n){return void 0===n&&(n=!1),Object(r.b)(this,void 0,void 0,(function(){var i,o,s,a,c,u,l,d,h,f,g,p;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(i=E.a.object({apiEndpoint:E.a.string,dataLocation:E.a.string,id:E.a.string,notificationEndpoint:E.a.string,region:E.a.string,state:E.a.string}),this.tenantPatchThrottleFailed=!1,o=null,n||(C.setBucket(e.hashedId),s=C.get(Y),Object(E.b)(s,i)&&(o=s)),o&&o.apiEndpoint)return[3,8];a={id:e.tenantId,apiVersion:this.tenantServiceApiVersion},c=this.tenantServiceUrl,u="api"+K,l=null,d=0,h=!1,r.label=1;case 1:if(h||!(d<10))return[3,7];r.label=2;case 2:return r.trys.push([2,4,,6]),[4,O.a.patch(w.a.Tenant+".patchTenant",Z,c,u,a,{},e.generateHeaders(),i)];case 3:if(l=r.sent(),!(o=l).apiEndpoint)throw f=w.a.Tenant+".patchTenant. Returned an empty ApiEndpoint",B.a.logError({method:"PATCH",staticMessage:f,url:Object(z.a)(c,u,a)}),new Error(Object(H.c)(f));return h=!0,[3,6];case 4:return(g=r.sent()).status!==F.TooManyRequests&&g.status!==F.ServiceUnavailable?[2,Promise.reject(g)]:(1===++d&&t&&t(D.Throttled),p=void 0,g.headers&&(p=g.headers.get("retry-after")),p||(p=15),[4,te(1e3*p)]);case 5:return r.sent(),[3,6];case 6:return[3,1];case 7:if(!h)return B.a.logError({method:"PATCH",staticMessage:w.a.Tenant+".patchTenant. Exceeded maximum number of retries",url:Object(z.a)(c,u,a)}),this.tenantPatchThrottleFailed=!0,t&&t(D.ThrottleFailed),[2,Promise.reject("Maximum number of retries exceeded")];n||C.set(Y,o,X),r.label=8;case 8:return t&&t(D.Success),[2,o]}}))}))},e.prototype.getSdnSettingsIfSupported=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getSettings(e)];case 1:return(t=n.sent())&&t.system&&t.system.networkCaching&&t.system.networkCaching.provider&&t.system.networkCaching.licenseId?[2,t.system.networkCaching]:[2,void 0];case 2:return n.sent(),[2,void 0];case 3:return[2]}}))}))},e}(),te=function(e){return new Promise((function(t){return setTimeout(t,e)}))},ne=n(40);function re(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}var ie,oe=n(68),se=n(405),ae=n(409),ce=n(96),ue=n(54),le=n(407),de=n(56),he=n(97),fe=n(202),ge=n(413),pe=n.n(ge),ve=n(127),me=function(){function e(e){this.options=e}return e.prototype.setIsInitialAuth=function(e){this.isInitialAuth=e},e.prototype.setFoundCachedAccessToken=function(e){this.foundCachedAccessToken=e},e.prototype.setFoundCachedIdentityToken=function(e){this.foundCachedIdentityToken=e},e.prototype.setAcquireIdentityTokenResult=function(e){this.acquireIdentityTokenResult=e},e.prototype.setAcquireAccessTokenResult=function(e){this.acquireAccessTokenResult=e},e.prototype.createPayloadForSSO=function(){return Object(r.a)(Object(r.a)(Object(r.a)({name:"AdalSilentSSO",foundCachedIdentityToken:this.foundCachedIdentityToken,foundCachedAccessToken:this.foundCachedAccessToken},this.createCommon()),this.createIdentity()),this.createAccess())},e.prototype.createPayloadForAcquireIdentity=function(){return Object(r.a)(Object(r.a)({name:"AdalAcquireIdentityToken"},this.createCommon()),this.createIdentity())},e.prototype.createPayloadForAcquireAccess=function(){return Object(r.a)(Object(r.a)({name:"AdalAcquireAccessToken"},this.createCommon()),this.createAccess())},e.prototype.createCommon=function(){return{isInitialAuth:this.isInitialAuth,popUp:this.options.popUp,expireOffsetSeconds:this.options.expireOffsetSeconds,loadFrameTimeout:this.options.loadFrameTimeout}},e.prototype.createIdentity=function(){return void 0===this.acquireIdentityTokenResult?{}:{acquireIdentityTokenSuccess:void 0===this.acquireIdentityTokenResult.error,acquireIdentityTokenError:this.acquireIdentityTokenResult.adalErrorCode}},e.prototype.createAccess=function(){return void 0===this.acquireAccessTokenResult?{}:{acquireAccessTokenSuccess:void 0===this.acquireAccessTokenResult.error,acquireAccessTokenError:this.acquireAccessTokenResult.adalErrorCode}},e}(),ye=function(){function e(e){this.options=e}return e.prototype.setOptions=function(e){this.options=e},e.prototype.startSilentSSO=function(){return new me(this.options)},e}(),Se=function(e,t,n,i,o){var s=this;if(void 0===n&&(n=!1),this.aadConfig=e,this.loggingService=t,this.portalLogin=n,this.tenantId=i,this.loginHint=o,this.tryAuthenticate=function(e){return Object(r.b)(s,void 0,void 0,(function(){var t,n,i,o,s,a,c,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:this.loggingService.debug("tryAuthenticate"),t=this.loggingService.startUniquePerformance("AdalSilentSSO"),(n=this.telemetryPayloadFactory.startSilentSSO()).setIsInitialAuth(e),r.label=1;case 1:if(r.trys.push([1,,6,7]),!this.tenantId&&!this.loginHint){if(i=this.adalAuthContext.getCachedToken(this.aadConfig.resourceId),n.setFoundCachedAccessToken(!!i),i)return[2,this.formatToken(i)];this.loggingService.debug("no cached token")}return(o=this.adalAuthContext.getCachedUser())&&this.isCachedUserValid(o,this.tenantId,this.loginHint)?(n.setFoundCachedIdentityToken(!0),[3,4]):[3,2];case 2:return n.setFoundCachedIdentityToken(!1),this.adalAuthContext.clearCache(),s=this.loggingService.startUniquePerformance("AdalAcquireIdentityToken"),[4,this.acquireIdentityToken()];case 3:if(a=r.sent(),n.setAcquireIdentityTokenResult(a),this.loggingService.endPerformance(s,n.createPayloadForAcquireIdentity()),void 0!==a.error)return[2,a];r.label=4;case 4:return c=this.loggingService.startUniquePerformance("AdalAcquireAccessToken"),[4,this.acquireAccessToken()];case 5:return u=r.sent(),n.setAcquireAccessTokenResult(u),this.loggingService.endPerformance(c,n.createPayloadForAcquireAccess()),[2,u];case 6:return this.loggingService.endPerformance(t,n.createPayloadForSSO()),[7];case 7:return[2]}}))}))},this.tryGetAuthTokenFromCache=function(){s.loggingService.debug("tryGetAuthTokenFromCache");var e=s.adalAuthContext.getCachedToken(s.aadConfig.resourceId);return e?s.formatToken(e):{token:ve.a}},this.performLogin=function(){s.adalAuthContext.login()},this.formatToken=function(e){var t=s.adalAuthContext.CONSTANTS.STORAGE.EXPIRATION_KEY+s.aadConfig.resourceId,n=s.adalAuthContext._getItem(t),r={token:e,expiry:new Date(1e3*n)},i=s.adalAuthContext.getCachedUser();return{token:r,user:{tenantId:i?i.profile.tid:"",uniqueId:i?i.profile.oid:""}}},this.onUserLoggedIn=function(e,t,n){if(s.loggingService.debug("callback called"),t){s.loggingService.debug("received identity token: "+t);var r=s.adalAuthContext.getCachedUser();r?(s.loggingService.debug("user found: "+r),s.acquireAccessToken()):s.loggingService.debug("user login failed, cannot find user info")}n&&s.loggingService.debug("callback error: "+n)},this.verboseAdalLog=function(e,t,n,r){t&&s.loggingService.debug("ADAL message: "+t),n&&s.loggingService.debug("ADAL error: "+n)},this.silentSignIn=function(){return s.loggingService.debug("start silentSignIn"),new Promise((function(e){s.adalAuthContext._renewIdToken((function(t,n,r){t?(s.loggingService.debug("silentSignIn failed: ["+(null===r?"no code":r)+"] "+(null===t?"no description":t)),e(s.getAdalErrorCode(r,t))):(s.loggingService.debug("silentSignIn succeeded"),s.adalAuthContext._createUser(n),e(null))}))}))},this.acquireIdentityToken=function(){return Object(r.b)(s,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(t){switch(t.label){case 0:return this.loggingService.debug("no cached user - try silent sign in"),[4,this.silentSignIn()];case 1:if(e=t.sent(),!this.adalAuthContext.getCachedUser()){if(this.loggingService.debug("no cached user - interaction required"),!this.portalLogin)return[2,{error:"UserInteractionRequired",adalErrorCode:e||void 0}];this.adalAuthContext.login()}return[2,{}]}}))}))},this.acquireAccessToken=function(){return s.loggingService.debug("acquireAccessToken"),new Promise((function(e){s.adalAuthContext.acquireToken(s.aadConfig.resourceId,(function(t,n,r){var i;n?(s.loggingService.debug("token acquired: "+n),e(s.formatToken(n))):(s.loggingService.debug("no token acquired: ["+(null===r?"no code":r)+"] "+(null===t?"no description":t)),e({error:(i=r,i&&i.length&&(i.indexOf("consent_required")>-1||i.indexOf("interaction_required")>-1||i.indexOf("login_required")>-1)?"UserInteractionRequired":"Failed"),adalErrorCode:s.getAdalErrorCode(r,t)||void 0}))}))}))},this.isCachedUserValid=function(e,t,n){return!(t&&e.profile.tid!==t||n&&e.userName.toLowerCase()!==n.toLowerCase())},this.getAdalErrorCode=function(e,t){return t&&"Token renewal operation failed due to timeout"===t?t:e},"/"!==e.instance.slice(-1))throw new Error(Object(H.c)("AadConfig: aadInstance must end with slash! ["+e.instance+"]"));if("/"===e.resourceId.slice(-1))throw new Error(Object(H.c)("AadConfig: resourceId cannot end with slash! ["+e.resourceId+"]"));var a={instance:e.instance,clientId:e.clientId,expireOffsetSeconds:e.expireOffsetSeconds,redirectUri:e.redirectUri,callback:this.onUserLoggedIn,popUp:Object(oe.e)(),loadFrameTimeout:12e4,cacheLocation:Object(oe.i)()?"localStorage":"sessionStorage",tenant:i,extraQueryParameter:o?"login_hint="+o:void 0,correlationId:e.correlationId};this.telemetryPayloadFactory=new ye(a),this.adalAuthContext=new pe.a(a),this.adalAuthContext.log=this.verboseAdalLog};!function(e){e.ConnectionFailed="Post message connection to host failed",e.GatewayTokenFailed="Getting API gateway token failed",e.GatewayTokenSkipped="Skipping getting API gateway token because host is not Teams and we are not connected to host",e.HostAuthTokenFailed="Host unable to provide token for Stream",e.ExchangeTokenFailed="Stream exchange token for service using webrole failed",e.NullOrEmptyToken="Auth token was null or empty",e.NoTenantId="No tenant ID present on the user claim from the server token",e.NoUserId="No user ID present on the user information from the server token"}(ie||(ie={}));var be,Te={features:[w.a.InjectedAuth]},we=function(){function e(e,t,n){this.ClientAppId=e,this.postMessagingService=t,this.loggingService=n}return e.prototype.getAuthResult=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.getApiGatewayTokenInternal(e,t,n)];case 1:return i=r.sent(),o={token:i.AccessToken,expiry:new Date(i.AccessTokenExpiry)},s={token:o},[2,Promise.resolve(s)]}}))}))},e.prototype.getApiGatewayToken=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,s,a,c,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(!window.isTokenSSO_Teams&&!window.PostMessageConnectedToParent)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getApiGatewayTokenInternal("/ExchangeToken","ExchangeToken",e)];case 2:t=r.sent(),n={token:t.AccessToken,expiry:new Date(t.AccessTokenExpiry)},i="";try{i=t.UserClaim.TenantId}catch(e){c={message:e instanceof Error&&void 0!==e.message?e.message:y.b.Missing,stack:e instanceof Error&&void 0!==e.stack?e.stack:(new Error).stack||y.c.Missing,staticMessage:ie.NoTenantId,errorDetails:e},this.loggingService.warnThin("InjectedAuthError",c)}o="";try{o=t.UserClaim.UserInfo.UniqueId}catch(e){c={message:e instanceof Error&&void 0!==e.message?e.message:y.b.Missing,stack:e instanceof Error&&void 0!==e.stack?e.stack:(new Error).stack||y.c.Missing,staticMessage:ie.NoUserId,errorDetails:e},this.loggingService.warnThin("InjectedAuthError",c)}return s={token:n,user:{tenantId:i,uniqueId:o}},[2,Promise.resolve(s)];case 3:return a=r.sent(),c={message:a instanceof Error&&void 0!==a.message?a.message:y.b.Missing,stack:a instanceof Error&&void 0!==a.stack?a.stack:(new Error).stack||y.c.Missing,staticMessage:ie.GatewayTokenFailed,errorDetails:a},this.loggingService.warnThin("InjectedAuthError",c),u={error:"Failed"},[2,Promise.resolve(u)];case 4:return[3,6];case 5:return c={message:"",stack:(new Error).stack||y.c.Missing,staticMessage:ie.GatewayTokenSkipped},this.loggingService.warnThin("InjectedAuthError",c),u={},[2,Promise.resolve(u)];case 6:return[2]}}))}))},e.prototype.signInFailed=function(e,t){this.postMessagingService.sendMessageToParent(m.b.signInEvent,{eventname:m.a.signInFailed,message:e.reason,errorcode:e.errorcode,customerrormessage:e.customReasonText})},e.prototype.getApiGatewayTokenInternal=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.getHostAuthToken(t,n)];case 1:return i=r.sent(),[4,this.swapAuthToken(i,e,t,n)];case 2:return o=r.sent(),[2,Promise.resolve(o)]}}))}))},e.prototype.getHostAuthToken=function(e,t){var n=this;return new Promise((function(r,i){var o=n.loggingService.startUniquePerformance("GetHostAuthToken"),s=function(r){var s=r.reason,a={name:"GetHostAuthToken",feature:e,isInitialAuth:t,success:!1};n.loggingService.endPerformance(o,a);var c={message:s instanceof Error&&void 0!==s.message?s.message:y.b.Missing,stack:s instanceof Error&&void 0!==s.stack?s.stack:(new Error).stack||y.c.Missing,staticMessage:ie.HostAuthTokenFailed,feature:e,errorDetails:s};window.sessionInfo.AccessToken?n.loggingService.warnThin("GetHostAuthTokenError",c):n.loggingService.fatalThin("GetHostAuthTokenError",c),n.signInFailed({reason:s,errorcode:S.a.PreConditionFailed,customReasonText:ie.HostAuthTokenFailed},e),i(r.reason)},a=function(i,a){var c=i&&i.token?i.token:a?a[0]:null;c?(n.loggingService.endPerformance(o,n.payloadForGetHostAuthTokenPerformance(e,t,!0)),r(c)):s({reason:"Token was not passed correctly from parent, it was either null or empty"})};try{window.isTokenSSO_Teams?(window.microsoftTeams.authentication.getAuthToken({resources:[n.ClientAppId],successCallback:function(e){a({token:e},null)},failureCallback:function(e){s({reason:e})}}),n.loggingService.appLogicThin("GetHostAuthTokenRequestedToTeamsSDK",{})):window.PostMessageConnectedToParent?(n.postMessagingService.sendMessageToParent(m.b.GetStreamToken,{resourceId:n.ClientAppId},a,s,[n.ClientAppId]),n.postMessagingService.sendMessageToParent(m.b.GetStreamTokenLower,{resourceId:n.ClientAppId},a,s,[n.ClientAppId]),n.loggingService.appLogicThin("GetHostAuthTokenRequested",{})):(n.loggingService.endPerformance(o,n.payloadForGetHostAuthTokenPerformance(e,t,!1)),Promise.reject("No way to talk to parent"))}catch(r){n.loggingService.endPerformance(o,n.payloadForGetHostAuthTokenPerformance(e,t,!1));var c={message:r instanceof Error&&void 0!==r.message?r.message:y.b.Missing,stack:r instanceof Error&&void 0!==r.stack?r.stack:(new Error).stack||y.c.Missing,staticMessage:ie.HostAuthTokenFailed,feature:e,errorDetails:r};n.loggingService.warnThin("GetHostAuthTokenError",c),Promise.reject(r)}}))},e.prototype.swapAuthToken=function(e,t,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,s,a,c,u,l,d;return Object(r.e)(this,(function(r){switch(r.label){case 0:o=this.loggingService.startUniquePerformance("SwapAuthToken"),r.label=1;case 1:if(r.trys.push([1,3,,4]),!e)throw new Error(ie.NullOrEmptyToken);return s={__RequestVerificationToken:window.sessionInfo.AntiForgeryToken},[4,O.a.postToRelativeUrl(w.a.InjectedAuth+".swapAuthToken",Te,t,{},{token:e},s,E.a.object({AccessToken:E.a.string,AccessTokenExpiry:E.a.string,UserClaim:E.a.object({TenantId:E.a.string,UserInfo:E.a.object({UniqueId:E.a.string})})}))];case 2:return a=r.sent(),c={name:"SwapAuthToken",feature:n,isInitialAuth:i,success:!0},this.loggingService.endPerformance(o,c),[2,Promise.resolve(a)];case 3:return u=r.sent(),l={name:"SwapAuthToken",feature:n,isInitialAuth:i,success:!1},this.loggingService.endPerformance(o,l),d={message:u instanceof Error&&void 0!==u.message?u.message:y.b.Missing,stack:u instanceof Error&&void 0!==u.stack?u.stack:(new Error).stack||y.c.Missing,staticMessage:e?ie.ExchangeTokenFailed:ie.NullOrEmptyToken,feature:n,errorDetails:u},this.isWarningStatus(u)?this.loggingService.warnThin("SwapAuthTokenError",d):this.loggingService.fatalThin("SwapAuthTokenError",d),this.signInFailed({reason:u&&u.data?u.data:u?u.toString():"",errorcode:u?u.status:void 0,customReasonText:e?ie.ExchangeTokenFailed:ie.NullOrEmptyToken},n),[2,Promise.reject(u)];case 4:return[2]}}))}))},e.prototype.isWarningStatus=function(e){return e&&e.status&&(e.status===parseInt(S.a.ClientNetworkError,10)||e.status===parseInt(S.a.Unauthorized,10)||e.status===parseInt(S.a.Forbidden,10)||e.status===parseInt(S.a.NotFound,10))},e.prototype.payloadForGetHostAuthTokenPerformance=function(e,t,n){return{name:"GetHostAuthToken",feature:e,isInitialAuth:t,success:n}},e}();!function(e){e.SessionValid="SessionValid",e.AdalSuccess="AdalSuccess",e.InjectedSuccess="InjectedSuccess",e.SubscribeSuccess="SubscribeSuccess",e.LoginRequired="LoginRequired",e.Failed="Failed",e.SubscribeTimeout="SubscribeTimeout"}(be||(be={}));var Ee=n(459);var Ce=n(32),Oe=n(206);function Ie(e,t,n,r,i){return{name:"AuthenticationEndToEnd",viewContext:e,isInitialAuth:t,authState:G.a[n],authResult:r,adalErrorCode:i?i.adalErrorCode:void 0}}function xe(e,t,n){return{name:"InjectedAuthentication",viewContext:e,isInitialAuth:t,success:n}}function Ae(e,t,n){return{name:"DoTenantPatch",viewContext:e,isInitialAuth:t,success:n}}function ke(e,t,n){return{name:"RefreshSessionCookies",viewContext:e,isInitialAuth:t,success:n}}function Pe(e,t,n){return{name:"GetPrincipalSettings",viewContext:e,isInitialAuth:t,success:n}}function Re(e,t,n){return{name:"GetLocaleInfo",viewContext:e,isInitialAuth:t,success:n}}function _e(e,t,n){var r=Object(Oe.a)(t);return{viewContext:e,stack:r&&void 0!==r.stack?r.stack:(new Error).stack||y.c.Missing,message:r&&void 0!==r.message?r.message:y.b.Missing,errorDetails:t,staticMessage:n}}var Ne=n(87),je=C.supported(),Le=E.a.object({authState:E.a.number,authStateReason:E.a.string,userSession:E.a.object({})}),Me="\\S*"+Ce.f+Ce.e+"$";function Ue(e,t,n,r){try{if(C.supported()){var i={authState:t,authStateReason:n,userSession:e};if(C.setBucket(Ce.f),!C.set(Ce.e,i))throw new Error("lscache.set failed")}}catch(e){var o={groupings:{features:[w.a.SessionManager]},viewContext:new ae.a("lscache"),message:"lscache write failed",stack:Ue.name};r.warnThin("SessionManagerStorageErrorAlert",o)}}function Ve(e){var t=null;try{if(je&&(C.setBucket(Ce.f),t=C.get(Ce.e),!Object(E.b)(t,Le)))return null}catch(t){var n={groupings:{features:[w.a.SessionManager]},viewContext:new ae.a("lscache"),message:"lscache read failed",stack:Ve.name};e.warnThin("SessionManagerStorageErrorAlert",n)}return t}var Fe={features:[w.a.SessionManager]},De=function(){function e(t,n,i,o,s,a,c,u,l,d,h,f){var g=this;void 0===f&&(f=!1),this.authProvider=t,this.tenantService=n,this.injectedAuthProvider=i,this.postMessagingService=o,this.clientSessionId=s,this.userSessionId=a,this.principalService=c,this.localeHelper=u,this.loggingService=l,this.viewContext=d,this.onReadyToLoadResources=h,this.portalLogin=f,this.authStateReason="",this.onAuthStateChangedListeners=new Map,this.nextSubscription=0,this.authFailures=0,this.resourcesSet=!1,this.injectedTokenAuthTimer=void 0,this.getState=function(){return g.authState},this.getStateReason=function(){return g.authStateReason},this.isSessionValid=function(){return g.isAuthTokenValid(g.userSession.authToken)&&!!g.userSession.apiGatewayUrl},this.start=function(e){return Object(r.b)(g,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(n){return void 0!==this.timer||this.isSessionValid()?[2]:(t={groupings:Fe,viewContext:this.viewContext,isInitialAuth:e},this.loggingService.appLogicThin("AuthenticationStarted",t),this.setAuthState(G.a.Waiting),[2,this.ensureSessionValidity(e)])}))}))},this.addStateChangedListener=function(e){return g.onAuthStateChangedListeners.set(g.nextSubscription,e),g.nextSubscription++},this.removeStateChangedListener=function(e){return g.onAuthStateChangedListeners.delete(e)},this.getUserSession=function(){return g.userSession},this.isAuthTokenValid=function(e){if(g.loggingService.debug("isAuthTokenValid: "+e),void 0===e||""===e.token)return!1;var t=Date.now();return e.expiry.valueOf()>t},this.setAuthState=function(t,n){if(void 0===n&&(n=""),Ue(g.userSession,t,n,g.loggingService),t!==g.authState){g.loggingService.debug(G.a[g.authState],"=>",G.a[t]," ",n);var r={groupings:Fe,viewContext:g.viewContext,sessionType:e.name,oldState:G.a[g.authState],newState:G.a[t]};g.loggingService.appLogicThin("SessionAuthStateChanged",r),g.authState=t,g.authStateReason=n,g.authState===G.a.Authenticated&&(g.authFailures=0),g.onAuthStateChangedListeners.forEach((function(e){return e(g.authState,n)}))}else g.loggingService.debug("setAuthState called without change:",G.a[t])},this.shouldRenewBackendToken=function(){return g.timeToNextTokenRefreshMs()<=0},this.timeToNextTokenRefreshMs=function(){return g.timeToTokenExpiration()-Ce.g},this.timeToNextAuthAttemptMs=function(){return Math.min(3e5,250*Math.pow(2,g.authFailures))},this.timeToTokenExpiration=function(){return g.userSession.accessTokenExpiryDate.valueOf()-Date.now()},this.doTenantPatch=function(e){return Object(r.b)(g,void 0,void 0,(function(){var t,n,i,o,s,a;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(this.userSession.apiGatewayUrl&&this.userSession.apiGatewayVersion)return this.loggingService.debug("tenantPatch: Already on gateway:",this.userSession.apiGatewayUrl,this.userSession.apiGatewayVersion),[2,{success:!0,reason:""}];if(!this.isAuthTokenValid(this.userSession.authToken))return t="doTenantPatch failed because the auth token is invalid",this.loggingService.warnThin("DoTenantPatchError",_e(this.viewContext,void 0,t)),[2,{success:!1,reason:t}];n=this.loggingService.startUniquePerformance("DoTenantPatch"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.tenantService.patchTenant(this.userSession,this.tenantPatchStateChanged,!1)];case 2:return i=r.sent(),this.userSession.apiGatewayUrl=i.apiEndpoint,this.userSession.apiGatewayVersion=this.tenantService.getApiVersion(),this.userSession.notificationEndPoint=i.notificationEndpoint,this.serviceRegion=i.region,this.loggingService.endPerformance(n,Ae(this.viewContext,e,!0)),this.loggingService.debug("tenantPatch: New gateway:",i.apiEndpoint),[2,{success:!0,reason:""}];case 3:return o=r.sent(),this.loggingService.endPerformance(n,Ae(this.viewContext,e,!1)),this.isNonFatalError(o)?this.loggingService.warnThin("DoTenantPatchError",_e(this.viewContext,o)):this.loggingService.fatalThin("DoTenantPatchError",_e(this.viewContext,o)),this.injectedAuthProvider&&this.injectedAuthProvider.signInFailed({reason:o&&o.data?o.data:o?o.toString():"",errorcode:o?o.status:void 0,customReasonText:"Stream tenant patch failed"}),s=o&&o.data&&o.data.error&&o.data.error.details&&o.data.error.details.length>0&&o.data.error.details[0].code?o.data.error.details[0].code:"",a=o&&o.status?o.status:void 0,[2,{success:!1,reason:s,status:a}];case 4:return[2]}}))}))},this.refreshBrowserSessionCookies=function(e){return Object(r.b)(g,void 0,void 0,(function(){var t,n,i;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(!(t=this.userSession.apiGatewayUrl))return this.loggingService.warnThin("RefreshSessionCookiesError",_e(this.viewContext,void 0,"refreshBrowserSessionCookies failed because apiUrl is undefined")),[2,!1];n=this.loggingService.startUniquePerformance("RefreshSessionCookies"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,O.a.getWithCorsSupport(w.a.SessionManager+".refreshBrowserSessionCookies",Fe,t,Ce.d,this.userSession.getApiGatewayParameters(),this.userSession.generateHeaders())];case 2:return r.sent(),this.loggingService.endPerformance(n,ke(this.viewContext,e,!0)),[3,4];case 3:return i=r.sent(),this.loggingService.endPerformance(n,ke(this.viewContext,e,!1)),this.injectedAuthProvider&&this.injectedAuthProvider.signInFailed({reason:i&&i.data?i.data:i?i.toString():"",errorcode:i?i.status:void 0,customReasonText:"Failed to refresh backend tokens"}),[2,!1];case 4:return[2,!0]}}))}))},this.setResources=function(e){return Object(r.b)(g,void 0,void 0,(function(){var t,n,i,o,s,a;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(this.resourcesSet)return this.loggingService.debug("setResource: Resources already set: "+this.userSession.userLanguage+this.userSession.userRegion+this.userSession.isRightToLeft),[2,!0];t=this.loggingService.startUniquePerformance("GetPrincipalSettings"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.principalService.getPrincipalSettings(this.userSession)];case 2:n=r.sent(),this.loggingService.endPerformance(t,Pe(this.viewContext,e,!0)),i=this.loggingService.startUniquePerformance("GetLocaleInfo");try{o=this.localeHelper.getLocaleInfo(n),this.loggingService.endPerformance(i,Re(this.viewContext,e,!0)),this.loggingService.debug("Locale info: "+JSON.stringify(o)),this.userSession.applyLocaleInfo(o),this.resourcesSet=!0,(s=this.loggingService.getStandardContextsDeepCopy())&&(s.userContext&&(s.userContext.language=this.userSession.userLanguage,s.userContext.region=this.userSession.userRegion),s.streamContext&&this.serviceRegion&&(s.streamContext.serviceRegion=this.serviceRegion),this.loggingService.setStandardContexts(s)),this.onReadyToLoadResources&&this.onReadyToLoadResources()}catch(t){return this.loggingService.endPerformance(i,Re(this.viewContext,e,!1)),this.loggingService.fatalThin("GetLocaleInfoError",_e(this.viewContext,t)),[2,!1]}return[3,4];case 3:return a=r.sent(),this.loggingService.endPerformance(t,Pe(this.viewContext,e,!1)),this.loggingService.fatalThin("GetPrincipalError",_e(this.viewContext,a)),[2,!1];case 4:return[2,!0]}}))}))},this.enqueueNextSessionValidityCheck=function(){if(!g.tenantService.hasTenantPatchThrottleFailed()){var e=0;g.authState===G.a.Authenticated?(e=g.timeToNextTokenRefreshMs())<=0&&(e=Ce.h):(g.authFailures++,e=g.timeToNextAuthAttemptMs()),g.loggingService.debug("next check in: "+e+"ms"),g.timer=window.setTimeout((function(){g.ensureSessionValidity(!1)}),e)}},this.enqueueNextCachedCredentialsCheck=function(){g.timer=window.setTimeout((function(){g.checkForCachedCredentials(!1)}),Ce.a)},this.setUserInfoToLogContext=function(){var e=g.loggingService.getStandardContextsDeepCopy();e&&e.userContext&&(e.userContext.userId=g.userSession.uniqueId,e.userContext.tenantId=g.userSession.tenantId,g.loggingService.setStandardContexts(e))},this.checkForCachedCredentials=function(e){return Object(r.b)(g,void 0,void 0,(function(){var t,n,i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:return t=this.authProvider.tryGetAuthTokenFromCache(),this.isAuthTokenValid(t.token)?(this.userSession.authToken=t.token,t.user&&(this.userSession.tenantId=t.user.tenantId,this.userSession.uniqueId=t.user.uniqueId,this.userSession.hashedId=this.hashedUserId()),this.setUserInfoToLogContext(),[4,this.completeExtraAuthTasks(e)]):(this.enqueueNextCachedCredentialsCheck(),[2]);case 1:return n=r.sent(),i=n.success,o=n.reason,s=n.status,i?this.setAuthState(G.a.Authenticated):this.setAuthState(G.a.Error,o),403===s?(this.injectedTokenAuthTimer&&clearTimeout(this.injectedTokenAuthTimer),[2]):(this.enqueueNextSessionValidityCheck(),[2])}}))}))},this.ensureSessionValidity=function(e){return Object(r.b)(g,void 0,void 0,(function(){var t,n,i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(i=be.AdalSuccess,o=this.loggingService.startUniquePerformance("AuthenticationEndToEnd"),this.isSessionValid()){if(this.setAuthState(G.a.Authenticated),!this.shouldRenewBackendToken())return this.enqueueNextSessionValidityCheck(),this.loggingService.endPerformance(o,Ie(this.viewContext,e,this.getState(),be.SessionValid,t)),[2]}else this.getState()===G.a.Authenticated&&this.loggingService.debug("current token expired");return this.shouldRenewBackendToken()?[4,this.authProvider.tryAuthenticate(e)]:[3,6];case 1:return t=r.sent(),this.loggingService.debug("authresult: "+t),this.portalLogin||"Failed"!==t.error&&"UserInteractionRequired"!==t.error?[3,3]:[4,this.getTokenViaInjectedAuth(e)];case 2:(n=r.sent())&&n.token&&(t=n,i=be.InjectedSuccess),r.label=3;case 3:return"UserInteractionRequired"!==t.error?[3,5]:(this.setAuthState(G.a.LoginRequired),[4,this.checkForCachedCredentials(e)]);case 4:return r.sent(),this.loggingService.endPerformance(o,Ie(this.viewContext,e,this.getState(),be.LoginRequired,t)),[2];case 5:if("Failed"===t.error)return s="Adal reported failure",this.loggingService.warnThin("AutenticationInErrorState",_e(this.viewContext,void 0,s)),(this.getState()!==G.a.Authenticated||this.getState()===G.a.Authenticated&&!1===this.isSessionValid())&&this.setAuthState(G.a.Error,s),this.enqueueNextSessionValidityCheck(),this.loggingService.endPerformance(o,Ie(this.viewContext,e,this.getState(),be.Failed,t)),[2];r.label=6;case 6:return[4,this.processOnAuth(t,e)];case 7:return r.sent(),this.loggingService.endPerformance(o,Ie(this.viewContext,e,this.getState(),i,t)),[2]}}))}))},this.processOnAuth=function(e,t){return Object(r.b)(g,void 0,void 0,(function(){var n,i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(e&&e.token){if(!this.isAuthTokenValid(e.token))return"Acquired token is invalid",this.getState()!==G.a.Authenticated&&this.setAuthState(G.a.Error,"Acquired token is invalid"),this.loggingService.warnThin("ShouldNeverHappen",_e(this.viewContext,void 0,"Acquired token is invalid")),this.enqueueNextSessionValidityCheck(),[2];if(this.userSession.authToken=e.token,e.user&&(this.userSession.tenantId=e.user.tenantId,this.userSession.uniqueId=e.user.uniqueId,this.userSession.hashedId=this.hashedUserId()),this.setUserInfoToLogContext(),this.shouldRenewBackendToken())return this.loggingService.warnThin("ShouldNeverHappen",_e(this.viewContext,void 0,"Acquired token expires too soon")),this.enqueueNextSessionValidityCheck(),[2]}return[4,this.completeExtraAuthTasks(t)];case 1:if(n=r.sent(),i=n.success,o=n.reason,s=n.status,i)this.postMessagingService&&this.postMessagingService.sendMessageToParent(m.b.signInEvent,{eventname:m.a.signInSuccessful}),this.setAuthState(G.a.Authenticated,o);else if(this.setAuthState(G.a.Error,o),403===s)return this.injectedTokenAuthTimer&&clearTimeout(this.injectedTokenAuthTimer),[2];return this.enqueueNextSessionValidityCheck(),[2]}}))}))},this.completeExtraAuthTasks=function(e){return Object(r.b)(g,void 0,void 0,(function(){var t,n,i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.doTenantPatch(e)];case 1:return t=r.sent(),n=t.success,i=t.reason,o=t.status,n?[4,this.refreshBrowserSessionCookies(e)]:[2,{success:!1,reason:i,status:o}];case 2:return!1===r.sent()?[2,{success:!1,reason:"refresh cookies failed",status:o}]:[4,this.setResources(e)];case 3:return!1===r.sent()&&this.loggingService.debug("set resources failed"),[2,{success:this.isSessionValid(),reason:"",status:o}]}}))}))},this.getTokenViaInjectedAuth=function(e){return Object(r.b)(g,void 0,void 0,(function(){var t=this;return Object(r.e)(this,(function(n){return[2,new Promise((function(n,r){t.injectedTokenAuthTimer=window.setTimeout((function(){t.injectedTokenAuthTimer=void 0,t.postMessagingService&&t.postMessagingService.sendMessageToParent(m.b.signInEvent,{eventname:m.a.signInIncomplete});var r={groupings:Fe,viewContext:t.viewContext,isInitialAuth:e};t.loggingService.appLogicThin("SignInMessageSentToParent",r),n()}),Ce.c),t.startTokenAuth(n,r,e)}))]}))}))},this.startTokenAuth=function(e,t,n){return Object(r.b)(g,void 0,void 0,(function(){var t,i=this;return Object(r.e)(this,(function(r){t=this.loggingService.startUniquePerformance("InjectedAuthentication");try{this.injectedAuthProvider&&this.injectedAuthProvider.getApiGatewayToken(n).then((function(r){i.injectedTokenAuthTimer?(clearTimeout(i.injectedTokenAuthTimer),i.injectedTokenAuthTimer=void 0,e(r)):!i.isSessionValid()&&r.token&&(i.timer&&(clearTimeout(i.timer),i.timer=void 0),i.processOnAuth(r,n)),i.loggingService.endPerformance(t,xe(i.viewContext,n,!0))})).catch((function(r){i.loggingService.endPerformance(t,xe(i.viewContext,n,!1)),e()}))}catch(r){this.loggingService.endPerformance(t,xe(this.viewContext,n,!1)),e()}return[2]}))}))},this.hashedUserId=function(){return e=g.userSession.tenantId+g.userSession.uniqueId,Ee().update(e).digest("hex");var e},this.tenantPatchStateChanged=function(e){switch(e){case D.Success:g.setAuthState(G.a.TenantPatchSuccess);break;case D.Throttled:g.setAuthState(G.a.TenantPatchThrottled);break;case D.ThrottleFailed:g.setAuthState(G.a.TenantPatchThrottleFailed)}},this.loggingService.debug("constructor"),this.userSession=new Ne.a(this.clientSessionId,this.userSessionId),this.authState=G.a.Unknown,this.timer=void 0}return e.prototype.isNonFatalError=function(e){return e&&403===e.status},e}(),qe=function(){function e(e,t){this.lockName=e,this.lockUniqueId=t,this.keepAliveTimerId=void 0}return Object.defineProperty(e.prototype,"itemName",{get:function(){return"_lslock::"+this.lockName},enumerable:!0,configurable:!0}),e.prototype.lock=function(){return!oe.i()||void 0===this.tryGetLockHolderId()&&this.touchLock()},e.prototype.released=function(){var e=this;return oe.i()?Promise.resolve():new Promise((function(t){var n=setInterval((function(){void 0===e.tryGetLockHolderId()&&(clearInterval(n),t())}),500)}))},e.prototype.isMine=function(){return void 0!==this.keepAliveTimerId},e.prototype.unlock=function(){oe.i()&&this.keepAliveTimerId&&(this.cancelKeepAliveTimer(),e.storage.removeItem(this.itemName))},e.prototype.tryGetLockHolderId=function(){oe.a();try{var t=e.storage.getItem(this.itemName),n=JSON.parse(t);if(n&&n.timeStamp){var r=Number(n.timeStamp);if(!isNaN(r)&&Date.now()-r<=2500)return n.uniqueId}}catch(e){return}},e.prototype.touchLock=function(){try{var t={timeStamp:Date.now().toString(),uniqueId:this.lockUniqueId};e.storage.setItem(this.itemName,JSON.stringify(t))}catch(e){return!1}return this.scheduleNextTouchLock(),!0},e.prototype.scheduleNextTouchLock=function(){var e=this;this.cancelKeepAliveTimer(),this.keepAliveTimerId=window.setTimeout((function(){e.touchLock()}),1250)},e.prototype.cancelKeepAliveTimer=function(){this.keepAliveTimerId&&(clearTimeout(this.keepAliveTimerId),this.keepAliveTimerId=void 0)},e.storage=oe.i()?window.localStorage:null,e}(),Ge=function(){function e(e,t,n,r,i,o,s,a){var c=this;this.authProvider=e,this.clientSessionId=t,this.userSessionId=n,this.loggingService=r,this.viewContext=i,this.authMaster=o,this.requireRenewCallback=s,this.onReadyToLoadResources=a,this.nextSubscription=0,this.onAuthStateChangedListeners=new Map,this.resourcesLoaded=!1,this.isInPollingMode=!1,this.hasLoggedBrokenStorageEvents=!1,this.stopCacheMismatchTelemetry=!1,this.addStateChangedListener=function(e){return c.onAuthStateChangedListeners.set(c.nextSubscription,e),c.nextSubscription++},this.removeStateChangedListener=function(e){return c.onAuthStateChangedListeners.delete(e)},this.getUserSession=function(){return c.userSession},this.getState=function(){return c.authState},this.getStateReason=function(){return c.authStateReason},this.onStorageEvent=function(e){e.key&&(e.key.match(Me)&&e.newValue?(c.exitPollingMode(),c.loggingService.debug("Received StorageEvent for cached state: ",JSON.stringify(e)),c.processMasterCachedState()):e.key.indexOf("_lslock::authmaster")>-1&&(c.exitPollingMode(),c.renewOnTimeout()))},this.userSession=new Ne.a(this.clientSessionId,this.userSessionId),this.authState=G.a.Unknown,this.authStateReason=""}return e.prototype.start=function(e){return e&&void 0===this.authEndToEndTagName&&(this.authEndToEndTagName=this.loggingService.startUniquePerformance("AuthenticationEndToEnd")),this.enterPollingMode(),window.addEventListener("storage",this.onStorageEvent),this.renewOnTimeout(),Promise.resolve()},e.prototype.renewOnTimeout=function(){var e=this;void 0!==this.heartbeatTimeout&&window.clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=window.setTimeout((function(){if(e.authMaster.tryGetLockHolderId()){if(e.enterPollingMode(),!e.hasLoggedBrokenStorageEvents){e.hasLoggedBrokenStorageEvents=!0;var t={groupings:{features:[w.a.SessionManager]},viewContext:e.viewContext};e.loggingService.appLogicThin("SubscriberDetectedBrokenStorageEvents",t)}e.renewOnTimeout()}else{e.stop();var n=void 0!==e.authEndToEndTagName;n&&(e.loggingService.endPerformance(e.authEndToEndTagName,Ie(e.viewContext,!0,e.getState(),be.SubscribeTimeout)),e.authEndToEndTagName=void 0),e.requireRenewCallback(n)}}),3e3)},e.prototype.stop=function(){window.removeEventListener("storage",this.onStorageEvent),window.clearTimeout(this.heartbeatTimeout),this.exitPollingMode()},e.prototype.enterPollingMode=function(){var e=this;if(!this.isInPollingMode){this.isInPollingMode=!0;!function t(){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return[4,this.processMasterCachedState()];case 1:return e.sent(),this.masterPollTimeout=window.setTimeout(t,250),[2]}}))}))}()}},e.prototype.exitPollingMode=function(){window.clearTimeout(this.masterPollTimeout),this.isInPollingMode=!1},e.prototype.processMasterCachedState=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,s=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:return(t=Ve(this.loggingService))?(n=this.authMaster.tryGetLockHolderId())!==t.userSession.clientSessionId?(this.loggingService.debug("Disregarding cached auth state because it is not set by lock holder"),this.stopCacheMismatchTelemetry||(o={lockHolderId:n||"undefined",cacheAuthorId:t.userSession.clientSessionId,groupings:{features:[w.a.SessionManager]},viewContext:this.viewContext},this.loggingService.appLogicThin("DisregardingMasterCacheAsItsNotSetByLockHolder",o),this.stopCacheMismatchTelemetry=!0),[2]):(this.stopCacheMismatchTelemetry=!1,Object.getOwnPropertyNames(this.userSession).map((function(e){var n=Object.getOwnPropertyDescriptor(s.userSession,e);n&&n.writable&&"clientSessionId"!==e&&(s.userSession[e]=t.userSession[e])})),t.authState!==G.a.Authenticated||this.resourcesLoaded?[3,1]:(this.resourcesLoaded=!0,this.onReadyToLoadResources&&this.onReadyToLoadResources(),[3,3])):[2];case 1:return t.authState!==G.a.LoginRequired||this.authState===t.authState?[3,3]:[4,this.authProvider.tryAuthenticate(!1)];case 2:(i=r.sent()).token&&!i.error&&(t.authState=G.a.Waiting),r.label=3;case 3:return t.authState===G.a.Authenticated&&void 0!==this.authEndToEndTagName&&(this.loggingService.endPerformance(this.authEndToEndTagName,Ie(this.viewContext,!0,t.authState,be.SubscribeSuccess)),this.authEndToEndTagName=void 0),this.authState!==t.authState&&(o={groupings:{features:[w.a.SessionManager]},viewContext:this.viewContext,sessionType:e.name,oldState:G.a[this.authState],newState:G.a[t.authState]},this.loggingService.appLogicThin("SessionAuthStateChanged",o),this.authState=t.authState,this.authStateReason=t.authStateReason,this.onAuthStateChangedListeners.forEach((function(e){return e(s.authState,s.authStateReason)}))),[2]}}))}))},e}(),Be=function(){function e(e,t,n,r,i,o,s,a,c,u,l){var d=this;this.authProvider=e,this.tenantService=t,this.injectedAuthProvider=n,this.postMessagingService=r,this.clientSessionId=i,this.userSessionId=o,this.principalService=s,this.localeHelper=a,this.loggingService=c,this.viewContext=u,this.onReadyToLoadResources=l,this.externalAuthStateChangedListeners=new Map,this.internalStateChangedSubscription=-1,this.nextExternalStateChangedSubscription=0,this.hasStarted=!1,this.addStateChangedListener=function(e){return d.externalAuthStateChangedListeners.set(d.nextExternalStateChangedSubscription,e),d.nextExternalStateChangedSubscription++},this.removeStateChangedListener=function(e){return d.externalAuthStateChangedListeners.delete(e)},this.wrappedStateChangedListener=function(){var e=d.getState(),t=d.getStateReason();d.externalAuthStateChangedListeners.forEach((function(n){n(e,t)}))},this.requireRenewCallback=function(e){var t={stack:y.c.NotApplicable,message:y.b.NotApplicable,staticMessage:"Communication with SessionManager lost, taking over as SessionManager"};d.createNewManager(e),d.loggingService.warnThin("FallbackUtilized",t)},C.flushExpired(),this.authMaster=new qe("authmaster",i),this.createNewManager(!0)}return e.prototype.getUserSession=function(){return this.internalSessionManager.getUserSession()},e.prototype.getState=function(){return this.internalSessionManager.getState()},e.prototype.getStateReason=function(){return this.internalSessionManager.getStateReason()},e.prototype.start=function(e){return this.hasStarted=!0,this.internalSessionManager.start(e)},e.prototype.shutdown=function(){this.authMaster.unlock()},e.prototype.createNewManager=function(e){this.internalSessionManager&&this.internalSessionManager.removeStateChangedListener(this.internalStateChangedSubscription),this.authMaster.lock()||!C.supported()?this.internalSessionManager=new De(this.authProvider,this.tenantService,this.injectedAuthProvider,this.postMessagingService,this.clientSessionId,this.userSessionId,this.principalService,this.localeHelper,this.loggingService,this.viewContext,this.onReadyToLoadResources):(this.internalSessionManager=new Ge(this.authProvider,this.clientSessionId,this.userSessionId,this.loggingService,this.viewContext,this.authMaster,this.requireRenewCallback,this.onReadyToLoadResources),this.loggingService.appLogicThin("SessionSubscriberCreated",{viewContext:this.viewContext})),this.internalStateChangedSubscription=this.internalSessionManager.addStateChangedListener(this.wrappedStateChangedListener),this.hasStarted&&this.internalSessionManager.start(e)},e}(),He=function(){function e(e,t,n,r){void 0===r&&(r=[]),this.TenantFilterRedirectUrl=e,this.AllowedTenants=t,this.DisallowedTenants=n,this.queryStringBypassStrings=r,this.queryStringBypassStrings.push("bypass_tenant_redirect")}return e.prototype.getTenantFilterRedirect=function(e){return e&&!1!==this.shouldRedirect(e)?this.getRedirectUrl():null},e.prototype.shouldRedirect=function(e){if(!this.TenantFilterRedirectUrl)return!1;if(this.queryStringBypassStrings.some((function(e){return new RegExp(e,"i").test(window.location.search)})))return!1;var t=this.isTenantAllowed(e),n=this.isTenantDisallowed(e);return!t||n},e.prototype.isTenantAllowed=function(e){return!this.AllowedTenants||0===this.AllowedTenants.length||this.AllowedTenants.indexOf(e)>-1},e.prototype.isTenantDisallowed=function(e){return this.DisallowedTenants&&this.DisallowedTenants.indexOf(e)>-1},e.prototype.getRedirectUrl=function(){return this.TenantFilterRedirectUrl+window.location.pathname+window.location.search},e}(),ze=function(){function e(e,t,n,r,i){var o=this;this.embedVideoContext=e,this.authenticationStateChanged=t,this.tenantService=r,this.loginHint=i,this.authState=G.a.Unknown,this.authProvider=null,this.getExternalAuthResult=function(e,t,n){return o.injectedAuthProvider?o.injectedAuthProvider.getAuthResult(e,t,n):Promise.reject()},this.performLogin=function(){o.authProvider&&o.authProvider.performLogin()},this.onAuthenticationStateChanged=function(e,t){o.embedVideoContext.loggingService.appLogicThin("AuthenticationStateChanged",Object(p.b)(e,t));var n=o.getUserSession().tenantId,r=o.tenantFilterService.getTenantFilterRedirect(n);o.embedVideoContext.portalConfiguration.TenantFilterEnabled&&r?(o.embedVideoContext.loggingService.appLogicThin("TenantRedirection",{}),window.location.href=r):o.authenticationStateChanged&&o.authenticationStateChanged(e,t)};var s=this.embedVideoContext,a=s.postMessagingService;this.authProvider=this.createAuthProvider();var c=s.portalConfiguration,u=c.TenantFilterRedirectUrl,l=c.AllowedTenants,d=c.DisallowedTenants;this.tenantFilterService=new He(u,l,d,["app=PowerPoint","app=SPO"]),a&&(this.injectedAuthProvider=new we(s.portalConfiguration.AadClientId,a,s.loggingService));var h=new fe.a(s.portalConfiguration.SupportedLanguages,s.portalConfiguration.RTLLanguages,document.cookie,window.location.search,Object(oe.b)(),s.loggingService,s.telemetryViewContext);this.sessionManager=new Be(this.authProvider,r,this.injectedAuthProvider,a,s.userSessionInfo.ClientSessionId||"",s.userSessionInfo.SessionId||"",s.principalService,h,s.loggingService,s.telemetryViewContext,n),this.sessionManager.addStateChangedListener(this.onAuthenticationStateChanged)}return e.prototype.getUserSession=function(){return this.sessionManager.getUserSession()},e.prototype.startAuthentication=function(){this.sessionManager.start(!0)},e.prototype.getTenantInfo=function(){return this.tenantService.patchTenant(this.getUserSession(),void 0,!1)},e.prototype.createAuthProvider=function(){var e=this.embedVideoContext.portalConfiguration,t={clientId:e.AadClientId,expireOffsetSeconds:Math.floor(Ce.g/1e3),instance:e.AadInstance,resourceId:e.AadResourceId,redirectUri:Object(oe.c)()+"/authredirect",correlationId:this.embedVideoContext.userSessionInfo.ClientSessionId};return new Se(t,this.embedVideoContext.loggingService,!1,this.embedVideoContext.tenantId,this.loginHint)},e}(),Ke=n(204),We=function(e,t,n){return Qe(t,n)};function Qe(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(n){return[2,Object(Ke.a)(e,(function(e){return O.a.performHealthCheck(e,{method:"GET",headers:{}})}),t)]}))}))}function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Je,Ye=function(e){if(!e||!e.data)return null;var t=null;if("object"===$e(e.data))t=e.data;else if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){return null}return t&&t.name?{source:e.source,origin:e.origin,data:t}:null},Xe=function(){function e(t){var n=this;this.embedVideoContext=t,this.queuedVideoIds=new Set,this.fetchedVideoIds=new Set,this.isStarted=!1,this.queuedThumbnailRequests=new Map,this.isRedirectionEnabled=!1,this.handleMessage=function(e){var t=e.data;t&&t.name&&t.methodData&&t.methodData.videoids&&(t.name===m.b.prefetchNewVideos?n.addVideosToPrefetch(t.methodData.videoids):t.name===m.b.fetchVideoThumbnails&&n.addVideosToThumbnailFetch(t.methodData.videoids,e.source,e.origin))},this.addVideosToThumbnailFetch=function(e,t,i){return Object(r.b)(n,void 0,void 0,(function(){var n=this;return Object(r.e)(this,(function(r){return this.isFromValidOrigin(i)?(this.isStarted?this.getThumbnailForMultipleVideos(e,t,i):e.forEach((function(e){if(!n.queuedThumbnailRequests.has(e)){var r={videoId:e,source:t,origin:i};n.queuedThumbnailRequests.set(e,r)}})),[2]):(this.embedVideoContext.streamSession.loggingService.warnThin("EmbedVideoError",Object(p.f)(void 0,void 0,"addVideosToThumbnailFetch: Origin is not supported",p.a.InitError)),[2,Promise.reject()])}))}))},this.isFromValidOrigin=function(t){if(!t)return!1;t=t.toLowerCase();for(var n=0,r=e.validOrigins;n<r.length;n++){var i=r[n].toLowerCase();if(-1!==t.indexOf(i,t.length-i.length))return!0}return!1},this.processQueuedThumbnailRequests=function(e){return Object(r.b)(n,void 0,void 0,(function(){var t,n=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:return e.size>0?(t=[],e.forEach((function(e){t.push(n.getThumbnailForSingleVideo(e.videoId,e.source,e.origin))})),[4,Promise.all(t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},this.getThumbnailForMultipleVideos=function(e,t,i){return Object(r.b)(n,void 0,void 0,(function(){var n,o=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:return e.length>0?(n=[],e.forEach((function(e){n.push(o.getThumbnailForSingleVideo(e,t,i))})),[4,Promise.all(n)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},this.getThumbnailForSingleVideo=function(e,t,i){return Object(r.b)(n,void 0,void 0,(function(){var n,o,s,a,c;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,7]),[4,this.embedVideoContext.embedVideoService.getVideo(e)];case 1:return(n=r.sent())&&n.posterImage?[3,7]:(this.embedVideoContext.streamSession.loggingService.fatalThin("EmbedVideoError",Object(p.g)(void 0,e,"getThumbnailForSingleVideo: Failed getVideo or video has no thumbnail",p.a.GetVideoError)),[2,Promise.reject()]);case 2:return o=r.sent(),"unknownError"!==(s=this.embedVideoContext.embedVideoService.getPlayableStatusFromError(o))?[3,3]:(this.embedVideoContext.streamSession.loggingService.fatalThin("EmbedVideoError",Object(p.g)(o,e,"getThumbnailForSingleVideo: Unknown Exception thrown from getVideo",p.a.GetVideoError)),[3,6]);case 3:return"notFound"===s&&this.isRedirectionEnabled?[4,this.embedVideoContext.embedVideoService.getVideoMigrationStatus(e)]:[3,5];case 4:if(r.sent().migrationStatus===ne.a.Completed)return[2,Promise.resolve()];r.label=5;case 5:this.embedVideoContext.streamSession.loggingService.warnThin("EmbedVideoError",Object(p.g)(o,e,"getThumbnailForSingleVideo: Expected exception thrown from getVideo",p.a.GetVideoError)),r.label=6;case 6:return[2,Promise.reject()];case 7:return[4,this.embedVideoContext.embedVideoService.getThumbnailBase64DataUrl(n)];case 8:return(a=r.sent())?(c={name:m.b.fetchVideoThumbnailResult,eventData:{videoid:e,thumbnailDataUrl:a,name:n.name}},t&&i&&t.postMessage(c,i),[2,Promise.resolve()]):[2,Promise.reject()]}}))}))}}return e.prototype.setupPostMessagingListener=function(){var e;e=this.handleMessage,window.addEventListener("message",(function(t){var n=Ye(t);n&&e(n)}),!1)},e.prototype.start=function(){this.isStarted=!0,this.prefetchVideos(this.queuedVideoIds),this.queuedVideoIds=new Set,this.processQueuedThumbnailRequests(this.queuedThumbnailRequests),this.queuedThumbnailRequests=new Map},e.prototype.addVideosToPrefetch=function(e,t){var n=this;if(void 0===t&&(t=!1),this.isRedirectionEnabled=t,this.isStarted){var r=new Set;e.forEach((function(e){return r.add(e)})),this.prefetchVideos(r)}else e.forEach((function(e){return n.queuedVideoIds.add(e)}))},e.prototype.prefetchVideos=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(t=[],e.forEach((function(e){i.fetchedVideoIds.has(e)||t.push(e)})),0===t.length)return[2];t.forEach((function(e){return i.fetchedVideoIds.add(e)})),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.embedVideoContext.embedVideoService.prefetchVideos(t,this.isRedirectionEnabled)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),this.embedVideoContext.streamSession.loggingService.warnThin("EmbedVideoError",Object(p.f)(n,void 0,"prefetchVideos: prefetch failed",p.a.InitError)),[2];case 4:return[2]}}))}))},e.validOrigins=[".office.com",".office365.com",".officeapps.live.com",".officeapps-ppe.live.com",".officeapps-df.live.com",".beta.officeapps.live.com",".officeapps.live-int.com",".partner.officewebapps.cn",".online.office.de",".gov.online.office365.us",".dod.online.office365.us",".sharepoint.com",".sharepoint-df.com",".microsoft.com"],e}(),Ze=n(13),et={features:[w.a.Video]},tt=function(){function e(){}return e.prototype.get=function(e,t,n){var i=[Ze.b.Creator,Ze.b.Tokens,Ze.b.Status];return t&&(i=Object(r.i)(i,[Ze.b.LiveEvent,Ze.b.Extensions])),this.makeVideoGetRequest("get",n.apiGatewayUrl,Ze.a.Video,e,n.apiGatewayVersion,nt,n.generateHeaders(),i.join(","))},e.prototype.getVideoMigrationStatus=function(e,t){return this.makeVideoGetRequest("migrationStatus",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.c.GetMigrationStatus,e,t.apiGatewayVersion,ot,t.generateHeaders())},e.prototype.getPlayableStatusFromVideo=function(e){return e.playbackUrls&&e.playbackUrls.length?"playable":e.state===ne.b.Processing||e.state===ne.b.Uploading?"notReady":"videoError"},e.prototype.getPlayableStatusFromError=function(e){if(e&&e.hasOwnProperty("status")){if(403===e.status)return"forbidden";if(404===e.status)return"notFound"}return"unknownError"},e.prototype.getTrendingVideos=function(e,t,n,r,i){void 0===r&&(r="published and (state eq 'Completed' or contentSource eq 'livestream')");var o=i?"creator,events":"creator";return this.makeVideoQuery("getTrendingVideos",e,t,n,Ze.f.Trending,Ze.e.Descending,o,r)},e.prototype.like=function(e,t){return this.makeVideoPostRequest("like",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.d.Like,e,t.apiGatewayVersion,rt,t.generateHeaders())},e.prototype.unLike=function(e,t){return this.makeVideoPostRequest("unLike",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.d.UnLike,e,t.apiGatewayVersion,rt,t.generateHeaders())},e.prototype.viewed=function(e,t){return this.makeVideoPostRequest("viewed",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.d.Viewed,e,t.apiGatewayVersion,rt,t.generateHeaders())},e.prototype.pinVideo=function(e,t){return this.makeVideoPostRequest("pinVideo",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.d.Pin,e,t.apiGatewayVersion,rt,t.generateHeaders())},e.prototype.unPinVideo=function(e,t){return this.makeVideoPostRequest("unPinVideo",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.d.UnPin,e,t.apiGatewayVersion,rt,t.generateHeaders())},e.prototype.getPinnedVideos=function(e,t,n,r,i,o,s){var a=s?"creator,events":"creator";return this.makeVideoQuery("getPinnedVideos",e,t,n,r,i,a,"userData/isPinned",o)},e.prototype.getUserVideos=function(e,t,n,r,i,o,s,a,c){var u="creator/id eq '"+t+"' and published and (state eq 'Completed' or contentSource eq 'livestream')",l=a?"creator,events":"creator";return this.makeVideoQuery("getUserVideos",e,r,i,o,s,l,u,n,c)},e.prototype.getMyVideos=function(e,t,n,r,i,o,s,a,c,u,l,d){var h="creator/id eq '"+e.uniqueId+"'";s&&"all"!==s&&(h+=" and published eq "+s),a&&"all"!==a&&(h+=" and privacyMode eq '"+a+"'"),c&&(h+=" and state eq '"+c+"'"),u&&(h+=" and contentType eq '"+u+"'");var f=["creator"];return l&&f.push("events"),d&&f.push("liveEvents"),this.makeVideoQuery("getMyVideos",e,t,n,r,i,f.join(","),h,o)},e.prototype.search=function(e,t,n,r,i,o,s,a,c){void 0===a&&(a="published and (state eq 'Completed' or contentSource eq 'livestream')");var u=s?"creator,events":"creator";return this.makeVideoQuery("getUserVideos",e,n,r,i,o,u,a,t,c)},e.prototype.getTokens=function(e,t){return this.makeVideoGetRequest("getTokens",t.apiGatewayUrl,""+Ze.a.VideoTokens,e,t.apiGatewayVersion,E.a.object({value:E.a.array(E.a.object({}))}),t.generateHeaders())},e.prototype.getLinks=function(e,t){return this.makeVideoGetRequest("getLinks",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.d.GetLinks,e,t.apiGatewayVersion,at,t.generateHeaders())},e.prototype.setLinks=function(e,t,n,r){void 0===r&&(r=!1);var i=r?Ze.d.SetVideoPermissions:Ze.d.SetLinks;return this.makeVideoPostRequest(i,t.apiGatewayUrl,Ze.a.Video+"/"+i,e,t.apiGatewayVersion,rt,t.generateHeaders(),n)},e.prototype.isVideoBeingTrimmedOrReplaced=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.getVideoStatus(e,t)];case 1:return n=r.sent(),i=n.processingStatus.some((function(e){var t=e.type.trim().toLowerCase(),n=e.state.trim().toLowerCase();return"replacing"===t&&"processing"===n})),o=n.processingStatus.some((function(e){var t=e.type.trim().toLowerCase(),n=e.state.trim().toLowerCase();return"trimming"===t&&"processing"===n})),[2,i||o]}}))}))},e.prototype.getChannels=function(e,t,n){var r=[];return n&&r.push(Ze.b.Group),this.makeVideoGetRequest("channels",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.d.Channels,e,t.apiGatewayVersion,E.a.object({value:E.a.array(E.a.object({id:E.a.string}))}),t.generateHeaders(),r.join(","))},e.prototype.getRoleAssignments=function(e,t){var n=[Ze.b.Principal,Ze.b.Role];return this.makeVideoGetRequest("roleassignments",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.d.RoleAssignments,e,t.apiGatewayVersion,E.a.object({value:E.a.array(st)}),t.generateHeaders(),n.join(","))},e.prototype.create=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.e)(this,(function(r){return n=t.apiGatewayUrl,i=Ze.a.Video,[2,O.a.post(w.a.Video+".create",et,n,i,{apiVersion:t.apiGatewayVersion},e,t.generateHeaders(),nt)]}))}))},e.prototype.trim=function(e,t,n){var r=n.apiGatewayUrl,i=Ze.a.VideoTrim;return O.a.post(w.a.Video+".trim",et,r,i,{id:e,apiVersion:n.apiGatewayVersion},t,n.generateHeaders(),nt)},e.prototype.patch=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s;return Object(r.e)(this,(function(r){return i={id:e,apiVersion:n.apiGatewayVersion},o=n.apiGatewayUrl,s=Ze.a.Video,[2,O.a.patch(w.a.Video+".patch",et,o,s,i,t,n.generateHeaders(),nt)]}))}))},e.prototype.delete=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.e)(this,(function(r){switch(r.label){case 0:return n={id:e,apiVersion:t.apiGatewayVersion},i=t.apiGatewayUrl,o=Ze.a.Video,[4,O.a.delete(w.a.Video+".delete",et,i,o,n,t.generateHeaders())];case 1:return r.sent(),window.dispatchEvent(new CustomEvent("videoDelete",{detail:{videoId:e}})),[2]}}))}))},e.prototype.getAssetFileUrl=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.makeVideoGetRequest("get",n.apiGatewayUrl,Ze.a.VideoFile,e,n.apiGatewayVersion,ut,n.generateHeaders())];case 1:return(i=r.sent()).value?(o=i.value,(s=o.find((function(e){return e.type===t})))&&s.downloadUrl?[2,Promise.resolve(s.downloadUrl)]:[2,Promise.reject("No download url for this resource")]):[2,Promise.reject("No download url for this resource")]}}))}))},e.prototype.getVideoStatus=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(n){return[2,this.makeVideoGetRequest("getVideoStatus",t.apiGatewayUrl,Ze.a.Video+"/"+Ze.d.Status,e,t.apiGatewayVersion,it,t.generateHeaders())]}))}))},e.prototype.videoCaptionStatus=function(e){var t;if(e.status)return e.status.processingStatus.forEach((function(e){var n=e.type.trim().toLowerCase(),r=e.state.trim().toLowerCase();if("caption"===n)switch(r){case"completed":t="completed";break;case"error":t="error";break;case"processing":t="processing"}})),t},e.prototype.makeVideoGetRequest=function(e,t,n,i,o,s,a,c){return Object(r.b)(this,void 0,void 0,(function(){var u,l;return Object(r.e)(this,(function(r){switch(r.label){case 0:return u={id:i,apiVersion:o},void 0!==c&&(u.$expand=c),[4,O.a.get(w.a.Video+"."+e,et,t,n,u,a,s)];case 1:return(l=r.sent()).playbackUrls&&(l.playbackUrls=l.playbackUrls.map((function(e){return{mimeType:e.mimeType,playbackUrl:[e.playbackUrl]}}))),[2,l]}}))}))},e.prototype.makeVideoPostRequest=function(e,t,n,i,o,s,a,c){return void 0===c&&(c={}),Object(r.b)(this,void 0,void 0,(function(){var u;return Object(r.e)(this,(function(r){return u={id:i,apiVersion:o},[2,O.a.post(w.a.Video+"."+e,et,t,n,u,c,a,s)]}))}))},e.prototype.makeVideoQuery=function(e,t,n,r,i,o,s,a,c,u){var l={apiVersion:t.apiGatewayVersion,$top:n.toString(),$skip:r.toString(),$orderby:i+" "+o,$expand:s,$filter:a};return c&&(l.$search=c),u&&(l.adminmode=u),this.makeVideoQueryRequest(e,t.apiGatewayUrl,Ze.a.Video,l,ct).then((function(e){return e.value}))},e.prototype.makeVideoQueryRequest=function(e,t,n,r,i,o){return O.a.query(w.a.Video+"."+e,et,t,n,r,o,i)},e}(),nt=E.a.object({id:E.a.string,state:E.a.union(E.a.literal(ne.b.Completed),E.a.literal(ne.b.Created),E.a.literal(ne.b.Uploading),E.a.literal(ne.b.Processing),E.a.literal(ne.b.Error),E.a.literal(ne.b.Live))}),rt=E.a.any,it=E.a.object({id:E.a.string,state:E.a.string,processingStatus:E.a.array(E.a.object({type:E.a.string,state:E.a.string,progress:E.a.number}))}),ot=E.a.object({id:E.a.string,migrationStatus:E.a.union(E.a.literal(ne.a.NotStarted),E.a.literal(ne.a.Processing),E.a.literal(ne.a.Partial),E.a.literal(ne.a.Completed),E.a.literal(ne.a.Error))}),st=E.a.object({id:E.a.string,roleId:E.a.string,assignedTo:E.a.object({scope:E.a.string,principalRef:E.a.object({id:E.a.string,type:E.a.string})}),principal:E.a.object({})}),at=E.a.object({videoUrl:E.a.optional(E.a.string),roleAssignments:E.a.array(E.a.object({roleId:E.a.string,principals:E.a.array(E.a.object({principalId:E.a.string,principalType:E.a.string,emailAddress:E.a.optional(E.a.string),sendEmail:E.a.optional(E.a.boolean)}))})),groupLinks:E.a.array(E.a.object({groupId:E.a.string,channels:E.a.array(E.a.object({id:E.a.string}))}))}),ct=E.a.object({value:E.a.array(nt)}),ut=E.a.object({value:E.a.array(E.a.object({id:E.a.string,downloadUrl:E.a.string,type:E.a.union(E.a.literal("video"),E.a.literal("presentation"))}))}),lt=n(467),dt={components:[lt.c.ThinEmbedVideoPlayer],features:[w.a.Video]},ht=function(){function e(e,t,i,s,a,c){var u=this;void 0===i&&(i=""),void 0===s&&(s=60),this.context=e,this.isPublicAnonymous=t,this.manifestUrl=i,this.expirationInMinutes=s,this.contentSource=a,this.playbackUrls=c,this.ensureVideoEventServiceLoaded=function(){return Object(r.b)(u,void 0,void 0,(function(){return Object(r.e)(this,(function(e){switch(e.label){case 0:return this.videoEventService?[2]:(this.videoEventServiceLoadingPromise||(this.videoEventServiceLoadingPromise=this.loadVideoEventService()),[4,this.videoEventServiceLoadingPromise]);case 1:return e.sent(),[2]}}))}))},this.getForms=function(e,t){return Object(r.b)(u,void 0,void 0,(function(){return Object(r.e)(this,(function(n){switch(n.label){case 0:return[4,this.ensureVideoEventServiceLoaded()];case 1:return n.sent(),[2,this.videoEventService.getForms(e,t)]}}))}))},this.markFormAsViewed=function(e,t,n){return Object(r.b)(u,void 0,void 0,(function(){return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.ensureVideoEventServiceLoaded()];case 1:return r.sent(),[2,this.videoEventService.markFormAsViewed(e,t,n)]}}))}))},this.getTranscript=function(e,t,n){return void 0===n&&(n=!1),Object(r.b)(u,void 0,void 0,(function(){return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.ensureVideoEventServiceLoaded()];case 1:return r.sent(),[2,this.videoEventService.getTranscript(e,t,n)]}}))}))},this.search=function(e,t,n,i){return void 0===i&&(i=!1),Object(r.b)(u,void 0,void 0,(function(){return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.ensureVideoEventServiceLoaded()];case 1:return r.sent(),[2,this.videoEventService.search(e,t,n,i)]}}))}))},this.loadVideoEventService=function(){return Object(r.b)(u,void 0,void 0,(function(){var e,t;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Qe((function(){return n.e(258).then(n.bind(null,1452))}))];case 1:return e=r.sent(),this.videoEventService=new e.VideoEventService,this.videoEventServiceLoadingPromise=void 0,[3,3];case 2:throw t=r.sent(),Object(o.b)(this.context.loggingService,"videoEventService",t),t;case 3:return[2]}}))}))},this.localStorageSupportEnabled=Object(oe.i)(),this.localStorageSupportEnabled&&C.flushExpired(),this.videoService=new tt}return e.prototype.getVideo=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,i,s,a,c,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(!this.isPublicAnonymous)return[3,7];if(t=ne.b.Completed,i=[],this.playbackUrls?(this.playbackUrls.dashUrl&&i.push({mimeType:de.c.dash,playbackUrl:this.playbackUrls.dashUrl}),this.playbackUrls.hlsUrl&&i.push({mimeType:de.c.hls,playbackUrl:this.playbackUrls.hlsUrl}),this.playbackUrls.progressiveUrl&&i.push({mimeType:de.c.progressive,playbackUrl:this.playbackUrls.progressiveUrl})):i=[{mimeType:de.c.smooth,playbackUrl:[this.manifestUrl]},{mimeType:de.c.dash,playbackUrl:[this.manifestUrl+"(format=mpd-time-csf)"]},{mimeType:de.c.hls,playbackUrl:[this.manifestUrl+"(format=m3u8-aapl)"]}],this.contentSource!==de.b.liveStream)return[3,6];s=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Qe((function(){return Promise.all([n.e(250),n.e(148)]).then(n.bind(null,1492))}))];case 2:return s=r.sent(),[3,4];case 3:throw a=r.sent(),Object(o.a)(this.context.loggingService,"liveVideoPlugin",a),a;case 4:return[4,s.doesManifestExist(i,this.context.loggingService)];case 5:t=r.sent()?ne.b.Live:ne.b.Created,r.label=6;case 6:return[2,Promise.resolve({id:"temp",contentSource:this.contentSource,state:t,playbackUrls:i})];case 7:return[4,this.tryGetFromStorage(e)];case 8:return(c=r.sent())?[2,c]:(!0,u=this.context.getUserSession(),[4,this.videoService.get(e,!0,u)]);case 9:return[2,r.sent()]}}))}))},e.prototype.getVideoMigrationStatus=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(n){switch(n.label){case 0:return t=this.context.getUserSession(),[4,this.videoService.getVideoMigrationStatus(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.markVideoAsViewed=function(e){var t=this.context.getUserSession();return this.videoService.viewed(e,t)},e.prototype.getPlayableStatusFromVideo=function(e){return this.videoService.getPlayableStatusFromVideo(e)},e.prototype.getPlayableStatusFromError=function(e){return this.videoService.getPlayableStatusFromError(e)},e.prototype.getTokens=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(n){switch(n.label){case 0:t=this.context.getUserSession(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.videoService.getTokens(e,t)];case 2:return[2,n.sent().value];case 3:return n.sent(),[2,[]];case 4:return[2]}}))}))},e.prototype.prefetchVideo=function(e,t){return void 0===t&&(t=!1),Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,5]),[4,this.getVideo(e)];case 1:return n=r.sent(),"playable"===this.getPlayableStatusFromVideo(n)&&this.setInStorage(n),[3,5];case 2:return i=r.sent(),"notFound"===this.getPlayableStatusFromError(i)&&t?[4,this.getVideoMigrationStatus(e)]:[3,4];case 3:if(r.sent().migrationStatus===ne.a.Completed)return[2];r.label=4;case 4:throw i;case 5:return[2]}}))}))},e.prototype.prefetchVideos=function(e,t){return void 0===t&&(t=!1),Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s;return Object(r.e)(this,(function(r){for(n=[],i=0,o=e;i<o.length;i++)s=o[i],n.push(this.prefetchVideo(s,t));return[2,Promise.all(n)]}))}))},e.prototype.getStorageKey=function(e){return"VIDEO_DESCRIPTION_"+e},e.prototype.getThumbnailBase64DataUrl=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,s,a,c,u,l,d,h,f,g,v;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(!e||!e.posterImage)return[2,Promise.reject()];if(e.posterImage.large)t=e.posterImage.large.url;else if(e.posterImage.medium)t=e.posterImage.medium.url;else if(e.posterImage.small)t=e.posterImage.small.url;else{if(!e.posterImage.extraSmall)return[2,Promise.reject()];t=e.posterImage.extraSmall.url}n=-1===t.indexOf("?")?"?":"&",t+=n+"corsWorkaround="+encodeURIComponent(Object(oe.c)()),i={method:"GET",headers:this.context.getUserSession().generateHeaders()},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,fetch(t,i)];case 2:return o=r.sent(),[3,4];case 3:return s=r.sent(),B.a.logError({method:"GET",staticMessage:lt.c.ThinEmbedVideoPlayer+".getThumbnailBase64DataUrl",url:t,error:s,groupings:dt}),[2,Promise.reject(s)];case 4:return o.ok?[3,6]:[4,o.json()];case 5:return a=r.sent(),c={status:o.status,statusText:o.statusText,data:a},B.a.logError({method:"GET",staticMessage:lt.c.ThinEmbedVideoPlayer+".getThumbnailBase64DataUrl",url:t,error:c,groupings:dt}),[2,Promise.reject(c)];case 6:return r.trys.push([6,8,,9]),[4,o.blob()];case 7:return u=r.sent(),[3,9];case 8:return l=r.sent(),B.a.logError({method:"GET",staticMessage:lt.c.ThinEmbedVideoPlayer+".readResponseAsBlob",url:t,error:l,groupings:dt}),[2,Promise.reject(l)];case 9:return"application/octet-stream"!==u.type?[3,12]:[4,u.slice(0,2)];case 10:return d=r.sent(),[4,this.readBlobToArrayBufferAsync(d)];case 11:h=r.sent(),1===(f=new Uint16Array(h)).length&&20617===f[0]?u=new Blob([u],{type:"image/png"}):1===f.length&&55551===f[0]?u=new Blob([u],{type:"image/jpeg"}):this.context.loggingService.warnThin("EmbedVideoError",Object(p.f)(void 0,e,"getThumbnailBase64DataUrl: Unrecognized thumbnail format",p.a.InitError)),r.label=12;case 12:return r.trys.push([12,14,,15]),[4,this.readBlobToDataUrlAsync(u)];case 13:return g=r.sent(),[3,15];case 14:return v=r.sent(),B.a.logError({method:"GET",staticMessage:lt.c.ThinEmbedVideoPlayer+".readBlobToDataUrlAsync",url:t,error:v,groupings:dt}),[2,Promise.reject(v)];case 15:return[2,g]}}))}))},e.prototype.tryGetFromStorage=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i;return Object(r.e)(this,(function(r){if(!this.localStorageSupportEnabled)return[2,null];Object(oe.a)(),t=null,n=this.getStorageKey(e);try{(i=C.get(n))&&(t=i)}catch(e){this.localStorageSupportEnabled=!1,t=null}return[2,t]}))}))},e.prototype.setInStorage=function(e){if(!this.localStorageSupportEnabled)return!1;var t=this.getStorageKey(e.id);try{C.set(t,e,this.expirationInMinutes)}catch(e){return this.localStorageSupportEnabled=!1,!1}return!0},e.prototype.readBlobToDataUrlAsync=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)}))]}))}))},e.prototype.readBlobToArrayBufferAsync=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)}))]}))}))},e}();"function"!=typeof window.CustomEvent&&(window.CustomEvent=re),Number.isNaN||Object.defineProperty(Number,"isNaN",{value:function(e){return e!=e}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw TypeError(Object(H.c)('"this" is null or not defined'));var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw TypeError(Object(H.c)("predicate must be a function"));for(var r=arguments[1],i=0;i<n;){var o=t[i];if(e.call(r,o,i,t))return o;i++}},configurable:!0,writable:!0}),Element.prototype.hasOwnProperty("remove")||Object.defineProperty(Element.prototype,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError(Object(H.c)('"this" is null or not defined'));var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError(Object(H.c)("predicate must be a function"));for(var r=arguments[1],i=0;i<n;){var o=t[i];if(e.call(r,o,i,t))return i;i++}return-1},configurable:!0,writable:!0}),String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError(Object(H.c)("can't convert "+this+" to object"));var t=""+this;if((e=+e)!=e&&(e=0),e<0)throw new RangeError(Object(H.c)("repeat count must be non-negative"));if(e==1/0)throw new RangeError(Object(H.c)("repeat count must be less than infinity"));if(e=Math.floor(e),0==t.length||0==e)return"";if(t.length*e>=1<<28)throw new RangeError(Object(H.c)("repeat count must not overflow maximum string size"));var n=t.length*e;for(e=Math.floor(Math.log(e)/Math.log(2));e;)t+=t,e--;return t+=t.substring(0,n-t.length)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},writable:!0,configurable:!0}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;for(var i,o,s=0|t,a=Math.max(s>=0?s:r-Math.abs(s),0);a<r;){if((i=n[a])===(o=e)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;a++}return!1}}),function(e){e[e.ErrorOccurred=0]="ErrorOccurred",e[e.LoginRequired=1]="LoginRequired",e[e.Authenticated=2]="Authenticated",e[e.ResourcesReady=3]="ResourcesReady",e[e.PlayerDownloaded=4]="PlayerDownloaded",e[e.PlayerReady=5]="PlayerReady"}(Je||(Je={}));var ft=function(){function e(e,t,i,c,u,l,d,h,f,g,y,S,w,E,C,O,I){var x=this;void 0===S&&(S=""),void 0===C&&(C=!0),this.portalConfiguration=e,this.userSessionInfo=t,this.streamFullStaticPath=i,this.viewName=c,this.loggingService=u,this.container=l,this.isPublicAnonymous=d,this.tenantId=h,this.onReady=y,this.isSdnDebug=w,this.resourcesLoaded=E,this.enablePostMessaging=C,this.fromOnePlayer=O,this.theme="dark",this.resources={},this.streamSession=this,this.resourceLoaders={initPhase:We,renderPhase:We},this.onePlayerName="OnePlayer",this.getUserSession=function(){return x.embedAuthenticationService.getUserSession()},this.getVideo=function(e){return x.embedVideoService.getVideo(e)},this.markVideoAsViewed=function(e){x.isPublicAnonymous||x.embedVideoService.markVideoAsViewed(e).then((function(){x.video&&x.video.id===e&&x.video.metrics&&x.video.metrics.views++})).catch((function(t){x.loggingService.warnThin("EmbedVideoError",Object(p.g)(t,e,"markVideoAsViewed",p.a.InitError))}))},this.getTokens=function(e,t){return x.embedVideoService.getTokens(e,t)},this.getFeatureFlag=function(e,t){var n=e.streamSession.portalConfiguration.ECSConfiguration;if(n&&n.settings){var r=n.settings.MicrosoftStream;if(r&&r[t])return r[t]}return!1},this.initialize=function(){return Object(r.b)(x,void 0,void 0,(function(){var e,t,i,s,a,c=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:return this.localization.locale.value?[3,2]:[4,this.onReadyToLoadResources()];case 1:r.sent(),r.label=2;case 2:return this.loggingService.appLogicThin("EmbedVideoLoadingStarted",{viewContext:this.telemetryViewContext}),this.viewName.indexOf(this.onePlayerName)>=0&&(""===(e=ue.a.convertToStreamCultureName(this.userSessionInfo.UserLanguage))?(this.loggingService.warnThin("EmbedVideoError",Object(p.f)(this.userSessionInfo.UserLanguage,this.video,"convertsLanguageCode")),this.userSessionInfo.UserLanguage="en"):this.userSessionInfo.UserLanguage=e),this.postMessagingService?[4,this.loadPostMessagingService()]:[3,4];case 3:r.sent(),this.postMessagingService.connectWithParent(),r.label=4;case 4:if(!(t=this.getCookieBlockedErrorMessage(!1)))return[3,8];r.label=5;case 5:return r.trys.push([5,7,,8]),[4,this.renderCookieBlockedError(t)];case 6:return r.sent(),[2];case 7:throw i=r.sent(),this.logFatalVideoError("initialize: renderCookieBlockedError",i,this.video,p.a.InitError),i;case 8:this.embedVideoPrefetcher.setupPostMessagingListener(),this.embedAuthenticationService.startAuthentication(),r.label=9;case 9:return r.trys.push([9,11,,12]),[4,Qe((function(){return Promise.all([n.e(254),n.e(7),n.e(236)]).then(n.bind(null,1490))}))];case 10:return s=r.sent(),[3,12];case 11:throw a=r.sent(),Object(o.a)(this.loggingService,"thinPlayer",a),a;case 12:return this.streamVideoPlayer=new s.StreamVideoPlayer(this,this.fromOnePlayer,(function(){c.onReady&&c.onReady(c,!0)})),this.stateMachine.setState(Je.PlayerDownloaded),[2]}}))}))},this.loadPostMessagingService=function(){return Object(r.b)(x,void 0,void 0,(function(){var e,t=this;return Object(r.e)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Qe((function(){return Object(s.c)(Object(a.e)(t.portalConfiguration),t.loggingService)}),!1)];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),Object(o.a)(this.loggingService,"postMessageScript",e),this.authenticationStateChanged(G.a.Error,""),[3,3];case 3:return[2]}}))}))},this.getUserContext=function(){var e=x.embedAuthenticationService.getUserSession(),t=v(e.uniqueId,x.userSessionInfo.PrincipalInfo),n={userId:e.uniqueId,userType:t,language:x.viewName.indexOf(x.onePlayerName)>=0?x.userSessionInfo.UserLanguage:e.userLanguage,region:e.userRegion||x.userSessionInfo.UserRegion,tenantId:e.tenantId,clientSessionId:e.clientSessionId,userSessionId:x.userSessionInfo.SessionId,servicePlan:x.userSessionInfo.ServicePlanForTelemetry,puid:x.userSessionInfo.PrincipalId};return!0===x.fromOnePlayer&&(n.userId=x.userSessionInfo.UserClaim.UserInfo.UniqueId,n.tenantId=x.userSessionInfo.UserClaim.TenantId),n},this.authenticationStateChanged=function(e,t){return Object(r.b)(x,void 0,void 0,(function(){var n,i,o,s,a,c=this;return Object(r.e)(this,(function(r){switch(e){case G.a.Authenticated:n=this.portalConfiguration.ECSConfiguration?this.portalConfiguration.ECSConfiguration.telemetryRecord:void 0,i=this.getUserContext(),this.loggingService.userSignedIn(i,n),this.hideErrorBox(),this.stateMachine.setState(Je.Authenticated);break;case G.a.LoginRequired:(o=this.getCookieBlockedErrorMessage(!0))?this.renderCookieBlockedError(o).catch((function(e){c.logFatalVideoError("authenticationStateChanged: renderCookieBlockedError",e,c.video,p.a.InitError),c.showErrorBox()})):(this.showLoginScreen(),this.loggingService.userSignedOut("Unauthenticated"),this.hideErrorBox());break;case G.a.TenantPatchSuccess:this.hideErrorBox();break;case G.a.TenantPatchThrottled:this.showErrorBox({titleStr:this.getString("WaitingRoomBodyTitle"),message:this.getString("WaitingRoomBodyText"),isRecoverable:!0,noActions:!0}),this.loggingService.appLogicThin("TenantPatchThrottled",{viewContext:this.telemetryViewContext});break;case G.a.TenantPatchThrottleFailed:this.hideErrorBox();break;case G.a.Error:switch(s=void 0,a=void 0,t){case"TrialPlanExpired":this.loggingService.warnThin("AutenticationInErrorState",Object(p.c)("Trial plan expired")),s=this.getString("BannerMessageTrialSuspended"),a="https://go.microsoft.com/fwlink/?linkid=2089914";break;case"UserHasNoServicePlan":this.loggingService.warnThin("AutenticationInErrorState",Object(p.c)("User has no service plan")),s=this.getString("FallbackMsgServiceDisabled");break;default:this.loggingService.fatalThin("AutenticationInErrorState",Object(p.c)("Unexpected error")),s=this.getString("authenticationErrorMessage")}this.showErrorBox({titleStr:this.getString("authenticationErrorMessageTitle"),message:s,messageLink:a,isRecoverable:!0})}return[2]}))}))},this.onReadyToLoadResources=function(){return Object(r.b)(x,void 0,void 0,(function(){var e;return Object(r.e)(this,(function(t){switch(t.label){case 0:return[4,this.localization.setLocale(this.getUserSession().userLanguage)];case 1:return t.sent(),this.setResources(),e=this,[4,this.getPlayerResources()];case 2:return e.playerResources=t.sent(),this.resourcesLoaded&&this.resourcesLoaded(this.localization),this.stateMachine.setState(Je.ResourcesReady),[2]}}))}))},this.getCookieBlockedErrorMessage=function(e){if(!x.isPublicAnonymous&&(e||Object(oe.g)())){if(Object(oe.g)("13")&&!Object(oe.g)("13.2")&&Object(oe.h)())return x.loggingService.warnThin("CookieBlocked",Object(p.e)()),x.postMessagingService&&x.postMessagingService.sendMessageToParent(m.b.signInEvent,{errorcode:"50107",message:"Cookies blocked due to IOS 13 issue."}),x.getString("FallbackMsgIOS13Error");return Object(oe.i)()||x.loggingService.warnThin("SessionManagerStorageErrorAlert",Object(p.c)("LocalStorage denied, can cause ADAL failure")),Object(oe.j)()||x.loggingService.warnThin("SessionManagerStorageErrorAlert",Object(p.c)("SessionStorage denied, can cause ADAL failure")),Object(oe.d)()?void 0:(x.loggingService.warnThin("CookieBlocked",Object(p.d)()),x.postMessagingService&&x.postMessagingService.sendMessageToParent(m.b.signInEvent,{eventname:m.a.cookieBlocked,errorcode:"50104"}),x.getString("FallbackMessageInvalidCookies"))}},this.logStateChanged=function(e){x.loggingService.appLogicThin("EmbedVideoCoreStateChanged",{viewContext:x.telemetryViewContext,embedVideoCoreState:Je[e]})},this.localization=Object(he.a)(We),this.playbackSessionId=Object(se.a)();var A=this.loggingService.getStandardContextsDeepCopy();if(A&&(A.entityContext||(A.entityContext={}),A.entityContext.playbackSessionId=this.playbackSessionId,this.loggingService.setStandardContexts(A)),this.telemetryViewContext=new ae.a(c),this.stateMachine=new le.a(Je.ErrorOccurred,this.logStateChanged),this.isPublicAnonymous){var k=new T.a;this.principalService=k,this.enablePostMessaging&&(this.postMessagingService=new b(this.loggingService)),this.embedAuthenticationService=new ce.a(this,k,this.authenticationStateChanged,this.onReadyToLoadResources)}else this.principalService=new q(this.loggingService,{},this.telemetryViewContext),this.enablePostMessaging&&(this.postMessagingService=new b(this.loggingService)),this.tenantService=new ee(this.portalConfiguration.TenantServiceUri||"https://api.microsoftstream.com",this.portalConfiguration.TenantServiceApiVersion||"1.3-private"),this.embedAuthenticationService=new ze(this,this.authenticationStateChanged,this.onReadyToLoadResources,this.tenantService,f);this.embedVideoService=new ht(this,this.isPublicAnonymous,S,void 0,g,I),this.embedVideoPrefetcher=new Xe(this),this.initialize().catch((function(e){x.logFatalVideoError("initialize",e,x.video,p.a.InitError),x.showErrorBox()}))}return e.prototype.dispose=function(){this.streamVideoPlayer&&this.streamVideoPlayer.dispose()},e.prototype.renderVideo=function(e,t,n){return void 0===t&&(t={}),Object(r.b)(this,void 0,void 0,(function(){var i,o,s,c,u,l,d,h,f,g,v,y,S=this;return Object(r.e)(this,(function(b){switch(b.label){case 0:return[4,this.stateMachine.waitForStates([Je.Authenticated])];case 1:return b.sent()?(i=this.showRedirectBoxIfApplicable(e),this.video=void 0,[4,this.stateMachine.waitForStates([Je.ResourcesReady,Je.PlayerDownloaded])]):[2,!1];case 2:if(!b.sent())return[2,!1];b.label=3;case 3:return b.trys.push([3,18,,20]),o=this.getUserSession(),s=this.loggingService.getStandardContextsDeepCopy(),c=void 0!==s&&void 0!==s.environmentContext&&"powerpoint"===s.environmentContext.app,[4,this.startSdnServiceInit(n||o.isAnonymous||c)];case 4:return b.sent(),l=!1,h=this.embedVideoService.getVideo(e).then((function(e){return S.postMessagingService&&S.postMessagingService.sendMessageToParent(m.b.loadData,{eventname:m.a.dataLoaded,responsecode:"200"}),u=S.embedVideoService.getPlayableStatusFromVideo(e),e})).catch((function(e){return Object(r.b)(S,void 0,void 0,(function(){return Object(r.e)(this,(function(t){switch(t.label){case 0:return d=e,"notFound"!==(u=this.embedVideoService.getPlayableStatusFromError(e))?[3,2]:[4,i];case 1:l=t.sent(),t.label=2;case 2:return this.postMessagingService&&!l&&this.postMessagingService.sendMessageToParent(m.b.loadData,{eventname:m.a.dataLoaded,responsecode:e&&e.hasOwnProperty("status")?e.status.toString():"unknown"}),[2,void 0]}}))}))})),[4,Promise.all([h,this.principalService.getPrincipalServicePlans(o)])];case 5:return y=b.sent(),this.video=y[0],this.principalServicePlans=y[1],(f=l&&!this.video)?[3,7]:[4,i];case 6:f=b.sent(),b.label=7;case 7:return f?[2,!1]:this.getFeatureFlag(this,a.a.IsEmbedRedirectionToOdspEnabled)&&this.video&&this.video.videoMigrationStatus===ne.a.Completed&&this.video.redirectionUrl?[4,this.showRedirectBox(this.video.redirectionUrl,this.getFeatureFlag(this,a.a.IsConvertRedirectionUrlToWebDavUrlEnabled),this.video.id)]:[3,9];case 8:return b.sent(),[2,!1];case 9:return this.video&&"playable"===u?[3,11]:("unknownError"===u?this.loggingService.fatalThin("EmbedVideoError",Object(p.g)(d,e,"getVideo: unexpected error",p.a.VideoStatusError)):this.loggingService.warnThin("EmbedVideoError",Object(p.g)(d,e,"getVideo: expected error - "+u,p.a.VideoStatusError)),[4,this.showErrorBoxForVideoPlayableStatus(u)]);case 10:return b.sent(),[2,!1];case 11:if(this.isLiveContent=this.video.contentSource===de.b.liveStream,!this.streamVideoPlayer)return[3,17];b.label=12;case 12:return b.trys.push([12,14,,16]),[4,this.streamVideoPlayer.renderPlayer(t)];case 13:return b.sent(),[3,16];case 14:return g=b.sent(),this.logFatalVideoError("renderPlayer",g,this.video,p.a.RenderError),[4,this.showErrorBox()];case 15:return b.sent(),[2,!1];case 16:this.stateMachine.setState(Je.PlayerReady),b.label=17;case 17:return[3,20];case 18:return v=b.sent(),this.logFatalVideoError("renderVideo",v,this.video,p.a.RenderError),[4,this.showErrorBox()];case 19:return b.sent(),[2,!1];case 20:return[2,!0]}}))}))},e.prototype.initializeClosedCaptions=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(n){switch(n.label){case 0:if(!this.streamVideoPlayer)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.streamVideoPlayer.initializeTextTracks(e)];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),this.loggingService.warnThin("EmbedVideoError",Object(p.f)(t,this.video,"initializeTextTracks")),[3,4];case 4:return[2]}}))}))},e.prototype.startVideoPrefetch=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.e)(this,(function(t){switch(t.label){case 0:return[4,this.stateMachine.waitForStates([Je.Authenticated])];case 1:return t.sent()?(this.embedVideoPrefetcher.addVideosToPrefetch(e,this.getFeatureFlag(this,a.a.IsRedirectionUsingMigrationStatusApiEnabled)),this.embedVideoPrefetcher.start(),[2,!0]):[2,!1]}}))}))},e.prototype.showErrorBox=function(e){return void 0===e&&(e={}),Object(r.b)(this,void 0,void 0,(function(){var t,i;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(this.stateMachine.getState(Je.ErrorOccurred))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Qe((function(){return Promise.all([n.e(0),n.e(1),n.e(5),n.e(89)]).then(n.bind(null,1476))}))];case 2:return t=r.sent(),[3,4];case 3:return i=r.sent(),Object(o.a)(this.loggingService,"errorBox",i),[2];case 4:try{!e.isRecoverable&&this.clearContainer(),this.errorBoxPlugin||(this.errorBoxPlugin=new t.ErrorBoxPlugin(this,this.localization)),this.onReady&&this.onReady(this,!1),this.errorBoxPlugin.render(e),!e.isRecoverable&&this.stateMachine.setState(Je.ErrorOccurred)}catch(e){this.logFatalVideoError("showErrorBox",e,this.video,p.a.PluginError)}return[2]}}))}))},e.prototype.showRedirectBox=function(e,t,i){return Object(r.b)(this,void 0,void 0,(function(){var s,a;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,this.stateMachine.waitForStates([Je.ResourcesReady])];case 1:if(!r.sent())return[2];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Qe((function(){return Promise.all([n.e(0),n.e(1),n.e(197)]).then(n.bind(null,1494))}))];case 3:return s=r.sent(),[3,5];case 4:return a=r.sent(),Object(o.a)(this.loggingService,"redirectBox",a),[2];case 5:try{this.redirectBoxPlugin||(this.redirectBoxPlugin=new s.RedirectBoxPlugin(this,this.localization,this.loggingService,i)),this.onReady&&this.onReady(this,!1),this.redirectBoxPlugin.render(e,t),this.loggingService.appLogicThin("RedirectBoxShown",{videoId:i})}catch(e){this.logFatalVideoError("showRedirectBox",e,this.video,p.a.PluginError)}return[2]}}))}))},e.prototype.hideErrorBox=function(){var e=this.stateMachine.getState(Je.ErrorOccurred);this.errorBoxPlugin&&!e&&this.errorBoxPlugin.hideErrorBox()},e.prototype.showRedirectBoxIfApplicable=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(!this.getFeatureFlag(this,a.a.IsRedirectionUsingMigrationStatusApiEnabled))return[2,!1];r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this.embedVideoService.getVideoMigrationStatus(e)];case 2:return(t=r.sent())&&t.migrationStatus===ne.a.Completed&&t.destinationUrl&&""!==t.destinationUrl?[4,this.showRedirectBox(t.destinationUrl,this.getFeatureFlag(this,a.a.IsConvertRedirectionUrlToWebDavUrlEnabled),e)]:[3,4];case 3:return r.sent(),[2,!0];case 4:return[3,6];case 5:return n=r.sent(),this.loggingService.warnThin("EmbedVideoError",Object(p.g)(n,e,"renderVideo: showRedirectBoxIfApplicable",p.a.VideoMigrationStatusError)),[3,6];case 6:return[2,!1]}}))}))},e.prototype.showLoginScreen=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Qe((function(){return Promise.all([n.e(1),n.e(151)]).then(n.bind(null,1493))}))];case 1:return e=r.sent(),[3,3];case 2:throw t=r.sent(),Object(o.a)(this.loggingService,"loginScreen",t),t;case 3:return this.clearContainer(),new e.LoginScreenPlugin(this,this.localization).render(),this.loggingService.appLogicThin("LoginScreenShown",{viewContext:this.telemetryViewContext}),this.onReady&&this.onReady(this,!1),this.stateMachine.setState(Je.LoginRequired),[2]}}))}))},e.prototype.showErrorBoxForVideoPlayableStatus=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(n){switch(n.label){case 0:return t={},"forbidden"===e?(t.titleStr=this.getString("ForbiddenTitle"),t.message=this.getString("ForbiddenMessage")):"notFound"===e?(t.titleStr=this.getString("Err200194Manifest"),t.message=this.getString("Err200194ManifestSubtxt")):"notReady"===e?(t.titleStr=this.getString("NotReadyTitle"),t.message=this.getString("NotReadyMessage")):"videoError"===e&&(t.titleStr=this.getString("ErrorTitle"),t.message=this.getString("ErrorMessage")),[4,this.showErrorBox(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.clearContainer=function(){this.container.innerHTML=""},e.prototype.getPlayerResources=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,i,o=this;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,Qe((function(){return n.e(176).then(n.bind(null,1497))}))];case 1:return e=r.sent(),[4,Qe((function(){return e.getResources(o.localization.getLanguage())}))];case 2:return[2,r.sent()];case 3:return t=r.sent(),i=this.video?this.video.id:"",this.loggingService.warnThin("EmbedVideoError",Object(p.g)(t,i,"getPlayerResources error",p.a.InitError)),[2,Promise.resolve({})];case 4:return[2]}}))}))},e.prototype.setResources=function(){this.resources=window.Resources||{},this.resources.Numbers={thousands:this.getString("thousands"),millions:this.getString("millions"),billions:this.getString("billions"),trillions:this.getString("trillions"),lakhs:this.getString("lakhs"),crores:this.getString("crores")}},e.prototype.renderCookieBlockedError=function(e){void 0===e&&(e=this.getString("FallbackMessageInvalidCookies"));var t={label:this.getString("OpenInNewWindow"),clicked:function(){var e=location.href;-1===e.indexOf("?")?e+="?forceServerAuth=true":e+="&forceServerAuth=true",window.open(e)}};return this.showErrorBox({titleStr:this.getString("FallbackMsgTitleInvalidCookies"),message:e,learnMoreLink:"https://go.microsoft.com/fwlink/?linkid=2048919",customPrimaryButton:t})},e.prototype.startSdnServiceInit=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,i,s,a,c;return Object(r.e)(this,(function(r){switch(r.label){case 0:return e?[2]:[3,1];case 1:return t="SDNSettingsRetrieval",this.loggingService.startPerformance(t),[4,this.tenantService.getSdnSettingsIfSupported(this.embedAuthenticationService.getUserSession())];case 2:if(i=r.sent(),this.loggingService.endPerformance(t),!i)return[3,7];s="SDNServiceInit",this.loggingService.startPerformance(s),a=void 0,r.label=3;case 3:return r.trys.push([3,5,,6]),[4,Qe((function(){return n.e(205).then(n.bind(null,1495))}))];case 4:return a=r.sent(),this.sdnService=new a.SdnService(this.portalConfiguration,this.loggingService,i,this.isSdnDebug),[3,6];case 5:return c=r.sent(),Object(o.b)(this.loggingService,"sdnService",c),[3,6];case 6:this.loggingService.endPerformance(s),r.label=7;case 7:return[2]}}))}))},e.prototype.logFatalVideoError=function(e,t,n,r){this.loggingService.fatalThin("EmbedVideoError",Object(p.f)(t,n,e,r))},e.prototype.getString=function(e){return this.localization?this.localization.getString(e):""},e}(),gt=n(411),pt=n(71);function vt(e){return e.ECSConfiguration&&e.ECSConfiguration.telemetryRecord?e.ECSConfiguration.telemetryRecord:{}}function mt(e,t){var n=e.BuildNumber,r=e.RingNumber,i=t&&t.ServiceRegion||"",o=e.ClusterName,s=t&&t.ServiceRegion||"",a=t&&t.ApiGatewayUri||"",c=t&&t.ApiGatewayVersion||"",u=e.AzureMediaPlayerVersion,l=t&&t.IsEmbed||!1,d=e.IsDevelopmentMode;return{buildNumber:n,deploymentRing:r,clusterRegion:i,clusterIdentity:o,serviceRegion:s,apiGatewayUri:a,apiGatewayVersion:c,azureMediaPlayerVersion:u,isEmbed:l,isDevelopmentMode:d,isDebugLoggingEnabled:d}}function yt(e,t){var n=t.app||t.referrer||(e&&e.IsEmbed?e.ReferrerUrl:void 0)||(e&&e.IsEmbed?"Stream Embed":"Stream Portal"),r=t.referrer||(e?e.ReferrerUrl:void 0),i={app:n,hostCorrelationId:St(t.hostcorrelationid)?t.hostcorrelationid:t.appcorrelation,hostPlatform:t.appplatform,hostSessionId:t.appcorrelation,refId:t.refid,refType:t.reftype,trafficReferrer:r,hostIntegrationType:t.hostintegrationtype};return"auto"===t.preload&&(i.preload=!0),i}function St(e){return!(!e||36!==e.length)&&/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/gi.test(e)}function bt(e){if(!e)return{userId:"",clientSessionId:"",userSessionId:"",tenantId:"",servicePlan:"0",region:"",userType:"Unauthenticated",language:"language"};var t=pt.a.getUserId(e);return{userId:t,clientSessionId:e.ClientSessionId,userSessionId:e.SessionId,tenantId:Tt(e),servicePlan:e.ServicePlanForTelemetry||"0",region:e.UserRegion,userType:v(t,e.PrincipalInfo),language:e.UserLanguage,puid:e.PrincipalId}}function Tt(e){var t=e.UserClaim;return t?t.TenantId:""}function wt(e){return e||{}}var Et=n(26),Ct=n(46);function Ot(e){var t,r;t=n(137),(r=document.createElement("style")).innerHTML="\n    @font-face {\n      font-family: Stream Segoe UI;\n      src: url('"+t+"');\n      font-weight: normal;\n      font-style: normal;\n    }",document.head.appendChild(r);var i=document.createElement("style");i.innerHTML="\n    .embedVideoMain {\n      font-family: "+Ct.a+";\n      height: 100%;\n      width: 100%;\n      overflow: hidden;\n      background-color: black;\n    }\n\n    .hide {\n      display: none !important;\n    }",document.head.appendChild(i),e.classList.add("embedVideoMain")}var It,xt=Object(Et.parse)(window.location.search.toLowerCase()),At=Object(Et.parse)(window.location.search),kt=At.publicPlaybackUrl,Pt=void 0!==kt,Rt=Pt?function(e){for(var t=0,n=Object.keys(de.b);t<n.length;t++){var r=n[t];if(e===de.b[r])return de.b[r]}return}(At.contentSource):void 0,_t="EmbedVideoError",Nt="true"===xt.delayloadui,jt=document.getElementById("streamLoading"),Lt=document.getElementById("playButtonContainer"),Mt=document.getElementById("root");function Ut(e,t,n){var r="MsToVideoStart";if(performance&&performance.mark&&performance.getEntriesByName){playButtonAlreadyClicked||performance.mark(r);var i=performance.getEntriesByName(r);1===i.length?gt.a.registerEarlyStartPerformance(r,i[0]):gt.a.warnThin(_t,Object(p.g)(void 0,t,"no MsToVideoStart perfMark",p.a.InitError))}playButtonAlreadyClicked||(playButtonAlreadyClicked=!0),jt&&(jt.style.display="flex"),Lt&&(Lt.style.display="none"),Vt(e,t,!0,n).catch((function(e){gt.a.fatalThin(_t,Object(p.g)(e,t,"onPlayButtonClicked->beginLoadingUI",p.a.InitError))}))}function Vt(e,t,n,i){return Object(r.b)(this,void 0,Promise,(function(){var o,s,a;return Object(r.e)(this,(function(r){switch(r.label){case 0:o=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),s=function(e,t){var n={};(e||"true"===xt.autoplay)&&(n.autoplay=!0);var r=Number(xt.st);isNaN(r)||(n.startTimeInSeconds=r);var i=Number(xt.playerloglevel);isNaN(i)||(n.traceConfig={maxLogLevel:i,TraceTargets:[{target:"console"}]});"true"===xt.enablechaptering&&(n.enableChaptering=!0);"true"===xt.enablesurvey&&(n.enableSurvey=!0);"true"===xt.alwaysshowsurvey&&(n.enableSurvey=!0,n.alwaysShowSurvey=!0);"true"===xt.enableaudioonlymode&&(n.enableAudioOnlyMode=!0);n.deferredLoad=t,n.hideStreamIcon=Pt,"true"===xt.captionon&&(n.captionOn=!0);"true"===xt.expectmetamanifest&&(n.expectMeTAManifest=!0);return n.showPlaybackSpeedButton=!0,n}(n,i),[4,e.renderVideo(t,s,"true"===xt.disablesdn)];case 2:return o=r.sent(),[3,4];case 3:return a=r.sent(),Ft(e,Object(p.g)(a,t,"beginLoadingUI: renderVideo",p.a.RenderError)),[3,4];case 4:return!o||Pt?[3,6]:[4,Dt(e,t)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}function Ft(e,t){return Object(r.b)(this,void 0,Promise,(function(){var n;return Object(r.e)(this,(function(r){switch(r.label){case 0:gt.a.fatalThin(_t,t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.showErrorBox()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),gt.a.fatalThin(_t,Object(p.f)(n,e.video,"showFatalError: showErrorBox",p.a.PluginError)),[3,4];case 4:return[2]}}))}))}function Dt(e,t){return Object(r.b)(this,void 0,Promise,(function(){var i,o,s=this;return Object(r.e)(this,(function(a){switch(a.label){case 0:return o=function(){return Object(r.b)(s,void 0,void 0,(function(){return Object(r.e)(this,(function(r){switch(r.label){case 0:return"true"===xt.disablevideotitleoverlay||"false"===xt.showinfo?[3,2]:[4,Qe((function(){return Promise.all([n.e(0),n.e(1),n.e(235)]).then(n.bind(null,1488))})).then((function(t){(i=new t.VideoMetaOverlayPlugin(e,e.localization)).render()})).catch((function(e){gt.a.warnThin(_t,Object(p.g)(e,t,"videoMetaOverlayPlugin",p.a.PluginError))}))];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},[4,Promise.all([Qe((function(){return n.e(181).then(n.bind(null,1474))})).then((function(t){new t.PlayerCommandsPlugin(e).initialize()})).catch((function(e){gt.a.warnThin(_t,Object(p.g)(e,t,"playerCommandsPlugin",p.a.PluginError))})),o(),Qe((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(238)]).then(n.bind(null,1489))})).then((function(t){new t.TranscriptPlugin(e).render()})).catch((function(e){gt.a.warnThin(_t,Object(p.g)(e,t,"transcriptPlugin",p.a.PluginError))}))])];case 1:return a.sent(),!xt.disableforms&&Qe((function(){return n.e(105).then(n.bind(null,1475))})).then((function(t){new t.FormsPlugin({userSession:e.embedAuthenticationService.getUserSession(),video:e.video,getForms:e.embedVideoService.getForms,markFormAsViewed:e.embedVideoService.markFormAsViewed,streamVideoPlayer:e.streamVideoPlayer,loggingService:e.streamSession.loggingService,telemetryViewContext:e.streamSession.telemetryViewContext,getAuthResult:e.embedAuthenticationService.getExternalAuthResult},i)})).catch((function(e){gt.a.warnThin(_t,Object(p.g)(e,t,"formsPlugin",p.a.PluginError))})),[2]}}))}))}function qt(){jt&&(jt.style.display="none"),Lt&&(Lt.style.display="none"),Mt.style.display="block",document.body.style.background="#000000"}function Gt(e){if(It)return It();var t=e?e.getString("PlayVideo"):"";if(Nt&&t){var n=document.getElementById("playButton");n&&n.setAttribute("aria-label",t)}}Pt&&(Object.defineProperty(document,"cookie",{get:function(){return""},set:function(){}}),sessionInfo=function(e){if(!e)return{};return{UserClaim:{TenantId:e.UserClaim?e.UserClaim.TenantId:""},ApiGatewayVersion:e.ApiGatewayVersion,ApiGatewayUri:e.ApiGatewayUri,UserLanguage:e.UserLanguage,UserTimezone:e.UserTimezone,ServiceRegion:e.ServiceRegion,IsRightToLeft:e.IsRightToLeft,ClientSessionId:e.ClientSessionId,IsEmbed:e.IsEmbed,ClientAppId:e.ClientAppId,ReferrerUrl:e.ReferrerUrl,TenantedAuth:e.TenantedAuth}}(sessionInfo)),function(){if(!window.shouldRenderEmbed)return void console.warn("Not rendering embed");if(!Mt)return void console.warn("No container to render embed");var e=(t=window.location.pathname,n=t.match("(embed/video/)([a-z|0-9|-]*[/]*$)"),n&&n.length>0&&n[n.length-1]||"");var t,n;e||console.warn("Video id unavailable or malformed");var g=sessionInfo.TenantedAuth?At.tenantId:void 0,v=xt.auth_upn,m="true"===xt.sdndebug,y=Nt&&null!==Lt,S=function(e,t,n,r){return{isDevelopmentMode:e.IsDevelopmentMode,expContext:vt(e),environmentContext:yt(t,n),userContext:bt(t),entityContext:wt(r),streamContext:mt(e,t)}}(portalConfiguration,sessionInfo,xt,{videoId:e,isPublicAnonymous:Pt,isFastEmbed:!0,deferredLoad:y,client:"FastEmbed"});Object(i.a)({standard:S},portalConfiguration,sessionInfo,"7.2.1");try{Ot(Mt),function e(t,n){"undefined"!=typeof Map&&"undefined"!=typeof WeakMap&&"undefined"!=typeof Set&&(u=!0),u||c||(c=!0,Object(s.b)(Object(a.c)(),(function(){e(t,n)}),(function(){Object(o.a)(t,"ie10 polyfill")}),t)),"undefined"!=typeof Promise&&(d=!0),d||l||(l=!0,Object(s.b)(Object(a.f)(),(function(){e(t,n)}),(function(){Object(o.a)(t,"promise polyfill")}),t)),"undefined"!=typeof fetch&&(f=!0),f||h||!d||(h=!0,Object(s.b)(Object(a.b)(),(function(){e(t,n)}),(function(){Object(o.a)(t,"fetch polyfill")}),t)),u&&f&&n()}(gt.a,(function(){(function(e,t,n,i,o,s){return Object(r.b)(this,void 0,Promise,(function(){var a,c,u;return Object(r.e)(this,(function(r){switch(r.label){case 0:return a=new ft(portalConfiguration,sessionInfo,streamFullStaticPath,"ThinEmbedVideo",gt.a,e,Pt,n,i,Rt,qt,kt,o,Gt),t?(Nt&&!s&&gt.a.warnThin(_t,Object(p.g)(void 0,t,"criteria needed to use delay load ui is not met therefore delayloadui QSP is ignored.",p.a.InitError)),s?(a.startVideoPrefetch([t]).catch((function(e){gt.a.fatalThin(_t,Object(p.g)(e,t,"loadCore->startVideoPrefetch",p.a.InitError))})),playButtonAlreadyClicked?Ut(a,t,s):Lt&&(Lt.onclick=function(){Ut(a,t,s)}),[3,5]):[3,1]):(It=function(){var e={titleStr:a.localization?a.localization.getString("FallbackMessageHeadDefault"):"",message:a.localization?a.localization.getString("FallbackMessageDetailDefault"):""};a.showErrorBox(e)},[2]);case 1:return"pre-auth"!==t?[3,2]:[3,5];case 2:if("pre-fetch"!==t)return[3,3];try{c=window.location.hash.substr(1),u=c?c.split("#"):[],a.startVideoPrefetch(u).catch((function(e){gt.a.fatalThin(_t,Object(p.g)(e,t,"loadCore->startVideoPrefetch",p.a.InitError))}))}catch(e){Ft(a,Object(p.f)(e,void 0,"loadCore: prefetch failed",p.a.InitError))}return[3,5];case 3:return[4,Vt(a,t,!1,s)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))})(Mt,e,g,v,m,y).catch((function(t){gt.a.fatalThin(_t,Object(p.g)(t,e,"loadCore",p.a.InitError))}))}))}catch(t){gt.a.fatalThin(_t,Object(p.g)(t,e,"main",p.a.InitError))}}()},466:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r={GetStreamToken:"getStreamToken",GetStreamTokenLower:"getstreamtoken",signInEvent:"signinevent",loadData:"loaddata",playerEvent:"playerevent",playerFunction:"playerfunction",prefetchNewVideos:"prefetchnewvideos",fetchVideoThumbnails:"fetchvideothumbnails",fetchVideoThumbnailResult:"fetchvideothumbnailresult"},i={signInSuccessful:"signinsuccessful",signInFailed:"signinfailed",signInIncomplete:"signinincomplete",setSource:"setsource",canPlayThrough:"canplaythrough",cookieBlocked:"cookieblocked",dataLoaded:"dataloaded",error:"error",heartbeat:"heartbeat",timeupdate:"timeupdate",pause:"pause",playing:"playing",ready:"ready"}},467:function(e,t,n){"use strict";var r,i,o,s,a;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),function(e){e.CapturePanel="CapturePanel",e.EditPanel="EditPanel",e.EmbedVideo="EmbedVideo",e.FakePlayer="FakePlayer",e.Forms="Forms",e.MediaPlayerContainer="MediaPlayerContainer",e.O365Groups="O365Groups",e.Playlist="Playlist",e.ReportIssue="ReportIssue",e.SingleVideo="SingleVideo",e.Transcript="Transcript",e.WatchNext="WatchNext",e.UploadPanel="UploadPanel",e.VideoMetaOverlay="VideoMetaOverlay",e.VideoAnalytics="VideoAnalytics",e.WaffleBar="WaffleBar",e.ShareDialog="ShareDialog",e.EmbedSurvey="EmbedSurvey"}(r||(r={})),function(e){e.TopBar="TopBar"}(i||(i={})),function(e){e.ThinEmbedVideoPlayer="ThinEmbedVideoPlayer"}(o||(o={})),function(e){e.ScreenRecorder="ScreenRecorder",e.VideoPicker="VideoPicker"}(s||(s={})),function(e){e.Comments="Comments",e.SidebarMenu="SidebarMenu",e.AddToGroupsAndChannels="AddToGroupsAndChannels",e.Yammer="Yammer",e.NavBar="NavBar",e.WaffleBar="WaffleBar",e.VideoDetails="VideoDetails"}(a||(a={}))},468:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(0),i=n(404),o=n(48),s=n(469),a=n(26),c=n(70);function u(e){return isFinite(e)&&!isNaN(e)}var l=n(130);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var h=function(e){function t(n,r){var i=e.call(this,r)||this;return i.status=n,void 0!==d(Object.setPrototypeOf)&&Object.setPrototypeOf(i,t.prototype),i}return Object(r.d)(t,e),t}(Error),f=n(357),g=function(){function e(){}return e.get=function(t,n,r,o,a,c,u){if(void 0===u&&(u=s.a.any),!r){var l=t+". empty base url";i.a.logError({method:"GET",staticMessage:l,url:o})}return e.makeRequest(t,n,"GET",u,r,o,a,void 0,c,void 0)},e.getWithCorsSupport=function(t,n,r,o,a,c,u){if(void 0===u&&(u=s.a.any),!r){var l=t+". empty base url";i.a.logError({method:"GET",staticMessage:l,url:o})}return e.makeRequest(t,n,"GET",u,r,o,a,void 0,c,"cors")},e.getContent=function(t,n,r,i,o){return void 0===o&&(o=s.a.any),e.makeRequestForURL(t,n,"GET",o,r,void 0,i,void 0)},e.put=function(t,n,r,o,a,c,u,l){if(void 0===l&&(l=s.a.any),!r){var d=t+". empty base url";i.a.logError({method:"PUT",staticMessage:d,url:o})}return e.makeRequest(t,n,"PUT",l,r,o,a,c,u,void 0)},e.patch=function(t,n,r,o,a,c,u,l){if(void 0===l&&(l=s.a.any),!r){var d=t+". empty base url";i.a.logError({method:"PATCH",staticMessage:d,url:o})}return e.makeRequest(t,n,"PATCH",l,r,o,a,c,u,void 0)},e.post=function(t,n,r,o,a,c,u,l){if(void 0===l&&(l=s.a.any),!r){var d=t+". empty base url";i.a.logError({method:"POST",staticMessage:d,url:o})}return e.makeRequest(t,n,"POST",l,r,o,a,c,u,void 0)},e.postToRelativeUrl=function(t,n,r,i,o,a,c){return void 0===c&&(c=s.a.any),e.makeRequest(t,n,"POST",c,"",r,i,o,a)},e.delete=function(t,n,r,o,a,c,u){if(void 0===u&&(u=s.a.any),!r){var l=t+". empty base url";i.a.logError({method:"DELETE",staticMessage:l,url:o})}return e.makeRequest(t,n,"DELETE",u,r,o,a,void 0,c,void 0)},e.query=function(t,n,r,o,a,c,d){if(void 0===d&&(d=s.a.any),!r){var h=t+". empty base url";i.a.logError({method:"GET",staticMessage:h,url:o})}if(a&&void 0!==a.$top){var f=parseInt(a.$top,10);u(f)?a.$top=Math.min(l.b.MaxTop,f>0?f:l.b.DefaultTop).toString():a.$top=l.b.DefaultTop.toString(),a.$top=a.$top.toString()}if(a&&void 0!==a.$skip){var g=parseInt(a.$skip,10);u(g)?a.$skip=Math.max(l.b.DefaultSkip,g).toString():a.$skip=l.b.DefaultSkip.toString(),a.$skip=a.$skip.toString()}return e.makeRequest(t,n,"GET",d,r,o,a,void 0,c,"cors")},e.performHealthCheck=function(t,n,o,s,a){return Object(r.b)(this,void 0,void 0,(function(){var c;return Object(r.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.fetchWithTimeout("https://amsglob0cdnstream13.azureedge.net/embed/USWC1/version.txt",{method:"GET"})];case 1:return r.sent(),c="Rest.performHealthCheck. Can successfully reach our health URL. This means there is no client network issue, so it is a backend issue",[3,3];case 2:return r.sent(),c="Rest.performHealthCheck. Failed to reach our health URL. This means there is a client network issue.",[3,3];case 3:return i.a.logError({method:n.method,staticMessage:c,url:t,statusCode:o?o.status:void 0,clientRequestId:n.headers["x-ms-client-request-id"],groupings:s,message:o?o.statusText:void 0,error:a,isFatal:!0}),[2]}}))}))},e.makeRequest=function(t,n,r,i,o,s,c,u,l,d){var h=Object(a.parse)(window.location.search.toLowerCase());"string"==typeof h.hostcorrelationid&&(c.hostcorrelationid=h.hostcorrelationid);var g=Object(f.a)(o,s,c,u);return e.formRequest(t,n,r,i,g,l,u,d)},e.makeRequestForURL=function(t,n,r,i,o,s,a,c){return e.formRequest(t,n,r,i,o,a,s,c)},e.formRequest=function(t,n,r,i,o,s,a,c){var u=a&&/^(POST|PUT|PATCH)$/i.test(r);s=s||{},!u||a instanceof FormData||(s["Content-Type"]="application/json;charset=UTF-8");var l={method:r,headers:s,body:u?a instanceof FormData?a:JSON.stringify(a):void 0,mode:c,credentials:"cors"===c?"include":"same-origin"};return e.executeWithRetry(t,n,o,i,l)},e.executeWithRetry=function(t,n,s,a,c){return Object(r.b)(this,void 0,void 0,(function(){var u,l,d,h,f;return Object(r.e)(this,(function(r){switch(r.label){case 0:u=0,c.headers=c.headers||{},r.label=1;case 1:if(!(u<=3))return[3,10];r.label=2;case 2:return r.trys.push([2,5,,9]),c.headers["x-ms-client-request-id"]=e.generateGuid(),[4,e.fetchWithTimeout(s,c)];case 3:return l=r.sent(),[4,e.handleFetchResponse(l,a)];case 4:return[2,r.sent()];case 5:return h=r.sent(),d=t,"AbortError"!==h.Name&&h.message!==Object(o.c)("Timeout")&&h.message!==Object(o.c)("Network request failed")&&l?"string"==typeof h.message&&0===h.message.lastIndexOf("<safe>Malformed")&&(d+=". Malformed response"):d+=". Network issue",h=e.staticError(h),f=!1,l&&l.status<500||l&&503===l.status&&e.isTenantPatch(s,c)?f=!0:u++,!f&&u>3?[4,e.performHealthCheck(s,c,l,n,h)]:[3,7];case 6:r.sent(),f=!0,r.label=7;case 7:if(i.a.logError({method:c.method,staticMessage:d,url:s,statusCode:l?l.status:void 0,clientRequestId:c.headers["x-ms-client-request-id"],groupings:n,message:l?l.statusText:void 0,error:h,isFatal:f}),f)throw h;return[4,e.delay(200*Math.pow(2,u))];case 8:return r.sent(),[3,9];case 9:return[3,1];case 10:throw new Error(Object(o.c)("RestService.executeWithRetry. Unexpected code, we should have never got here"))}}))}))},e.staticError=function(e){if(void 0===e||void 0===e.status)return e;switch(+e.status){case 401:return new h(e.status,Object(o.c)("Unauthorized"));case 403:return new h(e.status,Object(o.c)("Forbidden"));case 404:return new h(e.status,Object(o.c)("NotFound"));case 405:return new h(e.status,Object(o.c)("OperationNotAllowed"));default:return e}},e.fetchWithTimeout=function(e,t){if("undefined"!=typeof AbortController){var n=new AbortController,i=n.signal;return setTimeout((function(){return n.abort()}),15e3),fetch(e,Object(r.a)(Object(r.a)({},t),{signal:i}))}var s=fetch(e,t),a=new Promise((function(e,t){return setTimeout((function(){return t(new Error(Object(o.c)("Timeout")))}),15e3)}));return Promise.race([s,a])},e.handleFetchResponse=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,a;return Object(r.e)(this,(function(r){switch(r.label){case 0:return e.ok?!(n=e.headers.get("content-type"))||-1===n.indexOf("application/json")&&-1===n.indexOf("text/html")?[3,2]:[4,e.json()]:[3,6];case 1:if(i=r.sent(),Object(s.b)(i,t))return[2,i];throw new TypeError(Object(o.c)("Malformed. Response validation failed"));case 2:return n&&-1!==n.indexOf("application/octet-stream")?[4,e.text()]:[3,4];case 3:return[2,a=r.sent()];case 4:if(Object(s.b)(void 0,t))return[2,void 0];throw new TypeError(Object(o.c)("Malformed. Response had content-type: '"+n+"', expected "+t.type));case 5:return[3,11];case 6:a=void 0,r.label=7;case 7:return r.trys.push([7,9,,10]),[4,e.json()];case 8:return a=r.sent(),[3,10];case 9:return r.sent(),a={},[3,10];case 10:throw{status:e.status,statusText:e.statusText,headers:e.headers,data:a};case 11:return[2]}}))}))},e.isTenantPatch=function(e,t){return"PATCH"===t.method&&-1!==e.indexOf("api/tenants/")},e.delay=function(e){return new Promise((function(t){return setTimeout(t,e)}))},e.generateGuid=function(){return Object(c.v4)()},e}()},469:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i={any:{type:"any"},undefined:{type:"undefined"},null:{type:"null"},boolean:{type:"boolean"},number:{type:"number"},string:{type:"string"},literal:function(e){return{type:"literal",value:e}},optional:function(e){return{type:"optional",property:e}},array:function(e){return{type:"array",elementRep:e}},object:function(e){return{type:"object",properties:e}},union:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:"union",variants:e}}};function o(e,t){var n=t;switch(n.type){case"any":return!0;case"undefined":return void 0===e;case"null":return null===e;case"boolean":return"boolean"==typeof e;case"number":return"number"==typeof e;case"string":return"string"==typeof e;case"literal":return e===n.value;case"array":return Array.isArray(e)&&(0===e.length||e.every((function(e){return o(e,n.elementRep)})));case"object":return"object"===r(e)&&null!==e&&!Array.isArray(e)&&Object.keys(n.properties).every((function(t){return"optional"===n.properties[t].type?void 0===e[t]||o(e[t],n.properties[t].property):o(e[t],n.properties[t])}));case"union":return n.variants.some((function(t){return o(e,t)}));default:return function(e,t){throw new Error(void 0!==t?"Asserted never: "+t:"Asserted never")}(0,"validate: Invalid runtime type representation: '"+t.type+"'")}}},47:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a}));var r=n(206),i=n(7),o="LoadCodeDynamicallyFailed";function s(e,t,n){e.fatalThin(o,c(t,n))}function a(e,t,n){e.warnThin(o,c(t,n))}function c(e,t){var n=t?Object(r.a)(t):void 0;return{stack:n&&n.stack?n.stack:(new Error).stack||i.c.Missing,message:n&&n.message?n.message:i.b.Missing,staticMessage:e}}},474:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return d}));var r="https://amsglob0cdnstream13.azureedge.net/",i=r+"polyfill/";function o(){return i+"polyfill.min.js"}function s(){return i+"whatwg-fetch@3.0.0-min.js"}function a(){return i+"ie10.min.js"}function c(e){var t=e.IsDevelopmentMode?"streamPostMessage.js":"streamPostMessage.min.js";return l(e)+t}function u(e){return l(e)+"app/generated/azuremediaplayer-fluent.woff"}function l(e){return""===e.StaticContentLocation?"/"+e.BuildNumber+"/bundles/":e.StaticContentLocation&&e.StaticContentContainer?e.StaticContentLocation+"/"+e.StaticContentContainer+"/bundles/":e.BuildNumber?(e.BuildNumber,"/bundles/"):r+"1-0-2088-10/bundles/"}var d={IsRedirectionUsingMigrationStatusApiEnabled:"IsRedirectionUsingMigrationStatusApiEnabled",IsEmbedRedirectionToOdspEnabled:"IsEmbedRedirectionToOdspEnabled",IsConvertRedirectionUrlToWebDavUrlEnabled:"IsConvertRedirectionUrlToWebDavUrlEnabled"}},48:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));function r(e){return"<safe>"+e+"</safe>"}function i(e){return!(e.length<"<safe>".length+"</safe>".length)&&("<safe>"===e.substring(0,"<safe>".length)&&"</safe>"===e.substring(e.length-"</safe>".length))}function o(e){return i(e)?e.substring("<safe>".length,e.length-"</safe>".length):e}},49:function(e){e.exports=JSON.parse('{"cultures":{"ar-SA":"ar","bg-BG":"bg","ca-ES":"ca","cs-CZ":"cs","da-DK":"da","de-DE":"de","el-GR":"el","es-ES":"es","et-EE":"et","eu-ES":"eu","fi-FI":"fi","fr-FR":"fr","gl-ES":"gl","he-IL":"he","hr-HR":"hr","hu-HU":"hu","id-ID":"id","it-IT":"it","ja-JP":"ja","ko-KR":"ko","lt-LT":"lt","lv-LV":"lv","nb-NO":"nb","nl-NL":"nl","pl-PL":"pl","pt-BR":"pt-br","pt-PT":"pt-pt","ro-RO":"ro","ru-RU":"ru","sk-SK":"sk","sl-SI":"sl","sr-Cyrl-RS":"sr-cyrl-rs","sr-Latn-RS":"sr-latn-rs","sv-SE":"sv","th-TH":"th","tr-TR":"tr","uk-UA":"uk","vi-VN":"vi","zh-CN":"zh-hans","zh-TW":"zh-hant"}}')},54:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),i=n(406),o=n(410),s=n(49),a=n.t(s,2);function c(e){var t="default"in a?s:a;if("cultures"in t){var n=t.cultures,r=n[e];if(void 0!==r)return r;var i=e.split("-")[0].toLowerCase();if("en"===i)return i;for(var o in n)if(n[o]===i)return i}return""}var u=n(98),l=function(){function e(t){var n=t.defaultLocale,r=t.defaultResourceLoader,s=t.nonDefaultResourceLoader,a=t.pseudo,c=void 0!==a&&a;this.defaultLocale=this.isValidLocale(n)&&n.toLowerCase()||e.DEFAULT_LOCALE,this.locale=new i.a(void 0),this.isDefaultLoaded=!1,this.localizedStringsProvider=new o.a({defaultLang:e.convertToStreamCultureName(this.defaultLocale),rootElement:document.documentElement,loadDefaultStringsAsync:r,loadNonDefaultLangAsync:s,pseudo:c})}return e.create=function(t){return Object(r.b)(this,void 0,void 0,(function(){var n;return Object(r.e)(this,(function(r){switch(r.label){case 0:return[4,(n=new e(t)).setLocale()];case 1:return r.sent(),[2,n]}}))}))},e.convertToStreamCultureName=function(e){return void 0===e&&(e=""),c(e)},e.prototype.setLocale=function(t){return Object(r.b)(this,void 0,void 0,(function(){var n;return Object(r.e)(this,(function(r){switch(r.label){case 0:return this.isDefaultLoaded?[3,2]:[4,this.localizedStringsProvider.waitDefaultResourcesLoad()];case 1:r.sent(),this.isDefaultLoaded=!0,t||(this.locale.value=this.defaultLocale),r.label=2;case 2:return t&&this.locale.value!==t?(n=t,this.isValidLang(t)||(n=e.convertToStreamCultureName(t),this.isValidLang(n))?[4,this.localizedStringsProvider.setLanguage(n)]:(this.locale.value=this.defaultLocale,[2])):[3,4];case 3:r.sent(),this.locale.value=t,r.label=4;case 4:return[2]}}))}))},e.prototype.getLanguage=function(){return this.locale.value&&this.isValidLang(this.locale.value)?this.locale.value:e.convertToStreamCultureName(this.locale.value)},e.prototype.getString=function(e){if(void 0===this.locale.value)throw new Error("getString() is called before resources are loaded");return this.localizedStringsProvider.getString(e)},e.prototype.isValidLocale=function(t){return!!t&&!!e.convertToStreamCultureName(t)},e.prototype.isValidLang=function(e){return!!e&&-1!==Object.keys(u.a).indexOf(e)},e.DEFAULT_LOCALE="en-us",e}()},56:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s}));var r={smooth:"application/vnd.ms-sstr+xml",dash:"application/dash+xml",hls:"application/vnd.apple.mpegurl",progressive:"video/mp4"},i={file:"file",liveStream:"liveStream",screenRecording:"screenRecording"},o=15e3,s={EnhancedAudio:"EnhancedAudio",OriginalAudio:"OriginalAudio"}},68:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return p}));var r=function(){return o(!0)},i=function(){return o(!1)},o=function(e){try{var t=e?window.localStorage:window.sessionStorage;return void 0!==t&&(t.setItem("key","value"),t.removeItem("key"),!0)}catch(e){return!1}};function s(){try{var e,t="__cookie_test_key__";return document.cookie=t+"=1; secure; samesite=none",document.cookie=t+"=1",e=-1!==document.cookie.indexOf(t),document.cookie=t+"=1;  expires=Thu, 01-Jan-1970 00:00:01 GMT; secure; samesite=none",document.cookie=t+"=1;  expires=Thu, 01-Jan-1970 00:00:01 GMT",e}catch(e){return!1}}function a(e){if(window.MSStream)return!1;if(!(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream))return!1;if(e){var t=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/);return!!t&&l([parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||"0",10)].join("."),e)}return!0}function c(){return/iPhone/.test(navigator.userAgent)&&!window.MSStream}var u=function(){try{return window.top!==window.self}catch(e){return!0}};function l(e,t){for(var n=e.split("."),r=t.split("."),i=Math.max(n.length,r.length),o=0;o<i;o++){var s=parseInt(n[o],10)||0,a=parseInt(r[o],10)||0;if(s>a)return!0;if(s<a)return!1}return!0}function d(){return/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&!!(document.uniqueID||document.documentMode||window.ActiveXObject||window.MSInputMethodContext)}function h(e){return!(!e||!0!==l(e,"30")||!1!==l(e,"30.0.0.154"))}function f(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function g(){var e=window.localStorage;void 0!==e&&d()&&e.setItem("bugfix_forceSync",Date.now().toString())}function p(){return navigator.languages||[navigator.language]}"undefined"!=typeof window&&(window.estimatedNavigationStartTime||(window.estimatedNavigationStartTime=new Date))},7:function(e,t,n){"use strict";var r,i,o,s,a,c;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),function(e){e[e.Always=0]="Always",e[e.IfAnyFramesOffend=1]="IfAnyFramesOffend",e[e.OnlyOffendingFrames=2]="OnlyOffendingFrames",e[e.Never=3]="Never"}(r||(r={})),function(e){e[e.Never=0]="Never",e[e.WhenNotInErrorHashAllowlist=1]="WhenNotInErrorHashAllowlist",e[e.WhenNotMarkedAsSafe=2]="WhenNotMarkedAsSafe",e[e.Always=4]="Always"}(i||(i={})),function(e){e.Missing="mis",e.NotApplicable="n/a"}(o||(o={})),function(e){e.Missing="mis",e.NotApplicable="n/a"}(s||(s={})),function(e){e.Warning="Warning",e.Fatal="Fatal",e.Unhandled="Unhandled"}(a||(a={})),function(e){e.UnhandledError="UnhandledError",e.AmpUnhandledError="AmpUnhandledError",e.SdnUnhandledError="SdnUnhandledError"}(c||(c={}))},70:function(e,t,n){var r=n(156),i=n(150),o=i;o.v1=r,o.v4=i,e.exports=o},71:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.getLocalUserId=function(t,n,r,i){var o=e.getUserId(n);return o?function(e,t,n){if(!e)return"c";if(!t)return"a";switch(n){case"Consumer":case"ConsumerAnonymous":return"m";case"Business":case"BusinessAnonymous":return"p";case"Unknown":default:return"c"}}(!t.EnableMockApiGateway,r,i)+":"+o:o},e.getUserId=function(e){var t=e.UserClaim;return t&&t.UserInfo?t.UserInfo.UniqueId:""},e}()},87:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),i=n(127),o=n(32),s=function(){function e(e,t,n){void 0===n&&(n=!1),this.clientSessionIdFromSession=e,this.userSessionIdFromSession=t,this.isAnonymous=n,this.tenantId="",this.apiGatewayUrl="",this.apiGatewayVersion="",this.notificationEndPoint="",this.userLanguage=o.b,this.userRegion="",this.isRightToLeft=!1,this.uniqueId="",this.hashedId="",this.authToken=Object(r.a)({},i.a),this.clientSessionId=this.clientSessionIdFromSession,this.userSessionId=this.userSessionIdFromSession}return Object.defineProperty(e.prototype,"accessToken",{get:function(){return this.authToken.token},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accessTokenExpiryDate",{get:function(){return new Date(this.authToken.expiry.valueOf())},enumerable:!0,configurable:!0}),e.prototype.generateHeaders=function(){return{Authorization:"Bearer "+this.accessToken,"x-ms-client-session-id":this.clientSessionId,"Accept-Language":this.userLanguage}},e.prototype.getApiGatewayParameters=function(){return{id:this.tenantId,apiVersion:this.apiGatewayVersion}},e.prototype.applyLocaleInfo=function(e){this.userLanguage=e.userLanguage,this.userRegion=e.userRegion,this.isRightToLeft=e.isRightToLeft},e}()},94:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},95:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},96:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(202),i=n(11),o=n(87),s=n(68),a=function(){function e(e,t,n,r){this.context=e,this.anonymousPrincipalService=t,this.authenticationStateChanged=n,this.onReadyToLoadResources=r,this.authState=i.a.Unknown,this.performLogin=function(){throw new Error("Login not supported for anonymous access")},this.anonymousUserSession=this.createAnonymousUserSession()}return e.prototype.getUserSession=function(){return this.anonymousUserSession},e.prototype.startAuthentication=function(){this.onReadyToLoadResources(),this.authState=i.a.Authenticated,this.authenticationStateChanged&&this.authenticationStateChanged(this.authState,"")},e.prototype.getTenantInfo=function(){throw new Error("Not supported for anonymous users.")},e.prototype.getExternalAuthResult=function(e,t,n){throw new Error("getExternalAuthResult not supported for anonymous access")},e.prototype.createAnonymousUserSession=function(){var e=new o.a(this.context.userSessionInfo.ClientSessionId,"",!0),t=new r.a(this.context.portalConfiguration.SupportedLanguages,this.context.portalConfiguration.RTLLanguages,"",window.location.search,Object(s.b)(),this.context.loggingService,this.context.telemetryViewContext),n=this.anonymousPrincipalService.anonymousPrincipalSettings,i=t.getLocaleInfo(n);e.applyLocaleInfo(i);var a=this.context.loggingService.getStandardContextsDeepCopy();return a&&a.userContext&&(a.userContext.language=e.userLanguage,a.userContext.region=e.userRegion||"",this.context.loggingService.setStandardContexts(a)),e},e}()},97:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,i=n(0),o=n(54);function s(e){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.e)(this,(function(t){switch(t.label){case 0:return[4,n(198)("./"+e+"/strings.json").then((function(e){return e.default}))];case 1:return[2,t.sent()]}}))}))}function a(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.e)(this,(function(e){switch(e.label){case 0:return[4,n.e(83).then(n.t.bind(null,358,3)).then((function(e){return e.default}))];case 1:return[2,e.sent()]}}))}))}function c(e,t,n){return r||(r=new o.a({defaultLocale:n,defaultResourceLoader:function(){return e("defLangRes",a)},nonDefaultResourceLoader:function(t){return e("langRes",(function(){return s(t)}))},pseudo:t})),r}},98:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={ar:void 0,bg:void 0,ca:void 0,cs:void 0,da:void 0,de:void 0,el:void 0,en:void 0,es:void 0,et:void 0,eu:void 0,fi:void 0,fr:void 0,gl:void 0,he:void 0,hr:void 0,hu:void 0,id:void 0,it:void 0,ja:void 0,ko:void 0,lt:void 0,lv:void 0,nb:void 0,nl:void 0,pl:void 0,"pt-br":void 0,"pt-pt":void 0,ro:void 0,ru:void 0,sk:void 0,sl:void 0,"sr-cyrl-rs":void 0,"sr-latn-rs":void 0,sv:void 0,th:void 0,tr:void 0,uk:void 0,vi:void 0,"zh-hans":void 0,"zh-hant":void 0}},99:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),function(e){e.PerformanceNavigationTiming="PerformanceNavigationTiming",e.NavigationTiming="NavigationTiming",e.Estimated="Estimated",e.HostSpecifiedPerformanceMark="HostSpecifiedPerformanceMark",e.HostSpecifiedDate="HostSpecifiedDate"}(r||(r={}));function i(e,t){for(var n=e,r=0;0!==window.performance.getEntriesByName(n,t).length;)n=e+"-"+r++;return n}function o(e,t){var n=t||"MsSinceNavigationStart";if(e){if(window.performance&&window.performance.mark&&s(e)){var o=i(n,"mark");window.performance.mark(o);var a=window.performance.getEntriesByName(o,"mark")[0];return window.performance.clearMarks(o),{Method:r.HostSpecifiedPerformanceMark,MsSinceNavigationStart:a.startTime-e.startTime}}return{Method:r.HostSpecifiedDate,MsSinceNavigationStart:Date.now()-e.getTime()}}if(window.performance&&window.performance.measure){o=i(n,"measure");window.performance.measure(o);var c=window.performance.getEntriesByName(o,"measure");return window.performance.clearMeasures(o),{Method:r.PerformanceNavigationTiming,MsSinceNavigationStart:c[0].duration}}return window.performance&&window.performance.timing?{Method:r.NavigationTiming,MsSinceNavigationStart:Date.now()-window.performance.timing.navigationStart}:window.estimatedNavigationStartTime?{Method:r.Estimated,MsSinceNavigationStart:Date.now()-window.estimatedNavigationStartTime.getTime()}:void 0}function s(e){return"mark"===e.entryType}function a(e){return"measure"===e.entryType}}})}));